# Session Functions




<div class="phpcode"><span class="html">
When working on a project, I found a need to switch live sessions between two different pieces of software. The documentation to do this is scattered all around different sites, especially in comments sections rather than examples. One difficulty I encountered was the session save handler for one of the applications was set, whereas the other was not. Now, I didn&apos;t code in the function session_set_save_handler(), instead I utilize that once I&apos;m done with the function (manually), however this function could easily be extended to include that functionality. Basically, it is only overriding the system&apos;s default session save handler. To overcome this after you have used getSessionData(), just call session_write_close(), session_set_save_handler() with the appropriate values, then re-run session_name(), session_id() and session_start() with their appropriate values. If you don&apos;t know the session id, it&apos;s the string located in $_COOKIE[session_name], or $_REQUEST[session_name] if you are using trans_sid. [note: use caution with trusting data from $_REQUEST, if at all possible, use $_GET or $_POST instead depending on the page].<br><br><span class="default">&lt;?php<br></span><span class="keyword">function </span><span class="default">getSessionData </span><span class="keyword">(</span><span class="default">$session_name </span><span class="keyword">= </span><span class="string">&apos;PHPSESSID&apos;</span><span class="keyword">, </span><span class="default">$session_save_handler </span><span class="keyword">= </span><span class="string">&apos;files&apos;</span><span class="keyword">) {<br>&#xA0; &#xA0; </span><span class="default">$session_data </span><span class="keyword">= array();<br>&#xA0; &#xA0; </span><span class="comment"># did we get told what the old session id was? we can&apos;t continue it without that info<br>&#xA0; &#xA0; </span><span class="keyword">if (</span><span class="default">array_key_exists</span><span class="keyword">(</span><span class="default">$session_name</span><span class="keyword">, </span><span class="default">$_COOKIE</span><span class="keyword">)) {<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="comment"># save current session id<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$session_id </span><span class="keyword">= </span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="default">$session_name</span><span class="keyword">];<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$old_session_id </span><span class="keyword">= </span><span class="default">session_id</span><span class="keyword">();<br>&#xA0; &#xA0; &#xA0; &#xA0; <br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="comment"># write and close current session<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">session_write_close</span><span class="keyword">();<br>&#xA0; &#xA0; &#xA0; &#xA0; <br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="comment"># grab old save handler, and switch to files<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$old_session_save_handler </span><span class="keyword">= </span><span class="default">ini_get</span><span class="keyword">(</span><span class="string">&apos;session.save_handler&apos;</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">ini_set</span><span class="keyword">(</span><span class="string">&apos;session.save_handler&apos;</span><span class="keyword">, </span><span class="default">$session_save_handler</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; <br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="comment"># now we can switch the session over, capturing the old session name<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$old_session_name </span><span class="keyword">= </span><span class="default">session_name</span><span class="keyword">(</span><span class="default">$session_name</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">session_id</span><span class="keyword">(</span><span class="default">$session_id</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">session_start</span><span class="keyword">();<br>&#xA0; &#xA0; &#xA0; &#xA0; <br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="comment"># get the desired session data<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$session_data </span><span class="keyword">= </span><span class="default">$_SESSION</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; <br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="comment"># close this session, switch back to the original handler, then restart the old session<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">session_write_close</span><span class="keyword">();<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">ini_set</span><span class="keyword">(</span><span class="string">&apos;session.save_handler&apos;</span><span class="keyword">, </span><span class="default">$old_session_save_handler</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">session_name</span><span class="keyword">(</span><span class="default">$old_session_name</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">session_id</span><span class="keyword">(</span><span class="default">$old_session_id</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">session_start</span><span class="keyword">();<br>&#xA0; &#xA0; }<br>&#xA0; &#xA0; <br>&#xA0; &#xA0; </span><span class="comment"># now return the data we just retrieved<br>&#xA0; &#xA0; </span><span class="keyword">return </span><span class="default">$session_data</span><span class="keyword">;<br>}<br></span><span class="default">?&gt;</span>
</span>
</div>
  

#

[Official documentation page](https://www.php.net/manual/en/ref.session.php)

**[To root](/README.md)**