# Object Iteration




<div class="phpcode"><span class="html">
there is still an open bug about using current() etc. with iterators<br><a href="https://bugs.php.net/bug.php?id=49369" rel="nofollow" target="_blank">https://bugs.php.net/bug.php?id=49369</a></span>
</div>
  

#


<div class="phpcode"><span class="html">
By reading the posts below I wondered if it really is impossible to make an ArrayAccess implementation really behave like a true array ( by being multi level )<br><br>Seems like it&apos;s not impossible. Not very preety but usable<br><br><span class="default">&lt;?php<br><br></span><span class="keyword">class </span><span class="default">ArrayAccessImpl </span><span class="keyword">implements </span><span class="default">ArrayAccess </span><span class="keyword">{<br><br>&#xA0; private </span><span class="default">$data </span><span class="keyword">= array();<br><br>&#xA0; public function </span><span class="default">offsetUnset</span><span class="keyword">(</span><span class="default">$index</span><span class="keyword">) {}<br><br>&#xA0; public function </span><span class="default">offsetSet</span><span class="keyword">(</span><span class="default">$index</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">) {<br></span><span class="comment">//&#xA0; &#xA0; echo (&quot;SET: &quot;.$index.&quot;&lt;br&gt;&quot;);<br>&#xA0; &#xA0; <br>&#xA0; &#xA0; </span><span class="keyword">if(isset(</span><span class="default">$data</span><span class="keyword">[</span><span class="default">$index</span><span class="keyword">])) {<br>&#xA0; &#xA0; &#xA0; &#xA0; unset(</span><span class="default">$data</span><span class="keyword">[</span><span class="default">$index</span><span class="keyword">]);<br>&#xA0; &#xA0; }<br>&#xA0; &#xA0; <br>&#xA0; &#xA0; </span><span class="default">$u </span><span class="keyword">= &amp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">data</span><span class="keyword">[</span><span class="default">$index</span><span class="keyword">];<br>&#xA0; &#xA0; if(</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">)) {<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$u </span><span class="keyword">= new </span><span class="default">ArrayAccessImpl</span><span class="keyword">();<br>&#xA0; &#xA0; &#xA0; &#xA0; foreach(</span><span class="default">$value </span><span class="keyword">as </span><span class="default">$idx</span><span class="keyword">=&gt;</span><span class="default">$e</span><span class="keyword">)<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$u</span><span class="keyword">[</span><span class="default">$idx</span><span class="keyword">]=</span><span class="default">$e</span><span class="keyword">;<br>&#xA0; &#xA0; } else<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$u</span><span class="keyword">=</span><span class="default">$value</span><span class="keyword">;<br>&#xA0; }<br><br>&#xA0; public function </span><span class="default">offsetGet</span><span class="keyword">(</span><span class="default">$index</span><span class="keyword">) {<br></span><span class="comment">//&#xA0; &#xA0; echo (&quot;GET: &quot;.$index.&quot;&lt;br&gt;&quot;);<br><br>&#xA0; &#xA0; </span><span class="keyword">if(!isset(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">data</span><span class="keyword">[</span><span class="default">$index</span><span class="keyword">]))<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">data</span><span class="keyword">[</span><span class="default">$index</span><span class="keyword">]=new </span><span class="default">ArrayAccessImpl</span><span class="keyword">();<br>&#xA0; &#xA0; <br>&#xA0; &#xA0; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">data</span><span class="keyword">[</span><span class="default">$index</span><span class="keyword">];<br>&#xA0; }<br><br>&#xA0; public function </span><span class="default">offsetExists</span><span class="keyword">(</span><span class="default">$index</span><span class="keyword">) {<br></span><span class="comment">//&#xA0; &#xA0; echo (&quot;EXISTS: &quot;.$index.&quot;&lt;br&gt;&quot;);<br>&#xA0; &#xA0; <br>&#xA0; &#xA0; </span><span class="keyword">if(isset(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">data</span><span class="keyword">[</span><span class="default">$index</span><span class="keyword">])) {<br>&#xA0; &#xA0; &#xA0; &#xA0; if(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">data</span><span class="keyword">[</span><span class="default">$index</span><span class="keyword">] instanceof </span><span class="default">ArrayAccessImpl</span><span class="keyword">) {<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; if(</span><span class="default">count</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">data</span><span class="keyword">[</span><span class="default">$index</span><span class="keyword">]-&gt;</span><span class="default">data</span><span class="keyword">)&gt;</span><span class="default">0</span><span class="keyword">)<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; return </span><span class="default">true</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; else<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; return </span><span class="default">false</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; } else<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; return </span><span class="default">true</span><span class="keyword">;<br>&#xA0; &#xA0; } else<br>&#xA0; &#xA0; &#xA0; &#xA0; return </span><span class="default">false</span><span class="keyword">;<br>&#xA0; }<br><br>}<br><br>echo </span><span class="string">&quot;ArrayAccess implementation that behaves like a multi-level array&lt;hr /&gt;&quot;</span><span class="keyword">;<br><br></span><span class="default">$data </span><span class="keyword">= new </span><span class="default">ArrayAccessImpl</span><span class="keyword">();<br><br></span><span class="default">$data</span><span class="keyword">[</span><span class="string">&apos;string&apos;</span><span class="keyword">]=</span><span class="string">&quot;Just a simple string&quot;</span><span class="keyword">;<br></span><span class="default">$data</span><span class="keyword">[</span><span class="string">&apos;number&apos;</span><span class="keyword">]=</span><span class="default">33</span><span class="keyword">;<br></span><span class="default">$data</span><span class="keyword">[</span><span class="string">&apos;array&apos;</span><span class="keyword">][</span><span class="string">&apos;another_string&apos;</span><span class="keyword">]=</span><span class="string">&quot;Alpha&quot;</span><span class="keyword">;<br></span><span class="default">$data</span><span class="keyword">[</span><span class="string">&apos;array&apos;</span><span class="keyword">][</span><span class="string">&apos;some_object&apos;</span><span class="keyword">]=new </span><span class="default">stdClass</span><span class="keyword">();<br></span><span class="default">$data</span><span class="keyword">[</span><span class="string">&apos;array&apos;</span><span class="keyword">][</span><span class="string">&apos;another_array&apos;</span><span class="keyword">][</span><span class="string">&apos;x&apos;</span><span class="keyword">][</span><span class="string">&apos;y&apos;</span><span class="keyword">]=</span><span class="string">&quot;LOL @ Whoever said it can&apos;t be done !&quot;</span><span class="keyword">;<br></span><span class="default">$data</span><span class="keyword">[</span><span class="string">&apos;blank_array&apos;</span><span class="keyword">]=array();<br><br>echo </span><span class="string">&quot;&apos;array&apos; Isset? &quot;</span><span class="keyword">; </span><span class="default">print_r</span><span class="keyword">(isset(</span><span class="default">$data</span><span class="keyword">[</span><span class="string">&apos;array&apos;</span><span class="keyword">])); echo </span><span class="string">&quot;&lt;hr /&gt;&quot;</span><span class="keyword">;<br>echo </span><span class="string">&quot;&lt;pre&gt;&quot;</span><span class="keyword">; </span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">[</span><span class="string">&apos;array&apos;</span><span class="keyword">][</span><span class="string">&apos;non_existent&apos;</span><span class="keyword">]); echo </span><span class="string">&quot;&lt;/pre&gt;If attempting to read an offset that doesn&apos;t exist it returns a blank object! Use isset() to check if it exists!&lt;br&gt;&quot;</span><span class="keyword">;<br>echo </span><span class="string">&quot;&apos;non_existent&apos; Isset? &quot;</span><span class="keyword">; </span><span class="default">print_r</span><span class="keyword">(isset(</span><span class="default">$data</span><span class="keyword">[</span><span class="string">&apos;array&apos;</span><span class="keyword">][</span><span class="string">&apos;non_existent&apos;</span><span class="keyword">])); echo </span><span class="string">&quot;&lt;br /&gt;&quot;</span><span class="keyword">;<br>echo </span><span class="string">&quot;&lt;pre&gt;&quot;</span><span class="keyword">; </span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">[</span><span class="string">&apos;blank_array&apos;</span><span class="keyword">]); echo </span><span class="string">&quot;&lt;/pre&gt;A blank array unfortunately returns similar results :(&lt;br /&gt;&quot;</span><span class="keyword">;<br>echo </span><span class="string">&quot;&apos;blank_array&apos; Isset? &quot;</span><span class="keyword">; </span><span class="default">print_r</span><span class="keyword">(isset(</span><span class="default">$data</span><span class="keyword">[</span><span class="string">&apos;blank_array&apos;</span><span class="keyword">])); echo </span><span class="string">&quot;&lt;hr /&gt;&quot;</span><span class="keyword">;<br>echo </span><span class="string">&quot;&lt;pre&gt;&quot;</span><span class="keyword">; </span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">); echo </span><span class="string">&quot;&lt;/pre&gt; (non_existent remains in the structure. If someone can help to solve this I&apos;ll appreciate it)&lt;hr /&gt;&quot;</span><span class="keyword">;<br><br>echo </span><span class="string">&quot;Display some value that exists: &quot;</span><span class="keyword">.</span><span class="default">$data</span><span class="keyword">[</span><span class="string">&apos;array&apos;</span><span class="keyword">][</span><span class="string">&apos;another_string&apos;</span><span class="keyword">];<br><br></span><span class="default">?&gt;<br></span><br>(in the two links mentioned below by artur at jedlinski... they say you can&apos;t use references, so I didn&apos;t used them.<br>My implementation uses recursive objects)<br><br>If anyone finds a better (cleaner) sollution, please e-mail me.<br>Thanks,<br>Wave.</span>
</div>
  

#

[Official documentation page](https://www.php.net/manual/en/language.oop5.iterations.php)

**[To root](/)**