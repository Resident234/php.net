# xml_parse_into_struct




<div class="phpcode"><span class="html">
Perhaps the one true parser:? I modified xademax&apos;s fine code to tidy it up, codewise and style wise, rationalize some minor crazyness, and make names fit nomenclature from the XML spec. (There are no uses of eval, and shame on you people who do.)<br><br><span class="default">&lt;?php <br></span><span class="keyword">class </span><span class="default">XmlElement </span><span class="keyword">{<br>&#xA0; var </span><span class="default">$name</span><span class="keyword">;<br>&#xA0; var </span><span class="default">$attributes</span><span class="keyword">;<br>&#xA0; var </span><span class="default">$content</span><span class="keyword">;<br>&#xA0; var </span><span class="default">$children</span><span class="keyword">;<br>};<br><br>function </span><span class="default">xml_to_object</span><span class="keyword">(</span><span class="default">$xml</span><span class="keyword">) {<br>&#xA0; </span><span class="default">$parser </span><span class="keyword">= </span><span class="default">xml_parser_create</span><span class="keyword">();<br>&#xA0; </span><span class="default">xml_parser_set_option</span><span class="keyword">(</span><span class="default">$parser</span><span class="keyword">, </span><span class="default">XML_OPTION_CASE_FOLDING</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">);<br>&#xA0; </span><span class="default">xml_parser_set_option</span><span class="keyword">(</span><span class="default">$parser</span><span class="keyword">, </span><span class="default">XML_OPTION_SKIP_WHITE</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br>&#xA0; </span><span class="default">xml_parse_into_struct</span><span class="keyword">(</span><span class="default">$parser</span><span class="keyword">, </span><span class="default">$xml</span><span class="keyword">, </span><span class="default">$tags</span><span class="keyword">);<br>&#xA0; </span><span class="default">xml_parser_free</span><span class="keyword">(</span><span class="default">$parser</span><span class="keyword">);<br><br>&#xA0; </span><span class="default">$elements </span><span class="keyword">= array();&#xA0; </span><span class="comment">// the currently filling [child] XmlElement array<br>&#xA0; </span><span class="default">$stack </span><span class="keyword">= array();<br>&#xA0; foreach (</span><span class="default">$tags </span><span class="keyword">as </span><span class="default">$tag</span><span class="keyword">) {<br>&#xA0; &#xA0; </span><span class="default">$index </span><span class="keyword">= </span><span class="default">count</span><span class="keyword">(</span><span class="default">$elements</span><span class="keyword">);<br>&#xA0; &#xA0; if (</span><span class="default">$tag</span><span class="keyword">[</span><span class="string">&apos;type&apos;</span><span class="keyword">] == </span><span class="string">&quot;complete&quot; </span><span class="keyword">|| </span><span class="default">$tag</span><span class="keyword">[</span><span class="string">&apos;type&apos;</span><span class="keyword">] == </span><span class="string">&quot;open&quot;</span><span class="keyword">) {<br>&#xA0; &#xA0; &#xA0; </span><span class="default">$elements</span><span class="keyword">[</span><span class="default">$index</span><span class="keyword">] = new </span><span class="default">XmlElement</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; </span><span class="default">$elements</span><span class="keyword">[</span><span class="default">$index</span><span class="keyword">]-&gt;</span><span class="default">name </span><span class="keyword">= </span><span class="default">$tag</span><span class="keyword">[</span><span class="string">&apos;tag&apos;</span><span class="keyword">];<br>&#xA0; &#xA0; &#xA0; </span><span class="default">$elements</span><span class="keyword">[</span><span class="default">$index</span><span class="keyword">]-&gt;</span><span class="default">attributes </span><span class="keyword">= </span><span class="default">$tag</span><span class="keyword">[</span><span class="string">&apos;attributes&apos;</span><span class="keyword">];<br>&#xA0; &#xA0; &#xA0; </span><span class="default">$elements</span><span class="keyword">[</span><span class="default">$index</span><span class="keyword">]-&gt;</span><span class="default">content </span><span class="keyword">= </span><span class="default">$tag</span><span class="keyword">[</span><span class="string">&apos;value&apos;</span><span class="keyword">];<br>&#xA0; &#xA0; &#xA0; if (</span><span class="default">$tag</span><span class="keyword">[</span><span class="string">&apos;type&apos;</span><span class="keyword">] == </span><span class="string">&quot;open&quot;</span><span class="keyword">) {&#xA0; </span><span class="comment">// push<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$elements</span><span class="keyword">[</span><span class="default">$index</span><span class="keyword">]-&gt;</span><span class="default">children </span><span class="keyword">= array();<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$stack</span><span class="keyword">[</span><span class="default">count</span><span class="keyword">(</span><span class="default">$stack</span><span class="keyword">)] = &amp;</span><span class="default">$elements</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$elements </span><span class="keyword">= &amp;</span><span class="default">$elements</span><span class="keyword">[</span><span class="default">$index</span><span class="keyword">]-&gt;</span><span class="default">children</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; }<br>&#xA0; &#xA0; }<br>&#xA0; &#xA0; if (</span><span class="default">$tag</span><span class="keyword">[</span><span class="string">&apos;type&apos;</span><span class="keyword">] == </span><span class="string">&quot;close&quot;</span><span class="keyword">) {&#xA0; </span><span class="comment">// pop<br>&#xA0; &#xA0; &#xA0; </span><span class="default">$elements </span><span class="keyword">= &amp;</span><span class="default">$stack</span><span class="keyword">[</span><span class="default">count</span><span class="keyword">(</span><span class="default">$stack</span><span class="keyword">) - </span><span class="default">1</span><span class="keyword">];<br>&#xA0; &#xA0; &#xA0; unset(</span><span class="default">$stack</span><span class="keyword">[</span><span class="default">count</span><span class="keyword">(</span><span class="default">$stack</span><span class="keyword">) - </span><span class="default">1</span><span class="keyword">]);<br>&#xA0; &#xA0; }<br>&#xA0; }<br>&#xA0; return </span><span class="default">$elements</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">];&#xA0; </span><span class="comment">// the single top-level element<br></span><span class="keyword">}<br><br></span><span class="comment">// For example:<br></span><span class="default">$xml </span><span class="keyword">= </span><span class="string">&apos;<br>&lt;parser&gt;<br>&#xA0;&#xA0; &lt;name language=&quot;en-us&quot;&gt;Fred Parser&lt;/name&gt;<br>&#xA0;&#xA0; &lt;category&gt;<br>&#xA0; &#xA0; &#xA0;&#xA0; &lt;name&gt;Nomenclature&lt;/name&gt;<br>&#xA0; &#xA0; &#xA0;&#xA0; &lt;note&gt;Noteworthy&lt;/note&gt;<br>&#xA0;&#xA0; &lt;/category&gt;<br>&lt;/parser&gt;<br>&apos;</span><span class="keyword">;<br></span><span class="default">print_r</span><span class="keyword">(</span><span class="default">xml_to_object</span><span class="keyword">(</span><span class="default">$xml</span><span class="keyword">));<br></span><span class="default">?&gt;<br></span><br>will give:<br><br>xmlelement Object<br>(<br>&#xA0; &#xA0; [name] =&gt; parser<br>&#xA0; &#xA0; [attributes] =&gt; <br>&#xA0; &#xA0; [content] =&gt; <br>&#xA0; &#xA0; [children] =&gt; Array<br>&#xA0; &#xA0; &#xA0; &#xA0; (<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; [0] =&gt; xmlelement Object<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; (<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; [name] =&gt; name<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; [attributes] =&gt; Array<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; (<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; [language] =&gt; en-us<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; )<br><br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; [content] =&gt; Fred Parser<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; [children] =&gt; <br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; )<br><br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; [1] =&gt; xmlelement Object<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; (<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; [name] =&gt; category<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; [attributes] =&gt; <br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; [content] =&gt; <br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; [children] =&gt; Array<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; (<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; [0] =&gt; xmlelement Object<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; (<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; [name] =&gt; name<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; [attributes] =&gt; <br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; [content] =&gt; Nomenclature<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; [children] =&gt; <br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; )<br><br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; [1] =&gt; xmlelement Object<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; (<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; [name] =&gt; note<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; [attributes] =&gt; <br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; [content] =&gt; Noteworthy<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; [children] =&gt; <br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; )<br><br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; )<br><br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; )<br><br>&#xA0; &#xA0; &#xA0; &#xA0; )<br><br>)</span>
</div>
  

#

[Official documentation page](https://www.php.net/manual/en/function.xml-parse-into-struct.php)

**[⬆ to root](/)**