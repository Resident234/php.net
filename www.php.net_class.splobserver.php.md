# The SplObserver interface




<div class="phpcode"><span class="html">
<span class="default">&lt;?php<br><br></span><span class="comment">/**<br> * Subject,that who makes news<br> */<br></span><span class="keyword">class </span><span class="default">Newspaper </span><span class="keyword">implements \</span><span class="default">SplSubject</span><span class="keyword">{<br>&#xA0; &#xA0; private </span><span class="default">$name</span><span class="keyword">;<br>&#xA0; &#xA0; private </span><span class="default">$observers </span><span class="keyword">= array();<br>&#xA0; &#xA0; private </span><span class="default">$content</span><span class="keyword">;<br>&#xA0; &#xA0; <br>&#xA0; &#xA0; public function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">) {<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">name </span><span class="keyword">= </span><span class="default">$name</span><span class="keyword">;<br>&#xA0; &#xA0; }<br><br>&#xA0; &#xA0; </span><span class="comment">//add observer<br>&#xA0; &#xA0; </span><span class="keyword">public function </span><span class="default">attach</span><span class="keyword">(\</span><span class="default">SplObserver $observer</span><span class="keyword">) {<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">observers</span><span class="keyword">[] = </span><span class="default">$observer</span><span class="keyword">;<br>&#xA0; &#xA0; }<br>&#xA0; &#xA0; <br>&#xA0; &#xA0; </span><span class="comment">//remove observer<br>&#xA0; &#xA0; </span><span class="keyword">public function </span><span class="default">detach</span><span class="keyword">(\</span><span class="default">SplObserver $observer</span><span class="keyword">) {<br>&#xA0; &#xA0; &#xA0; &#xA0; <br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$key </span><span class="keyword">= </span><span class="default">array_search</span><span class="keyword">(</span><span class="default">$observer</span><span class="keyword">,</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">observers</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; if(</span><span class="default">$key</span><span class="keyword">){<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; unset(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">observers</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">]);<br>&#xA0; &#xA0; &#xA0; &#xA0; }<br>&#xA0; &#xA0; }<br>&#xA0; &#xA0; <br>&#xA0; &#xA0; </span><span class="comment">//set breakouts news<br>&#xA0; &#xA0; </span><span class="keyword">public function </span><span class="default">breakOutNews</span><span class="keyword">(</span><span class="default">$content</span><span class="keyword">) {<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">content </span><span class="keyword">= </span><span class="default">$content</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">notify</span><span class="keyword">();<br>&#xA0; &#xA0; }<br>&#xA0; &#xA0; <br>&#xA0; &#xA0; public function </span><span class="default">getContent</span><span class="keyword">() {<br>&#xA0; &#xA0; &#xA0; &#xA0; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">content</span><span class="keyword">.</span><span class="string">&quot; (</span><span class="keyword">{</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">name</span><span class="keyword">}</span><span class="string">)&quot;</span><span class="keyword">;<br>&#xA0; &#xA0; }<br>&#xA0; &#xA0; <br>&#xA0; &#xA0; </span><span class="comment">//notify observers(or some of them)<br>&#xA0; &#xA0; </span><span class="keyword">public function </span><span class="default">notify</span><span class="keyword">() {<br>&#xA0; &#xA0; &#xA0; &#xA0; foreach (</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">observers </span><span class="keyword">as </span><span class="default">$value</span><span class="keyword">) {<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$value</span><span class="keyword">-&gt;</span><span class="default">update</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; }<br>&#xA0; &#xA0; }<br>}<br><br></span><span class="comment">/**<br> * Observer,that who recieves news<br> */<br></span><span class="keyword">class </span><span class="default">Reader </span><span class="keyword">implements </span><span class="default">SplObserver</span><span class="keyword">{<br>&#xA0; &#xA0; private </span><span class="default">$name</span><span class="keyword">;<br>&#xA0; &#xA0; <br>&#xA0; &#xA0; public function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">) {<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">name </span><span class="keyword">= </span><span class="default">$name</span><span class="keyword">;<br>&#xA0; &#xA0; }<br>&#xA0; &#xA0; <br>&#xA0; &#xA0; public function </span><span class="default">update</span><span class="keyword">(\</span><span class="default">SplSubject $subject</span><span class="keyword">) {<br>&#xA0; &#xA0; &#xA0; &#xA0; echo </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">name</span><span class="keyword">.</span><span class="string">&apos; is reading breakout news &lt;b&gt;&apos;</span><span class="keyword">.</span><span class="default">$subject</span><span class="keyword">-&gt;</span><span class="default">getContent</span><span class="keyword">().</span><span class="string">&apos;&lt;/b&gt;&lt;br&gt;&apos;</span><span class="keyword">;<br>&#xA0; &#xA0; }<br>}<br><br></span><span class="default">$newspaper </span><span class="keyword">= new </span><span class="default">Newspaper</span><span class="keyword">(</span><span class="string">&apos;Newyork Times&apos;</span><span class="keyword">);<br><br></span><span class="default">$allen </span><span class="keyword">= new </span><span class="default">Reader</span><span class="keyword">(</span><span class="string">&apos;Allen&apos;</span><span class="keyword">);<br></span><span class="default">$jim </span><span class="keyword">= new </span><span class="default">Reader</span><span class="keyword">(</span><span class="string">&apos;Jim&apos;</span><span class="keyword">);<br></span><span class="default">$linda </span><span class="keyword">= new </span><span class="default">Reader</span><span class="keyword">(</span><span class="string">&apos;Linda&apos;</span><span class="keyword">);<br><br></span><span class="comment">//add reader<br></span><span class="default">$newspaper</span><span class="keyword">-&gt;</span><span class="default">attach</span><span class="keyword">(</span><span class="default">$allen</span><span class="keyword">);<br></span><span class="default">$newspaper</span><span class="keyword">-&gt;</span><span class="default">attach</span><span class="keyword">(</span><span class="default">$jim</span><span class="keyword">);<br></span><span class="default">$newspaper</span><span class="keyword">-&gt;</span><span class="default">attach</span><span class="keyword">(</span><span class="default">$linda</span><span class="keyword">);<br><br></span><span class="comment">//remove reader<br></span><span class="default">$newspaper</span><span class="keyword">-&gt;</span><span class="default">detach</span><span class="keyword">(</span><span class="default">$linda</span><span class="keyword">);<br><br></span><span class="comment">//set break outs<br></span><span class="default">$newspaper</span><span class="keyword">-&gt;</span><span class="default">breakOutNews</span><span class="keyword">(</span><span class="string">&apos;USA break down!&apos;</span><span class="keyword">);<br><br></span><span class="comment">//=====output======<br>//Allen is reading breakout news USA break down! (Newyork Times)<br>//Jim is reading breakout news USA break down! (Newyork Times)</span>
</span>
</div>
  

#


<div class="phpcode"><span class="html">
Beware, you have written :<br><br>&#xA0; &#xA0; &#xA0; &#xA0; if($key){<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; unset($this-&gt;observers[$key]);<br>&#xA0; &#xA0; &#xA0; &#xA0; }<br><br>When this should be :<br><br>&#xA0; &#xA0; &#xA0; &#xA0; if(false !== $key){<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; unset($this-&gt;observers[$key]);<br>&#xA0; &#xA0; &#xA0; &#xA0; }<br><br>If the observer you want to delete is the first in your array, you will never delete it because the key would equal 0 and 0 == false as you know.</span>
</div>
  

#

[Official documentation page](https://www.php.net/manual/en/class.splobserver.php)

**[â¬† to root](/)**