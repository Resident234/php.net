# random_bytes




<div class="phpcode"><span class="html">
I used below function to create random token, and also a salt from the token. I used it in my application to prevent CSRF attack.<br><br><span class="default">&lt;?php<br></span><span class="keyword">function </span><span class="default">RandomToken</span><span class="keyword">(</span><span class="default">$length </span><span class="keyword">= </span><span class="default">32</span><span class="keyword">){<br>&#xA0; &#xA0; if(!isset(</span><span class="default">$length</span><span class="keyword">) || </span><span class="default">intval</span><span class="keyword">(</span><span class="default">$length</span><span class="keyword">) &lt;= </span><span class="default">8 </span><span class="keyword">){<br>&#xA0; &#xA0; &#xA0; </span><span class="default">$length </span><span class="keyword">= </span><span class="default">32</span><span class="keyword">;<br>&#xA0; &#xA0; }<br>&#xA0; &#xA0; if (</span><span class="default">function_exists</span><span class="keyword">(</span><span class="string">&apos;random_bytes&apos;</span><span class="keyword">)) {<br>&#xA0; &#xA0; &#xA0; &#xA0; return </span><span class="default">bin2hex</span><span class="keyword">(</span><span class="default">random_bytes</span><span class="keyword">(</span><span class="default">$length</span><span class="keyword">));<br>&#xA0; &#xA0; }<br>&#xA0; &#xA0; if (</span><span class="default">function_exists</span><span class="keyword">(</span><span class="string">&apos;mcrypt_create_iv&apos;</span><span class="keyword">)) {<br>&#xA0; &#xA0; &#xA0; &#xA0; return </span><span class="default">bin2hex</span><span class="keyword">(</span><span class="default">mcrypt_create_iv</span><span class="keyword">(</span><span class="default">$length</span><span class="keyword">, </span><span class="default">MCRYPT_DEV_URANDOM</span><span class="keyword">));<br>&#xA0; &#xA0; } <br>&#xA0; &#xA0; if (</span><span class="default">function_exists</span><span class="keyword">(</span><span class="string">&apos;openssl_random_pseudo_bytes&apos;</span><span class="keyword">)) {<br>&#xA0; &#xA0; &#xA0; &#xA0; return </span><span class="default">bin2hex</span><span class="keyword">(</span><span class="default">openssl_random_pseudo_bytes</span><span class="keyword">(</span><span class="default">$length</span><span class="keyword">));<br>&#xA0; &#xA0; }<br>}<br><br>function </span><span class="default">Salt</span><span class="keyword">(){<br>&#xA0; &#xA0; return </span><span class="default">substr</span><span class="keyword">(</span><span class="default">strtr</span><span class="keyword">(</span><span class="default">base64_encode</span><span class="keyword">(</span><span class="default">hex2bin</span><span class="keyword">(</span><span class="default">RandomToken</span><span class="keyword">(</span><span class="default">32</span><span class="keyword">))), </span><span class="string">&apos;+&apos;</span><span class="keyword">, </span><span class="string">&apos;.&apos;</span><span class="keyword">), </span><span class="default">0</span><span class="keyword">, </span><span class="default">44</span><span class="keyword">);<br>}<br><br>echo (</span><span class="default">RandomToken</span><span class="keyword">());<br>echo </span><span class="string">&quot;\n&quot;</span><span class="keyword">;<br>echo </span><span class="default">Salt</span><span class="keyword">();<br>echo </span><span class="string">&quot;\n&quot;</span><span class="keyword">;<br><br></span><span class="comment">/*<br>This function is same as above but its only used for debugging<br>*/<br></span><span class="keyword">function </span><span class="default">RandomTokenDebug</span><span class="keyword">(</span><span class="default">$length </span><span class="keyword">= </span><span class="default">32</span><span class="keyword">){<br>&#xA0; &#xA0; if(!isset(</span><span class="default">$length</span><span class="keyword">) || </span><span class="default">intval</span><span class="keyword">(</span><span class="default">$length</span><span class="keyword">) &lt;= </span><span class="default">8 </span><span class="keyword">){<br>&#xA0; &#xA0; &#xA0; </span><span class="default">$length </span><span class="keyword">= </span><span class="default">32</span><span class="keyword">;<br>&#xA0; &#xA0; }<br>&#xA0; &#xA0; </span><span class="default">$randoms </span><span class="keyword">= array();<br>&#xA0; &#xA0; if (</span><span class="default">function_exists</span><span class="keyword">(</span><span class="string">&apos;random_bytes&apos;</span><span class="keyword">)) {<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$randoms</span><span class="keyword">[</span><span class="string">&apos;random_bytes&apos;</span><span class="keyword">] = </span><span class="default">bin2hex</span><span class="keyword">(</span><span class="default">random_bytes</span><span class="keyword">(</span><span class="default">$length</span><span class="keyword">));<br>&#xA0; &#xA0; }<br>&#xA0; &#xA0; if (</span><span class="default">function_exists</span><span class="keyword">(</span><span class="string">&apos;mcrypt_create_iv&apos;</span><span class="keyword">)) {<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$randoms</span><span class="keyword">[</span><span class="string">&apos;mcrypt_create_iv&apos;</span><span class="keyword">] = </span><span class="default">bin2hex</span><span class="keyword">(</span><span class="default">mcrypt_create_iv</span><span class="keyword">(</span><span class="default">$length</span><span class="keyword">, </span><span class="default">MCRYPT_DEV_URANDOM</span><span class="keyword">));<br>&#xA0; &#xA0; }<br>&#xA0; &#xA0; if (</span><span class="default">function_exists</span><span class="keyword">(</span><span class="string">&apos;openssl_random_pseudo_bytes&apos;</span><span class="keyword">)) {<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$randoms</span><span class="keyword">[</span><span class="string">&apos;openssl_random_pseudo_bytes&apos;</span><span class="keyword">] = </span><span class="default">bin2hex</span><span class="keyword">(</span><span class="default">openssl_random_pseudo_bytes</span><span class="keyword">(</span><span class="default">$length</span><span class="keyword">));<br>&#xA0; &#xA0; }<br>&#xA0; &#xA0; <br>&#xA0; &#xA0; return </span><span class="default">$randoms</span><span class="keyword">;<br>}<br>echo </span><span class="string">&quot;\n&quot;</span><span class="keyword">;<br></span><span class="default">print_r </span><span class="keyword">(</span><span class="default">RandomTokenDebug</span><span class="keyword">());<br><br></span><span class="default">?&gt;</span>
</span>
</div>
  

#

[Official documentation page](https://www.php.net/manual/en/function.random-bytes.php)

**[â¬† to root](/)**