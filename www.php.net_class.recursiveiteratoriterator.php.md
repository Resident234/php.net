# The RecursiveIteratorIterator class




<div class="phpcode"><span class="html">
Some speed tests<br><span class="default">&lt;?php<br>$timer </span><span class="keyword">= function (</span><span class="default">$name </span><span class="keyword">= </span><span class="string">&apos;default&apos;</span><span class="keyword">, </span><span class="default">$unset_timer </span><span class="keyword">= </span><span class="default">TRUE</span><span class="keyword">)<br>{<br>&#xA0; &#xA0; static </span><span class="default">$timers </span><span class="keyword">= array();<br>&#xA0; &#xA0; <br>&#xA0; &#xA0; if ( isset( </span><span class="default">$timers</span><span class="keyword">[ </span><span class="default">$name </span><span class="keyword">] ) )<br>&#xA0; &#xA0; {<br>&#xA0; &#xA0; &#xA0; &#xA0; list(</span><span class="default">$s_sec</span><span class="keyword">, </span><span class="default">$s_mic</span><span class="keyword">) = </span><span class="default">explode</span><span class="keyword">(</span><span class="string">&apos; &apos;</span><span class="keyword">, </span><span class="default">$timers</span><span class="keyword">[ </span><span class="default">$name </span><span class="keyword">]);<br>&#xA0; &#xA0; &#xA0; &#xA0; list(</span><span class="default">$e_sec</span><span class="keyword">, </span><span class="default">$e_mic</span><span class="keyword">) = </span><span class="default">explode</span><span class="keyword">(</span><span class="string">&apos; &apos;</span><span class="keyword">, </span><span class="default">microtime</span><span class="keyword">());<br>&#xA0; &#xA0; &#xA0; &#xA0; <br>&#xA0; &#xA0; &#xA0; &#xA0; if ( </span><span class="default">$unset_timer </span><span class="keyword">)<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; unset( </span><span class="default">$timers</span><span class="keyword">[ </span><span class="default">$name </span><span class="keyword">] );<br>&#xA0; &#xA0; &#xA0; &#xA0; <br>&#xA0; &#xA0; &#xA0; &#xA0; return </span><span class="default">$e_sec </span><span class="keyword">- </span><span class="default">$s_sec </span><span class="keyword">+ ( </span><span class="default">$e_mic </span><span class="keyword">- </span><span class="default">$s_mic </span><span class="keyword">);<br>&#xA0; &#xA0; }<br>&#xA0; &#xA0; <br>&#xA0; &#xA0; </span><span class="default">$timers</span><span class="keyword">[ </span><span class="default">$name </span><span class="keyword">] = </span><span class="default">microtime</span><span class="keyword">();<br>};<br><br>function </span><span class="default">f1 </span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">) {<br>&#xA0; &#xA0; </span><span class="default">$iterator </span><span class="keyword">= new </span><span class="default">RecursiveIteratorIterator</span><span class="keyword">(new </span><span class="default">RecursiveArrayIterator</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">), </span><span class="default">RecursiveIteratorIterator</span><span class="keyword">::</span><span class="default">SELF_FIRST</span><span class="keyword">);<br><br>&#xA0; &#xA0; foreach ( </span><span class="default">$iterator </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$value </span><span class="keyword">) {<br>&#xA0; &#xA0; &#xA0; &#xA0; if ( </span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">) )<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; continue;<br>&#xA0; &#xA0; }<br>}<br><br>function </span><span class="default">f2</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">) {<br>&#xA0; &#xA0; foreach ( </span><span class="default">$array </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$value </span><span class="keyword">) {<br>&#xA0; &#xA0; &#xA0; &#xA0; if ( </span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">) )<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">f2</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">);<br>&#xA0; &#xA0; }<br>}<br><br>foreach ( [</span><span class="default">100</span><span class="keyword">, </span><span class="default">1000</span><span class="keyword">, </span><span class="default">10000</span><span class="keyword">, </span><span class="default">100000</span><span class="keyword">, </span><span class="default">1000000</span><span class="keyword">] as </span><span class="default">$num </span><span class="keyword">)<br>{<br>&#xA0; &#xA0; </span><span class="default">$array </span><span class="keyword">= [];<br>&#xA0; &#xA0; <br>&#xA0; &#xA0; for ( </span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; ++</span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$num</span><span class="keyword">; )<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$array</span><span class="keyword">[] = [</span><span class="default">1</span><span class="keyword">,</span><span class="default">2</span><span class="keyword">,</span><span class="default">3</span><span class="keyword">=&gt;[</span><span class="default">4</span><span class="keyword">,</span><span class="default">5</span><span class="keyword">,</span><span class="default">6</span><span class="keyword">=&gt;[</span><span class="default">7</span><span class="keyword">,</span><span class="default">8</span><span class="keyword">,</span><span class="default">9</span><span class="keyword">=&gt;</span><span class="default">10</span><span class="keyword">,</span><span class="default">11</span><span class="keyword">,</span><span class="default">12</span><span class="keyword">=&gt;[</span><span class="default">13</span><span class="keyword">,</span><span class="default">14</span><span class="keyword">,</span><span class="default">15</span><span class="keyword">=&gt;[</span><span class="default">16</span><span class="keyword">,</span><span class="default">17</span><span class="keyword">,</span><span class="default">18</span><span class="keyword">]]]]];<br>&#xA0; &#xA0; <br>&#xA0; &#xA0; </span><span class="default">$timer</span><span class="keyword">();<br>&#xA0; &#xA0; </span><span class="default">f1</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">);<br>&#xA0; &#xA0; </span><span class="default">printf</span><span class="keyword">(</span><span class="string">&quot;RecursiveIteratorIterator: %7d elements -&gt; %.3f sec\n&quot;</span><span class="keyword">, </span><span class="default">$num</span><span class="keyword">, </span><span class="default">$timer</span><span class="keyword">());<br>&#xA0; &#xA0; <br>&#xA0; &#xA0; </span><span class="default">$timer</span><span class="keyword">();<br>&#xA0; &#xA0; </span><span class="default">f2</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">);<br>&#xA0; &#xA0; </span><span class="default">printf</span><span class="keyword">(</span><span class="string">&quot;Recursive function&#xA0; &#xA0; &#xA0;&#xA0; : %7d elements -&gt; %.3f sec\n&quot;</span><span class="keyword">, </span><span class="default">$num</span><span class="keyword">, </span><span class="default">$timer</span><span class="keyword">());<br>}<br><br></span><span class="default">?&gt;<br></span><br>Output (PHP 5.4.9-4ubuntu2.1 (cli) (built: Jun 11 2013 13:10:01))<br>=======================<br>RecursiveIteratorIterator:&#xA0; &#xA0;&#xA0; 100 elements -&gt; 0.007 sec<br>Recursive function&#xA0; &#xA0; &#xA0;&#xA0; :&#xA0; &#xA0;&#xA0; 100 elements -&gt; 0.002 sec<br>RecursiveIteratorIterator:&#xA0; &#xA0; 1000 elements -&gt; 0.036 sec<br>Recursive function&#xA0; &#xA0; &#xA0;&#xA0; :&#xA0; &#xA0; 1000 elements -&gt; 0.024 sec<br>RecursiveIteratorIterator:&#xA0;&#xA0; 10000 elements -&gt; 0.425 sec<br>Recursive function&#xA0; &#xA0; &#xA0;&#xA0; :&#xA0;&#xA0; 10000 elements -&gt; 0.263 sec<br>RecursiveIteratorIterator:&#xA0; 100000 elements -&gt; 8.153 sec<br>Recursive function&#xA0; &#xA0; &#xA0;&#xA0; :&#xA0; 100000 elements -&gt; 2.654 sec<br>RecursiveIteratorIterator: 1000000 elements -&gt; 474.483 sec<br>Recursive function&#xA0; &#xA0; &#xA0;&#xA0; : 1000000 elements -&gt; 26.872 sec<br><br>For one million elements recursive function is more quickly!</span>
</div>
  

#


<div class="phpcode"><span class="html">
A very useful use case for RecusiveIteratorIterator in combination with RecursiveArrayIterator is to replace array values on a multidimensional array at any level deep.<br><br>Usually, array_walk_recursive would be used to replace values deep within arrays, but unfortunately this only works when there is a standard key value pair - in other words, array_walk_recursive ONLY VISITS LEAF NODES, NOT arrays.<br><br>So to get around this, the iterators can be used in this way:<br><br><span class="default">&lt;?php<br>$array </span><span class="keyword">= [<br>&#xA0; &#xA0; </span><span class="string">&apos;test&apos; </span><span class="keyword">=&gt; </span><span class="string">&apos;value&apos;</span><span class="keyword">,<br>&#xA0; &#xA0; </span><span class="string">&apos;level_one&apos; </span><span class="keyword">=&gt; [<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="string">&apos;level_two&apos; </span><span class="keyword">=&gt; [<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="string">&apos;level_three&apos; </span><span class="keyword">=&gt; [<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="string">&apos;replace_this_array&apos; </span><span class="keyword">=&gt; [<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="string">&apos;special_key&apos; </span><span class="keyword">=&gt; </span><span class="string">&apos;replacement_value&apos;</span><span class="keyword">,<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="string">&apos;key_one&apos; </span><span class="keyword">=&gt; </span><span class="string">&apos;testing&apos;</span><span class="keyword">,<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="string">&apos;key_two&apos; </span><span class="keyword">=&gt; </span><span class="string">&apos;value&apos;</span><span class="keyword">,<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="string">&apos;four&apos; </span><span class="keyword">=&gt; </span><span class="string">&apos;another value&apos;<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="keyword">]<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; ],<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="string">&apos;ordinary_key&apos; </span><span class="keyword">=&gt; </span><span class="string">&apos;value&apos;<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="keyword">]<br>&#xA0; &#xA0; ]<br>];<br><br></span><span class="default">$arrayIterator </span><span class="keyword">= new \</span><span class="default">RecursiveArrayIterator</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">);<br></span><span class="default">$recursiveIterator </span><span class="keyword">= new \</span><span class="default">RecursiveIteratorIterator</span><span class="keyword">(</span><span class="default">$arrayIterator</span><span class="keyword">, \</span><span class="default">RecursiveIteratorIterator</span><span class="keyword">::</span><span class="default">SELF_FIRST</span><span class="keyword">);<br><br>foreach (</span><span class="default">$recursiveIterator </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$value</span><span class="keyword">) {<br>&#xA0; &#xA0; if (</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">) &amp;&amp; </span><span class="default">array_key_exists</span><span class="keyword">(</span><span class="string">&apos;special_key&apos;</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">)) {<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="comment">// Here we replace ALL keys with the same value from &apos;special_key&apos;<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$replaced </span><span class="keyword">= </span><span class="default">array_fill</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="default">count</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">), </span><span class="default">$value</span><span class="keyword">[</span><span class="string">&apos;special_key&apos;</span><span class="keyword">]);<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$value </span><span class="keyword">= </span><span class="default">array_combine</span><span class="keyword">(</span><span class="default">array_keys</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">), </span><span class="default">$replaced</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="comment">// set a new key<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$value</span><span class="keyword">[</span><span class="string">&apos;new_key&apos;</span><span class="keyword">] = </span><span class="string">&apos;new value&apos;</span><span class="keyword">;<br><br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="comment">// Get the current depth and traverse back up the tree, saving the modifications<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$currentDepth </span><span class="keyword">= </span><span class="default">$recursiveIterator</span><span class="keyword">-&gt;</span><span class="default">getDepth</span><span class="keyword">();<br>&#xA0; &#xA0; &#xA0; &#xA0; for (</span><span class="default">$subDepth </span><span class="keyword">= </span><span class="default">$currentDepth</span><span class="keyword">; </span><span class="default">$subDepth </span><span class="keyword">&gt;= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$subDepth</span><span class="keyword">--) {<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="comment">// Get the current level iterator<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$subIterator </span><span class="keyword">= </span><span class="default">$recursiveIterator</span><span class="keyword">-&gt;</span><span class="default">getSubIterator</span><span class="keyword">(</span><span class="default">$subDepth</span><span class="keyword">); <br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="comment">// If we are on the level we want to change, use the replacements ($value) other wise set the key to the parent iterators value<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$subIterator</span><span class="keyword">-&gt;</span><span class="default">offsetSet</span><span class="keyword">(</span><span class="default">$subIterator</span><span class="keyword">-&gt;</span><span class="default">key</span><span class="keyword">(), (</span><span class="default">$subDepth </span><span class="keyword">=== </span><span class="default">$currentDepth </span><span class="keyword">? </span><span class="default">$value </span><span class="keyword">: </span><span class="default">$recursiveIterator</span><span class="keyword">-&gt;</span><span class="default">getSubIterator</span><span class="keyword">((</span><span class="default">$subDepth</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">))-&gt;</span><span class="default">getArrayCopy</span><span class="keyword">())); <br>&#xA0; &#xA0; &#xA0;&#xA0; }<br>&#xA0; &#xA0; }<br>}<br>return </span><span class="default">$recursiveIterator</span><span class="keyword">-&gt;</span><span class="default">getArrayCopy</span><span class="keyword">();<br></span><span class="comment">// return:<br></span><span class="default">$array </span><span class="keyword">= [<br>&#xA0; &#xA0; </span><span class="string">&apos;test&apos; </span><span class="keyword">=&gt; </span><span class="string">&apos;value&apos;</span><span class="keyword">,<br>&#xA0; &#xA0; </span><span class="string">&apos;level_one&apos; </span><span class="keyword">=&gt; [<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="string">&apos;level_two&apos; </span><span class="keyword">=&gt; [<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="string">&apos;level_three&apos; </span><span class="keyword">=&gt; [<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="string">&apos;replace_this_array&apos; </span><span class="keyword">=&gt; [<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="string">&apos;special_key&apos; </span><span class="keyword">=&gt; </span><span class="string">&apos;replacement_value&apos;</span><span class="keyword">,<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="string">&apos;key_one&apos; </span><span class="keyword">=&gt; </span><span class="string">&apos;replacement_value&apos;</span><span class="keyword">,<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="string">&apos;key_two&apos; </span><span class="keyword">=&gt; </span><span class="string">&apos;replacement_value&apos;</span><span class="keyword">,<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="string">&apos;four&apos; </span><span class="keyword">=&gt; </span><span class="string">&apos;replacement_value&apos;</span><span class="keyword">,<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="string">&apos;new_key&apos; </span><span class="keyword">=&gt; </span><span class="string">&apos;new value&apos;<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="keyword">]<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; ],<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="string">&apos;ordinary_key&apos; </span><span class="keyword">=&gt; </span><span class="string">&apos;value&apos;<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="keyword">]<br>&#xA0; &#xA0; ]<br>];<br></span><span class="default">?&gt;<br></span><br>The key is in traversing back up the tree to save the changes at that level - simply calling $recursiveIterator-&gt;offsetSet(); will only set a key on the root array.</span>
</div>
  

#


<div class="phpcode"><span class="html">
This example demonstrates using the getDepth() method with a RecursiveArrayIterator.<br><br><span class="default">&lt;?php<br>$tree </span><span class="keyword">= array();<br></span><span class="default">$tree</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">][</span><span class="default">2</span><span class="keyword">][</span><span class="default">3</span><span class="keyword">] = </span><span class="string">&apos;lemon&apos;</span><span class="keyword">;<br></span><span class="default">$tree</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">][</span><span class="default">4</span><span class="keyword">] = </span><span class="string">&apos;melon&apos;</span><span class="keyword">;<br></span><span class="default">$tree</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">][</span><span class="default">3</span><span class="keyword">] = </span><span class="string">&apos;orange&apos;</span><span class="keyword">;<br></span><span class="default">$tree</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">][</span><span class="default">5</span><span class="keyword">] = </span><span class="string">&apos;grape&apos;</span><span class="keyword">;<br></span><span class="default">$tree</span><span class="keyword">[</span><span class="default">3</span><span class="keyword">] = </span><span class="string">&apos;pineapple&apos;</span><span class="keyword">;<br><br></span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$tree</span><span class="keyword">);<br> <br></span><span class="default">$arrayiter </span><span class="keyword">= new </span><span class="default">RecursiveArrayIterator</span><span class="keyword">(</span><span class="default">$tree</span><span class="keyword">);<br></span><span class="default">$iteriter </span><span class="keyword">= new </span><span class="default">RecursiveIteratorIterator</span><span class="keyword">(</span><span class="default">$arrayiter</span><span class="keyword">);<br> <br>foreach (</span><span class="default">$iteriter </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$value</span><span class="keyword">) {<br>&#xA0; </span><span class="default">$d </span><span class="keyword">= </span><span class="default">$iteriter</span><span class="keyword">-&gt;</span><span class="default">getDepth</span><span class="keyword">();<br>&#xA0; echo </span><span class="string">&quot;depth=</span><span class="default">$d</span><span class="string"> k=</span><span class="default">$key</span><span class="string"> v=</span><span class="default">$value</span><span class="string">\n&quot;</span><span class="keyword">;<br>}<br></span><span class="default">?&gt;<br></span><br>The output of this would be:<br><br>Array<br>(<br>&#xA0; &#xA0; [1] =&gt; Array<br>&#xA0; &#xA0; &#xA0; &#xA0; (<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; [2] =&gt; Array<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; (<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; [3] =&gt; lemon<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; )<br><br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; [4] =&gt; melon<br>&#xA0; &#xA0; &#xA0; &#xA0; )<br><br>&#xA0; &#xA0; [2] =&gt; Array<br>&#xA0; &#xA0; &#xA0; &#xA0; (<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; [3] =&gt; orange<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; [5] =&gt; grape<br>&#xA0; &#xA0; &#xA0; &#xA0; )<br><br>&#xA0; &#xA0; [3] =&gt; pineapple<br>)<br><br>depth=2 k=3 v=lemon<br>depth=1 k=4 v=melon<br>depth=1 k=3 v=orange<br>depth=1 k=5 v=grape<br>depth=0 k=3 v=pineapple</span>
</div>
  

#


<div class="phpcode"><span class="html">
A very important thing to note about \RecursiveIteratorIterator is that it returns a flattened array when used with the iterator_to_array function. Ex:
<br>
<br><span class="default">&lt;?php
<br>$arr </span><span class="keyword">= array(</span><span class="string">&apos;Zero&apos;</span><span class="keyword">, </span><span class="string">&apos;name&apos;</span><span class="keyword">=&gt;</span><span class="string">&apos;Adil&apos;</span><span class="keyword">, </span><span class="string">&apos;address&apos; </span><span class="keyword">=&gt; array( </span><span class="string">&apos;city&apos;</span><span class="keyword">=&gt;</span><span class="string">&apos;Dubai&apos;</span><span class="keyword">, </span><span class="string">&apos;tel&apos; </span><span class="keyword">=&gt; array(</span><span class="string">&apos;int&apos; </span><span class="keyword">=&gt; </span><span class="default">971</span><span class="keyword">, </span><span class="string">&apos;tel&apos;</span><span class="keyword">=&gt;</span><span class="default">12345487</span><span class="keyword">)), </span><span class="string">&apos;&apos; </span><span class="keyword">=&gt; </span><span class="string">&apos;nothing&apos;</span><span class="keyword">);
<br>
<br></span><span class="default">$iterator </span><span class="keyword">= new \</span><span class="default">RecursiveIteratorIterator</span><span class="keyword">(new \</span><span class="default">RecursiveArrayIterator</span><span class="keyword">(</span><span class="default">$arr</span><span class="keyword">));
<br></span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">iterator_to_array</span><span class="keyword">(</span><span class="default">$iterator</span><span class="keyword">,</span><span class="default">true</span><span class="keyword">));
<br></span><span class="default">?&gt;
<br></span>
<br>This code will return :
<br>
<br>array(6) {
<br>&#xA0; [0]=&gt;
<br>&#xA0; string(4) &quot;Zero&quot;
<br>&#xA0; [&quot;name&quot;]=&gt;
<br>&#xA0; string(4) &quot;Adil&quot;
<br>&#xA0; [&quot;city&quot;]=&gt;
<br>&#xA0; string(5) &quot;Dubai&quot;
<br>&#xA0; [&quot;int&quot;]=&gt;
<br>&#xA0; int(91)
<br>&#xA0; [&quot;tel&quot;]=&gt;
<br>&#xA0; int(12345487)
<br>&#xA0; [&quot;&quot;]=&gt;
<br>&#xA0; string(7) &quot;nothing&quot;
<br>}
<br>
<br>To get the non-flattened proper array use the getArrayCopy() method, like so :
<br>
<br>$iterator-&gt;getArrayCopy()
<br>
<br>This will return
<br>
<br>array(4) {
<br>&#xA0; [0]=&gt;
<br>&#xA0; string(4) &quot;Zero&quot;
<br>&#xA0; [&quot;name&quot;]=&gt;
<br>&#xA0; string(4) &quot;Adil&quot;
<br>&#xA0; [&quot;address&quot;]=&gt;
<br>&#xA0; array(2) {
<br>&#xA0; &#xA0; [&quot;city&quot;]=&gt;
<br>&#xA0; &#xA0; string(5) &quot;Dubai&quot;
<br>&#xA0; &#xA0; [&quot;tel&quot;]=&gt;
<br>&#xA0; &#xA0; array(2) {
<br>&#xA0; &#xA0; &#xA0; [&quot;int&quot;]=&gt;
<br>&#xA0; &#xA0; &#xA0; int(91)
<br>&#xA0; &#xA0; &#xA0; [&quot;tel&quot;]=&gt;
<br>&#xA0; &#xA0; &#xA0; int(12345487)
<br>&#xA0; &#xA0; }
<br>&#xA0; }
<br>&#xA0; [&quot;&quot;]=&gt;
<br>&#xA0; string(7) &quot;nothing&quot;
<br>}</span>
</div>
  

#


<div class="phpcode"><span class="html">
You can use this to quickly find all the files (recursively) in a certain directory. This beats maintaining a stack yourself.<br><span class="default">&lt;?php<br>$directory </span><span class="keyword">= </span><span class="string">&quot;/tmp/&quot;</span><span class="keyword">;<br></span><span class="default">$fileSPLObjects </span><span class="keyword">=&#xA0; new </span><span class="default">RecursiveIteratorIterator</span><span class="keyword">(<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; new </span><span class="default">RecursiveDirectoryIterator</span><span class="keyword">(</span><span class="default">$directory</span><span class="keyword">),<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">RecursiveIteratorIterator</span><span class="keyword">::</span><span class="default">CHILD_FIRST<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="keyword">);<br>try {<br>&#xA0; &#xA0; foreach( </span><span class="default">$fileSPLObjects </span><span class="keyword">as </span><span class="default">$fullFileName </span><span class="keyword">=&gt; </span><span class="default">$fileSPLObject </span><span class="keyword">) {<br>&#xA0; &#xA0; &#xA0; &#xA0; print </span><span class="default">$fullFileName </span><span class="keyword">. </span><span class="string">&quot; &quot; </span><span class="keyword">. </span><span class="default">$fileSPLObject</span><span class="keyword">-&gt;</span><span class="default">getFilename</span><span class="keyword">() . </span><span class="string">&quot;\n&quot;</span><span class="keyword">;<br>&#xA0; &#xA0; }<br>}<br>catch (</span><span class="default">UnexpectedValueException $e</span><span class="keyword">) {<br>&#xA0; &#xA0; </span><span class="default">printf</span><span class="keyword">(</span><span class="string">&quot;Directory [%s] contained a directory we can not recurse into&quot;</span><span class="keyword">, </span><span class="default">$directory</span><span class="keyword">);<br>}<br></span><span class="default">?&gt;<br></span>Note: if there is a directory contained within the directory you are searching in that you have no access to read an UnexpectedValueException will be thrown (leaving you with an empty list).<br>Note: objects returned are SPLFileObjects</span>
</div>
  

#

[Official documentation page](https://www.php.net/manual/en/class.recursiveiteratoriterator.php)

**[To root](/README.md)**