# getopt




<div class="phpcode"><span class="html">
&quot;phpnotes at kipu dot co dot uk&quot; and &quot;tim at digicol dot de&quot; are both wrong or misleading.&#xA0; Sean was correct.&#xA0; Quoted space-containing strings on the command line are one argument.&#xA0; It has to do with how the shell handles the command line, more than PHP.&#xA0; PHP&apos;s getopt() is modeled on and probably built upon the Unix/POSIX/C library getopt(3) which treats strings as strings, and does not break them apart on white space.<br><br>Here&apos;s proof:<br><br>$ cat opt.php<br>#! /usr/local/bin/php<br><span class="default">&lt;?php<br>$options </span><span class="keyword">= </span><span class="default">getopt</span><span class="keyword">(</span><span class="string">&quot;f:&quot;</span><span class="keyword">);<br></span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$options</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span>$ opt.php -f a b c<br>Array<br>(<br>&#xA0; &#xA0; [f] =&gt; a<br>)<br>$ opt.php -f &apos;a b c&apos;<br>Array<br>(<br>&#xA0; &#xA0; [f] =&gt; a b c<br>)<br>$ opt.php -f &quot;a b c&quot;<br>Array<br>(<br>&#xA0; &#xA0; [f] =&gt; a b c<br>)<br>$ opt.php -f a\ b\ c<br>Array<br>(<br>&#xA0; &#xA0; [f] =&gt; a b c<br>)<br>$</span>
</div>
  

#


<div class="phpcode"><span class="html">
Sometimes you will want to run a script from both the command line and as a web page, for example to debug with better output or a command line version that writes an image to the system but a web version that prints the image in the browser. You can use this function to get the same options whether passed as command line arguments or as $_REQUEST values.<br><br><span class="default">&lt;?php<br></span><span class="comment">/**<br> * Get options from the command line or web request<br> * <br> * @param string $options<br> * @param array $longopts<br> * @return array<br> */<br></span><span class="keyword">function </span><span class="default">getoptreq </span><span class="keyword">(</span><span class="default">$options</span><span class="keyword">, </span><span class="default">$longopts</span><span class="keyword">)<br>{<br>&#xA0;&#xA0; if (</span><span class="default">PHP_SAPI </span><span class="keyword">=== </span><span class="string">&apos;cli&apos; </span><span class="keyword">|| empty(</span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">&apos;REMOTE_ADDR&apos;</span><span class="keyword">]))&#xA0; </span><span class="comment">// command line<br>&#xA0;&#xA0; </span><span class="keyword">{<br>&#xA0; &#xA0; &#xA0; return </span><span class="default">getopt</span><span class="keyword">(</span><span class="default">$options</span><span class="keyword">, </span><span class="default">$longopts</span><span class="keyword">);<br>&#xA0;&#xA0; }<br>&#xA0;&#xA0; else if (isset(</span><span class="default">$_REQUEST</span><span class="keyword">))&#xA0; </span><span class="comment">// web script<br>&#xA0;&#xA0; </span><span class="keyword">{<br>&#xA0; &#xA0; &#xA0; </span><span class="default">$found </span><span class="keyword">= array();<br><br>&#xA0; &#xA0; &#xA0; </span><span class="default">$shortopts </span><span class="keyword">= </span><span class="default">preg_split</span><span class="keyword">(</span><span class="string">&apos;@([a-z0-9][:]{0,2})@i&apos;</span><span class="keyword">, </span><span class="default">$options</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">PREG_SPLIT_DELIM_CAPTURE </span><span class="keyword">| </span><span class="default">PREG_SPLIT_NO_EMPTY</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; </span><span class="default">$opts </span><span class="keyword">= </span><span class="default">array_merge</span><span class="keyword">(</span><span class="default">$shortopts</span><span class="keyword">, </span><span class="default">$longopts</span><span class="keyword">);<br><br>&#xA0; &#xA0; &#xA0; foreach (</span><span class="default">$opts </span><span class="keyword">as </span><span class="default">$opt</span><span class="keyword">)<br>&#xA0; &#xA0; &#xA0; {<br>&#xA0; &#xA0; &#xA0; &#xA0;&#xA0; if (</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$opt</span><span class="keyword">, -</span><span class="default">2</span><span class="keyword">) === </span><span class="string">&apos;::&apos;</span><span class="keyword">)&#xA0; </span><span class="comment">// optional<br>&#xA0; &#xA0; &#xA0; &#xA0;&#xA0; </span><span class="keyword">{<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$key </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$opt</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, -</span><span class="default">2</span><span class="keyword">);<br><br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; if (isset(</span><span class="default">$_REQUEST</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">]) &amp;&amp; !empty(</span><span class="default">$_REQUEST</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">]))<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;&#xA0; </span><span class="default">$found</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">] = </span><span class="default">$_REQUEST</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">];<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; else if (isset(</span><span class="default">$_REQUEST</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">]))<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;&#xA0; </span><span class="default">$found</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">] = </span><span class="default">false</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0;&#xA0; }<br>&#xA0; &#xA0; &#xA0; &#xA0;&#xA0; else if (</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$opt</span><span class="keyword">, -</span><span class="default">1</span><span class="keyword">) === </span><span class="string">&apos;:&apos;</span><span class="keyword">)&#xA0; </span><span class="comment">// required value<br>&#xA0; &#xA0; &#xA0; &#xA0;&#xA0; </span><span class="keyword">{<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$key </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$opt</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, -</span><span class="default">1</span><span class="keyword">);<br><br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; if (isset(</span><span class="default">$_REQUEST</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">]) &amp;&amp; !empty(</span><span class="default">$_REQUEST</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">]))<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;&#xA0; </span><span class="default">$found</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">] = </span><span class="default">$_REQUEST</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">];<br>&#xA0; &#xA0; &#xA0; &#xA0;&#xA0; }<br>&#xA0; &#xA0; &#xA0; &#xA0;&#xA0; else if (</span><span class="default">ctype_alnum</span><span class="keyword">(</span><span class="default">$opt</span><span class="keyword">))&#xA0; </span><span class="comment">// no value<br>&#xA0; &#xA0; &#xA0; &#xA0;&#xA0; </span><span class="keyword">{<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; if (isset(</span><span class="default">$_REQUEST</span><span class="keyword">[</span><span class="default">$opt</span><span class="keyword">]))<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;&#xA0; </span><span class="default">$found</span><span class="keyword">[</span><span class="default">$opt</span><span class="keyword">] = </span><span class="default">false</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0;&#xA0; }<br>&#xA0; &#xA0; &#xA0; }<br><br>&#xA0; &#xA0; &#xA0; return </span><span class="default">$found</span><span class="keyword">;<br>&#xA0;&#xA0; }<br><br>&#xA0;&#xA0; return </span><span class="default">false</span><span class="keyword">;<br>}<br></span><span class="default">?&gt;<br></span><br>Example<br><br><span class="default">&lt;?php<br></span><span class="comment">// php script.php -a -c=XXX -e=YYY -f --two --four=ZZZ --five=5<br>// script.php?a&amp;c=XXX&amp;e=YYY&amp;f&amp;two&amp;four=ZZZ&amp;five=5<br><br></span><span class="default">$opts </span><span class="keyword">= </span><span class="default">getoptreq</span><span class="keyword">(</span><span class="string">&apos;abc:d:e::f::&apos;</span><span class="keyword">, array(</span><span class="string">&apos;one&apos;</span><span class="keyword">, </span><span class="string">&apos;two&apos;</span><span class="keyword">, </span><span class="string">&apos;three:&apos;</span><span class="keyword">, </span><span class="string">&apos;four:&apos;</span><span class="keyword">, </span><span class="string">&apos;five::&apos;</span><span class="keyword">));<br><br></span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$opts</span><span class="keyword">);<br><br></span><span class="comment">/**<br>array(7) {<br>&#xA0; &apos;a&apos; =&gt; bool(false)<br>&#xA0; &apos;c&apos; =&gt; string(3) &quot;XXX&quot;<br>&#xA0; &apos;e&apos; =&gt; string(3) &quot;YYY&quot;<br>&#xA0; &apos;f&apos; =&gt; bool(false)<br>&#xA0; &apos;two&apos; =&gt; bool(false)<br>&#xA0; &apos;four&apos; =&gt; string(3) &quot;ZZZ&quot;<br>&#xA0; &apos;five&apos; =&gt; string(1) &quot;5&quot;<br>}<br>*/<br></span><span class="default">?&gt;</span>
</span>
</div>
  

#


<div class="phpcode"><span class="html">
Be sure to wrap your head around this PHP jewel that took me a while to comprehend:<br><br>The returned array will contain a boolean FALSE for options that HAVE been specified.<br><br>Because why use TRUE to indicate &quot;yes, it&apos;s there&quot; when you can also use FALSE for that purpose, right? This is completely counter-intuitive and is most certainly only ever possible in PHP-land.</span>
</div>
  

#


<div class="phpcode"><span class="html">
getopt() only returns the options specified if they were listed in the options.<br><br>So you cant make a switch() use default: to complain of an unknown option. :(</span>
</div>
  

#

[Official documentation page](https://www.php.net/manual/en/function.getopt.php)

**[To root](/)**