# dir




<div class="phpcode"><span class="html">
Here my solution how to do effective recursiv directory listing.<br><br>Have fun.<br><br><span class="default">&lt;?php<br><br></span><span class="comment">/**<br> * example of use: <br> */<br></span><span class="default">$d </span><span class="keyword">= new </span><span class="default">RecDir</span><span class="keyword">(</span><span class="string">&quot;/etc/&quot;</span><span class="keyword">,</span><span class="default">false</span><span class="keyword">);<br>echo </span><span class="string">&quot;Path: &quot; </span><span class="keyword">. </span><span class="default">$d</span><span class="keyword">-&gt;</span><span class="default">getRootPath</span><span class="keyword">() . </span><span class="string">&quot;\n&quot;</span><span class="keyword">;<br>while (</span><span class="default">false </span><span class="keyword">!== (</span><span class="default">$entry </span><span class="keyword">= </span><span class="default">$d</span><span class="keyword">-&gt;</span><span class="default">read</span><span class="keyword">())) {<br>&#xA0;&#xA0; echo </span><span class="default">$entry</span><span class="keyword">.</span><span class="string">&quot;\n&quot;</span><span class="keyword">;<br>}<br></span><span class="default">$d</span><span class="keyword">-&gt;</span><span class="default">close</span><span class="keyword">();<br><br>class </span><span class="default">RecDir<br></span><span class="keyword">{<br>&#xA0;&#xA0; protected </span><span class="default">$currentPath</span><span class="keyword">;<br>&#xA0;&#xA0; protected </span><span class="default">$slash</span><span class="keyword">;<br>&#xA0;&#xA0; protected </span><span class="default">$rootPath</span><span class="keyword">;<br>&#xA0;&#xA0; protected </span><span class="default">$recursiveTree</span><span class="keyword">;&#xA0;&#xA0; <br><br>&#xA0;&#xA0; function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$rootPath</span><span class="keyword">,</span><span class="default">$win</span><span class="keyword">=</span><span class="default">false</span><span class="keyword">)<br>&#xA0;&#xA0; {<br>&#xA0; &#xA0; &#xA0; switch(</span><span class="default">$win</span><span class="keyword">)<br>&#xA0; &#xA0; &#xA0; {<br>&#xA0; &#xA0; &#xA0; &#xA0;&#xA0; case </span><span class="default">true</span><span class="keyword">:<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">slash </span><span class="keyword">= </span><span class="string">&apos;\\&apos;</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; break;<br>&#xA0; &#xA0; &#xA0; &#xA0;&#xA0; default:<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">slash </span><span class="keyword">= </span><span class="string">&apos;/&apos;</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; }<br>&#xA0; &#xA0; &#xA0; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">rootPath </span><span class="keyword">= </span><span class="default">$rootPath</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">currentPath </span><span class="keyword">= </span><span class="default">$rootPath</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">recursiveTree </span><span class="keyword">= array(</span><span class="default">dir</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">rootPath</span><span class="keyword">));<br>&#xA0; &#xA0; &#xA0; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">rewind</span><span class="keyword">();<br>&#xA0;&#xA0; }<br><br>&#xA0;&#xA0; function </span><span class="default">__destruct</span><span class="keyword">()<br>&#xA0;&#xA0; {<br>&#xA0; &#xA0; &#xA0; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">close</span><span class="keyword">();<br>&#xA0;&#xA0; }<br><br>&#xA0;&#xA0; public function </span><span class="default">close</span><span class="keyword">()<br>&#xA0;&#xA0; {<br>&#xA0; &#xA0; &#xA0; while(</span><span class="default">true </span><span class="keyword">=== (</span><span class="default">$d </span><span class="keyword">= </span><span class="default">array_pop</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">recursiveTree</span><span class="keyword">)))<br>&#xA0; &#xA0; &#xA0; {<br>&#xA0; &#xA0; &#xA0; &#xA0;&#xA0; </span><span class="default">$d</span><span class="keyword">-&gt;</span><span class="default">close</span><span class="keyword">();<br>&#xA0; &#xA0; &#xA0; }<br>&#xA0;&#xA0; }<br><br>&#xA0;&#xA0; public function </span><span class="default">closeChildren</span><span class="keyword">()<br>&#xA0;&#xA0; {<br>&#xA0; &#xA0; &#xA0; while(</span><span class="default">count</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">recursiveTree</span><span class="keyword">)&gt;</span><span class="default">1 </span><span class="keyword">&amp;&amp; </span><span class="default">false </span><span class="keyword">!== (</span><span class="default">$d </span><span class="keyword">= </span><span class="default">array_pop</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">recursiveTree</span><span class="keyword">)))<br>&#xA0; &#xA0; &#xA0; {<br>&#xA0; &#xA0; &#xA0; &#xA0;&#xA0; </span><span class="default">$d</span><span class="keyword">-&gt;</span><span class="default">close</span><span class="keyword">();<br>&#xA0; &#xA0; &#xA0; &#xA0;&#xA0; return </span><span class="default">true</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; }<br>&#xA0; &#xA0; &#xA0; return </span><span class="default">false</span><span class="keyword">;<br>&#xA0;&#xA0; }<br><br>&#xA0;&#xA0; public function </span><span class="default">getRootPath</span><span class="keyword">()<br>&#xA0;&#xA0; {<br>&#xA0; &#xA0; &#xA0; if(isset(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">rootPath</span><span class="keyword">))<br>&#xA0; &#xA0; &#xA0; {<br>&#xA0; &#xA0; &#xA0; &#xA0;&#xA0; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">rootPath</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; }<br>&#xA0; &#xA0; &#xA0; return </span><span class="default">false</span><span class="keyword">;<br>&#xA0;&#xA0; }<br><br>&#xA0;&#xA0; public function </span><span class="default">getCurrentPath</span><span class="keyword">()<br>&#xA0;&#xA0; {<br>&#xA0; &#xA0; &#xA0; if(isset(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">currentPath</span><span class="keyword">))<br>&#xA0; &#xA0; &#xA0; {<br>&#xA0; &#xA0; &#xA0; &#xA0;&#xA0; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">currentPath</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; }<br>&#xA0; &#xA0; &#xA0; return </span><span class="default">false</span><span class="keyword">;<br>&#xA0;&#xA0; }<br>&#xA0;&#xA0; <br>&#xA0;&#xA0; public function </span><span class="default">read</span><span class="keyword">()<br>&#xA0;&#xA0; {<br>&#xA0; &#xA0; &#xA0; while(</span><span class="default">count</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">recursiveTree</span><span class="keyword">)&gt;</span><span class="default">0</span><span class="keyword">)<br>&#xA0; &#xA0; &#xA0; {<br>&#xA0; &#xA0; &#xA0; &#xA0;&#xA0; </span><span class="default">$d </span><span class="keyword">= </span><span class="default">end</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">recursiveTree</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0;&#xA0; if((</span><span class="default">false </span><span class="keyword">!== (</span><span class="default">$entry </span><span class="keyword">= </span><span class="default">$d</span><span class="keyword">-&gt;</span><span class="default">read</span><span class="keyword">())))<br>&#xA0; &#xA0; &#xA0; &#xA0;&#xA0; {<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; if(</span><span class="default">$entry</span><span class="keyword">!=</span><span class="string">&apos;.&apos; </span><span class="keyword">&amp;&amp; </span><span class="default">$entry</span><span class="keyword">!=</span><span class="string">&apos;..&apos;</span><span class="keyword">)<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; {<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;&#xA0; </span><span class="default">$path </span><span class="keyword">= </span><span class="default">$d</span><span class="keyword">-&gt;</span><span class="default">path</span><span class="keyword">.</span><span class="default">$entry</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;&#xA0; <br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;&#xA0; if(</span><span class="default">is_file</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">))<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;&#xA0; {<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; return </span><span class="default">$path</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;&#xA0; }<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;&#xA0; elseif(</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">.</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">slash</span><span class="keyword">))<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;&#xA0; {<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">currentPath </span><span class="keyword">= </span><span class="default">$path</span><span class="keyword">.</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">slash</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; if(</span><span class="default">$child </span><span class="keyword">= @</span><span class="default">dir</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">.</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">slash</span><span class="keyword">))<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; {<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;&#xA0; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">recursiveTree</span><span class="keyword">[] = </span><span class="default">$child</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; }<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;&#xA0; }<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; }<br>&#xA0; &#xA0; &#xA0; &#xA0;&#xA0; }<br>&#xA0; &#xA0; &#xA0; &#xA0;&#xA0; else<br>&#xA0; &#xA0; &#xA0; &#xA0;&#xA0; {<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">array_pop</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">recursiveTree</span><span class="keyword">)-&gt;</span><span class="default">close</span><span class="keyword">();<br>&#xA0; &#xA0; &#xA0; &#xA0;&#xA0; }<br>&#xA0; &#xA0; &#xA0; }<br>&#xA0; &#xA0; &#xA0; return </span><span class="default">false</span><span class="keyword">;<br>&#xA0;&#xA0; }<br><br>&#xA0;&#xA0; public function </span><span class="default">rewind</span><span class="keyword">()<br>&#xA0;&#xA0; {<br>&#xA0; &#xA0; &#xA0; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">closeChildren</span><span class="keyword">();<br>&#xA0; &#xA0; &#xA0; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">rewindCurrent</span><span class="keyword">();<br>&#xA0;&#xA0; }<br><br>&#xA0;&#xA0; public function </span><span class="default">rewindCurrent</span><span class="keyword">()<br>&#xA0;&#xA0; {<br>&#xA0; &#xA0; &#xA0; return </span><span class="default">end</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">recursiveTree</span><span class="keyword">)-&gt;</span><span class="default">rewind</span><span class="keyword">();<br>&#xA0;&#xA0; }<br>}<br></span><span class="default">?&gt;</span>
</span>
</div>
  

#

[Official documentation page](https://www.php.net/manual/en/function.dir.php)

**[To root](/README.md)**