# Imagick::thumbnailImage




<div class="phpcode"><span class="html">
Even though thumbnailImage is meant to produce the smallest file size image possible, i found it didn&apos;t. I put together this code and bordering different compression settings, found it produced the smallest file size:<br><br><span class="default">&lt;?php<br></span><span class="comment">// Max vert or horiz resolution<br></span><span class="default">$maxsize</span><span class="keyword">=</span><span class="default">550</span><span class="keyword">;<br><br></span><span class="comment">// create new Imagick object<br></span><span class="default">$image </span><span class="keyword">= new </span><span class="default">Imagick</span><span class="keyword">(</span><span class="string">&apos;input_image_filename_and_location&apos;</span><span class="keyword">);<br><br></span><span class="comment">// Resizes to whichever is larger, width or height<br></span><span class="keyword">if(</span><span class="default">$image</span><span class="keyword">-&gt;</span><span class="default">getImageHeight</span><span class="keyword">() &lt;= </span><span class="default">$image</span><span class="keyword">-&gt;</span><span class="default">getImageWidth</span><span class="keyword">())<br>{<br></span><span class="comment">// Resize image using the lanczos resampling algorithm based on width<br></span><span class="default">$image</span><span class="keyword">-&gt;</span><span class="default">resizeImage</span><span class="keyword">(</span><span class="default">$maxsize</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">Imagick</span><span class="keyword">::</span><span class="default">FILTER_LANCZOS</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">);<br>}<br>else<br>{<br></span><span class="comment">// Resize image using the lanczos resampling algorithm based on height<br></span><span class="default">$image</span><span class="keyword">-&gt;</span><span class="default">resizeImage</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">$maxsize</span><span class="keyword">,</span><span class="default">Imagick</span><span class="keyword">::</span><span class="default">FILTER_LANCZOS</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">);<br>}<br><br></span><span class="comment">// Set to use jpeg compression<br></span><span class="default">$image</span><span class="keyword">-&gt;</span><span class="default">setImageCompression</span><span class="keyword">(</span><span class="default">Imagick</span><span class="keyword">::</span><span class="default">COMPRESSION_JPEG</span><span class="keyword">);<br></span><span class="comment">// Set compression level (1 lowest quality, 100 highest quality)<br></span><span class="default">$image</span><span class="keyword">-&gt;</span><span class="default">setImageCompressionQuality</span><span class="keyword">(</span><span class="default">75</span><span class="keyword">);<br></span><span class="comment">// Strip out unneeded meta data<br></span><span class="default">$image</span><span class="keyword">-&gt;</span><span class="default">stripImage</span><span class="keyword">();<br></span><span class="comment">// Writes resultant image to output directory<br></span><span class="default">$image</span><span class="keyword">-&gt;</span><span class="default">writeImage</span><span class="keyword">(</span><span class="string">&apos;output_image_filename_and_location&apos;</span><span class="keyword">);<br></span><span class="comment">// Destroys Imagick object, freeing allocated resources in the process<br></span><span class="default">$image</span><span class="keyword">-&gt;</span><span class="default">destroy</span><span class="keyword">();<br><br></span><span class="default">?&gt;<br></span><br>I found setCompression to not function at all and had to use setImageCompression. The stripImage call is needed and strips out unneeded meta data. You can choose whatever filter you want, but i found lanczos to be the best for image reduction, though it is more computationally heavy.</span>
</div>
  

#

[Official documentation page](https://www.php.net/manual/en/imagick.thumbnailimage.php)

**[â¬† to root](/)**