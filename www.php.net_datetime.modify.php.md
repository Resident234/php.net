# DateTime::modify




<div class="phpcode"><span class="html">
a slightly more compact way of getting the month shift<br><br><span class="default">&lt;?php<br><br>&#xA0; &#xA0; &#xA0; </span><span class="comment">/**<br>&#xA0; &#xA0;&#xA0; * correctly calculates end of months when we shift to a shorter or longer month<br>&#xA0; &#xA0;&#xA0; * workaround for <a href="http://php.net/manual/en/datetime.add.php#example-2489" rel="nofollow" target="_blank">http://php.net/manual/en/datetime.add.php#example-2489</a> <br>&#xA0; &#xA0;&#xA0; * <br>&#xA0; &#xA0;&#xA0; * Makes the assumption that shifting from the 28th Feb +1 month is 31st March<br>&#xA0; &#xA0;&#xA0; * Makes the assumption that shifting from the 28th Feb -1 month is 31st Jan<br>&#xA0; &#xA0;&#xA0; * Makes the assumption that shifting from the 29,30,31 Jan +1 month is 28th (or 29th) Feb<br>&#xA0; &#xA0;&#xA0; *<br>&#xA0; &#xA0;&#xA0; * <br>&#xA0; &#xA0;&#xA0; * @param DateTime $aDate<br>&#xA0; &#xA0;&#xA0; * @param int $months positive or negative<br>&#xA0; &#xA0;&#xA0; * <br>&#xA0; &#xA0;&#xA0; * @return DateTime new instance - original parameter is unchanged<br>&#xA0; &#xA0;&#xA0; */<br><br>&#xA0; &#xA0; </span><span class="keyword">function </span><span class="default">MonthShifter </span><span class="keyword">(</span><span class="default">DateTime $aDate</span><span class="keyword">,</span><span class="default">$months</span><span class="keyword">){<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$dateA </span><span class="keyword">= clone(</span><span class="default">$aDate</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$dateB </span><span class="keyword">= clone(</span><span class="default">$aDate</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$plusMonths </span><span class="keyword">= clone(</span><span class="default">$dateA</span><span class="keyword">-&gt;</span><span class="default">modify</span><span class="keyword">(</span><span class="default">$months </span><span class="keyword">. </span><span class="string">&apos; Month&apos;</span><span class="keyword">));<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="comment">//check whether reversing the month addition gives us the original day back<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="keyword">if(</span><span class="default">$dateB </span><span class="keyword">!= </span><span class="default">$dateA</span><span class="keyword">-&gt;</span><span class="default">modify</span><span class="keyword">(</span><span class="default">$months</span><span class="keyword">*-</span><span class="default">1 </span><span class="keyword">. </span><span class="string">&apos; Month&apos;</span><span class="keyword">)){ <br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">$plusMonths</span><span class="keyword">-&gt;</span><span class="default">modify</span><span class="keyword">(</span><span class="string">&apos;last day of last month&apos;</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; } elseif(</span><span class="default">$aDate </span><span class="keyword">== </span><span class="default">$dateB</span><span class="keyword">-&gt;</span><span class="default">modify</span><span class="keyword">(</span><span class="string">&apos;last day of this month&apos;</span><span class="keyword">)){<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$result </span><span class="keyword">=&#xA0; </span><span class="default">$plusMonths</span><span class="keyword">-&gt;</span><span class="default">modify</span><span class="keyword">(</span><span class="string">&apos;last day of this month&apos;</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; } else {<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">$plusMonths</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; }<br>&#xA0; &#xA0; &#xA0; &#xA0; return </span><span class="default">$result</span><span class="keyword">;<br>&#xA0; &#xA0; }<br><br></span><span class="comment">//TEST<br><br></span><span class="default">$x </span><span class="keyword">= new </span><span class="default">DateTime</span><span class="keyword">(</span><span class="string">&apos;2017-01-30&apos;</span><span class="keyword">);<br>echo( </span><span class="default">$x</span><span class="keyword">-&gt;</span><span class="default">format</span><span class="keyword">(</span><span class="string">&apos;Y-m-d&apos;</span><span class="keyword">).</span><span class="string">&quot; past end of feb, but not dec&lt;br&gt;&quot;</span><span class="keyword">);<br>echo(</span><span class="string">&apos;b &apos; </span><span class="keyword">. </span><span class="default">MonthShifter</span><span class="keyword">(</span><span class="default">$x</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">)-&gt;</span><span class="default">format</span><span class="keyword">((</span><span class="string">&apos;Y-m-d&apos;</span><span class="keyword">)).</span><span class="string">&quot;&lt;br&gt;&quot;</span><span class="keyword">);<br>echo(</span><span class="string">&apos;c &apos; </span><span class="keyword">. </span><span class="default">MonthShifter</span><span class="keyword">(</span><span class="default">$x</span><span class="keyword">,-</span><span class="default">1</span><span class="keyword">)-&gt;</span><span class="default">format</span><span class="keyword">((</span><span class="string">&apos;Y-m-d&apos;</span><span class="keyword">)).</span><span class="string">&quot;&lt;br&gt;&quot;</span><span class="keyword">);<br><br></span><span class="default">$x </span><span class="keyword">= new </span><span class="default">DateTime</span><span class="keyword">(</span><span class="string">&apos;2017-01-15&apos;</span><span class="keyword">);<br>echo(</span><span class="string">&quot;&lt;br&gt;&quot; </span><span class="keyword">. </span><span class="default">$x</span><span class="keyword">-&gt;</span><span class="default">format</span><span class="keyword">(</span><span class="string">&apos;Y-m-d&apos;</span><span class="keyword">).</span><span class="string">&quot; middle of the month &lt;br&gt;&quot;</span><span class="keyword">);<br>echo(</span><span class="string">&apos;d &apos; </span><span class="keyword">. </span><span class="default">MonthShifter</span><span class="keyword">(</span><span class="default">$x</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">)-&gt;</span><span class="default">format</span><span class="keyword">((</span><span class="string">&apos;Y-m-d&apos;</span><span class="keyword">)).</span><span class="string">&quot;&lt;br&gt;&quot;</span><span class="keyword">);<br>echo(</span><span class="string">&apos;e &apos; </span><span class="keyword">. </span><span class="default">MonthShifter</span><span class="keyword">(</span><span class="default">$x</span><span class="keyword">,-</span><span class="default">1</span><span class="keyword">)-&gt;</span><span class="default">format</span><span class="keyword">((</span><span class="string">&apos;Y-m-d&apos;</span><span class="keyword">)).</span><span class="string">&quot;&lt;br&gt;&quot;</span><span class="keyword">);<br><br></span><span class="default">$x </span><span class="keyword">= new </span><span class="default">DateTime</span><span class="keyword">(</span><span class="string">&apos;2017-02-28&apos;</span><span class="keyword">);<br>echo(</span><span class="string">&quot;&lt;br&gt;&quot; </span><span class="keyword">. </span><span class="default">$x</span><span class="keyword">-&gt;</span><span class="default">format</span><span class="keyword">(</span><span class="string">&apos;Y-m-d&apos;</span><span class="keyword">).</span><span class="string">&quot; end of Feb&lt;br&gt;&quot;</span><span class="keyword">);<br>echo(</span><span class="string">&apos;f &apos; </span><span class="keyword">. </span><span class="default">MonthShifter</span><span class="keyword">(</span><span class="default">$x</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">)-&gt;</span><span class="default">format</span><span class="keyword">((</span><span class="string">&apos;Y-m-d&apos;</span><span class="keyword">)).</span><span class="string">&quot;&lt;br&gt;&quot;</span><span class="keyword">);<br>echo(</span><span class="string">&apos;g &apos; </span><span class="keyword">. </span><span class="default">MonthShifter</span><span class="keyword">(</span><span class="default">$x</span><span class="keyword">,-</span><span class="default">1</span><span class="keyword">)-&gt;</span><span class="default">format</span><span class="keyword">((</span><span class="string">&apos;Y-m-d&apos;</span><span class="keyword">)).</span><span class="string">&quot;&lt;br&gt;&quot;</span><span class="keyword">);<br><br></span><span class="default">$x </span><span class="keyword">= new </span><span class="default">DateTime</span><span class="keyword">(</span><span class="string">&apos;2017-01-31&apos;</span><span class="keyword">);<br>echo(</span><span class="string">&quot;&lt;br&gt;&quot; </span><span class="keyword">.&#xA0; </span><span class="default">$x</span><span class="keyword">-&gt;</span><span class="default">format</span><span class="keyword">(</span><span class="string">&apos;Y-m-d&apos;</span><span class="keyword">).</span><span class="string">&quot; end of Jan&lt;br&gt;&quot;</span><span class="keyword">);<br>echo(</span><span class="string">&apos;h &apos; </span><span class="keyword">. </span><span class="default">MonthShifter</span><span class="keyword">(</span><span class="default">$x</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">)-&gt;</span><span class="default">format</span><span class="keyword">((</span><span class="string">&apos;Y-m-d&apos;</span><span class="keyword">)).</span><span class="string">&quot;&lt;br&gt;&quot;</span><span class="keyword">);<br>echo(</span><span class="string">&apos;i &apos; </span><span class="keyword">. </span><span class="default">MonthShifter</span><span class="keyword">(</span><span class="default">$x</span><span class="keyword">,-</span><span class="default">1</span><span class="keyword">)-&gt;</span><span class="default">format</span><span class="keyword">((</span><span class="string">&apos;Y-m-d&apos;</span><span class="keyword">)).</span><span class="string">&quot;&lt;br&gt;&quot;</span><span class="keyword">);<br><br></span><span class="default">$x </span><span class="keyword">= new </span><span class="default">DateTime</span><span class="keyword">(</span><span class="string">&apos;2017-01-31&apos;</span><span class="keyword">);<br>echo(</span><span class="string">&quot;&lt;br&gt;&quot; </span><span class="keyword">.&#xA0; </span><span class="default">$x</span><span class="keyword">-&gt;</span><span class="default">format</span><span class="keyword">(</span><span class="string">&apos;Y-m-d&apos;</span><span class="keyword">).</span><span class="string">&quot; end of Jan +/- 1 years diff, leap year respected&lt;br&gt;&quot;</span><span class="keyword">);<br>echo(</span><span class="string">&apos;j &apos; </span><span class="keyword">. </span><span class="default">MonthShifter</span><span class="keyword">(</span><span class="default">$x</span><span class="keyword">,</span><span class="default">13</span><span class="keyword">)-&gt;</span><span class="default">format</span><span class="keyword">((</span><span class="string">&apos;Y-m-d&apos;</span><span class="keyword">)).</span><span class="string">&quot;&lt;br&gt;&quot;</span><span class="keyword">);<br>echo(</span><span class="string">&apos;k &apos; </span><span class="keyword">. </span><span class="default">MonthShifter</span><span class="keyword">(</span><span class="default">$x</span><span class="keyword">,-</span><span class="default">11</span><span class="keyword">)-&gt;</span><span class="default">format</span><span class="keyword">((</span><span class="string">&apos;Y-m-d&apos;</span><span class="keyword">)).</span><span class="string">&quot;&lt;br&gt;&quot;</span><span class="keyword">);<br><br></span><span class="comment">//returns<br><br></span><span class="default">2017</span><span class="keyword">-</span><span class="default">01</span><span class="keyword">-</span><span class="default">30 past end of feb</span><span class="keyword">, </span><span class="default">but not dec<br>b 2017</span><span class="keyword">-</span><span class="default">02</span><span class="keyword">-</span><span class="default">28<br>c 2016</span><span class="keyword">-</span><span class="default">12</span><span class="keyword">-</span><span class="default">30<br><br>2017</span><span class="keyword">-</span><span class="default">01</span><span class="keyword">-</span><span class="default">15 middle of the month <br>d 2017</span><span class="keyword">-</span><span class="default">02</span><span class="keyword">-</span><span class="default">15<br>e 2016</span><span class="keyword">-</span><span class="default">12</span><span class="keyword">-</span><span class="default">15<br><br>2017</span><span class="keyword">-</span><span class="default">02</span><span class="keyword">-</span><span class="default">28end of Feb<br>f 2017</span><span class="keyword">-</span><span class="default">03</span><span class="keyword">-</span><span class="default">31<br>g 2017</span><span class="keyword">-</span><span class="default">01</span><span class="keyword">-</span><span class="default">31<br><br>2017</span><span class="keyword">-</span><span class="default">01</span><span class="keyword">-</span><span class="default">31end of Jan<br>h 2017</span><span class="keyword">-</span><span class="default">02</span><span class="keyword">-</span><span class="default">28<br>i 2016</span><span class="keyword">-</span><span class="default">12</span><span class="keyword">-</span><span class="default">31<br><br>2017</span><span class="keyword">-</span><span class="default">01</span><span class="keyword">-</span><span class="default">31end of Jan </span><span class="keyword">+/- </span><span class="default">1 years diff</span><span class="keyword">, </span><span class="default">leap year respected<br>j 2018</span><span class="keyword">-</span><span class="default">02</span><span class="keyword">-</span><span class="default">28<br>k 2016</span><span class="keyword">-</span><span class="default">02</span><span class="keyword">-</span><span class="default">29</span>
</span>
</div>
  

#


<div class="phpcode"><span class="html">
These functions makes sure that adding months or years always ends up in the month you would expect.&#xA0; Works for positive and negative values<br><br><span class="default">&lt;?php<br>&#xA0; &#xA0; &#xA0; <br>&#xA0; &#xA0; &#xA0;&#xA0; <br>&#xA0; &#xA0; $date</span><span class="keyword">=new </span><span class="default">DateTime</span><span class="keyword">();<br>&#xA0; &#xA0; </span><span class="default">$date</span><span class="keyword">-&gt;</span><span class="default">setDate</span><span class="keyword">(</span><span class="default">2008</span><span class="keyword">,</span><span class="default">2</span><span class="keyword">,</span><span class="default">29</span><span class="keyword">);<br>&#xA0; &#xA0; <br>&#xA0; &#xA0; function </span><span class="default">addMonths</span><span class="keyword">(</span><span class="default">$date</span><span class="keyword">,</span><span class="default">$months</span><span class="keyword">){<br>&#xA0; &#xA0; &#xA0; &#xA0;&#xA0; <br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$init</span><span class="keyword">=clone </span><span class="default">$date</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$modifier</span><span class="keyword">=</span><span class="default">$months</span><span class="keyword">.</span><span class="string">&apos; months&apos;</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$back_modifier </span><span class="keyword">=-</span><span class="default">$months</span><span class="keyword">.</span><span class="string">&apos; months&apos;</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; <br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$date</span><span class="keyword">-&gt;</span><span class="default">modify</span><span class="keyword">(</span><span class="default">$modifier</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$back_to_init</span><span class="keyword">= clone </span><span class="default">$date</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$back_to_init</span><span class="keyword">-&gt;</span><span class="default">modify</span><span class="keyword">(</span><span class="default">$back_modifier</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; <br>&#xA0; &#xA0; &#xA0; &#xA0; while(</span><span class="default">$init</span><span class="keyword">-&gt;</span><span class="default">format</span><span class="keyword">(</span><span class="string">&apos;m&apos;</span><span class="keyword">)!=</span><span class="default">$back_to_init</span><span class="keyword">-&gt;</span><span class="default">format</span><span class="keyword">(</span><span class="string">&apos;m&apos;</span><span class="keyword">)){<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$date</span><span class="keyword">-&gt;</span><span class="default">modify</span><span class="keyword">(</span><span class="string">&apos;-1 day&apos;</span><span class="keyword">)&#xA0; &#xA0; ;<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$back_to_init</span><span class="keyword">= clone </span><span class="default">$date</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$back_to_init</span><span class="keyword">-&gt;</span><span class="default">modify</span><span class="keyword">(</span><span class="default">$back_modifier</span><span class="keyword">);&#xA0; &#xA0; <br>&#xA0; &#xA0; &#xA0; &#xA0; }<br>&#xA0; &#xA0; &#xA0; &#xA0; <br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="comment">/*<br>&#xA0; &#xA0; &#xA0; &#xA0; if($months&lt;0&amp;&amp;$date-&gt;format(&apos;m&apos;)&gt;$init-&gt;format(&apos;m&apos;))<br>&#xA0; &#xA0; &#xA0; &#xA0; while($date-&gt;format(&apos;m&apos;)-12-$init-&gt;format(&apos;m&apos;)!=$months%12)<br>&#xA0; &#xA0; &#xA0; &#xA0; $date-&gt;modify(&apos;-1 day&apos;);<br>&#xA0; &#xA0; &#xA0; &#xA0; else<br>&#xA0; &#xA0; &#xA0; &#xA0; if($months&gt;0&amp;&amp;$date-&gt;format(&apos;m&apos;)&lt;$init-&gt;format(&apos;m&apos;))<br>&#xA0; &#xA0; &#xA0; &#xA0; while($date-&gt;format(&apos;m&apos;)+12-$init-&gt;format(&apos;m&apos;)!=$months%12)<br>&#xA0; &#xA0; &#xA0; &#xA0; $date-&gt;modify(&apos;-1 day&apos;);<br>&#xA0; &#xA0; &#xA0; &#xA0; else<br>&#xA0; &#xA0; &#xA0; &#xA0; while($date-&gt;format(&apos;m&apos;)-$init-&gt;format(&apos;m&apos;)!=$months%12)<br>&#xA0; &#xA0; &#xA0; &#xA0; $date-&gt;modify(&apos;-1 day&apos;);<br>&#xA0; &#xA0; &#xA0; &#xA0; */<br>&#xA0; &#xA0; &#xA0; &#xA0; <br>&#xA0; &#xA0; </span><span class="keyword">}<br>&#xA0; &#xA0;&#xA0; <br>&#xA0; &#xA0; function </span><span class="default">addYears</span><span class="keyword">(</span><span class="default">$date</span><span class="keyword">,</span><span class="default">$years</span><span class="keyword">){<br>&#xA0; &#xA0; &#xA0; &#xA0; <br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$init</span><span class="keyword">=clone </span><span class="default">$date</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$modifier</span><span class="keyword">=</span><span class="default">$years</span><span class="keyword">.</span><span class="string">&apos; years&apos;</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$date</span><span class="keyword">-&gt;</span><span class="default">modify</span><span class="keyword">(</span><span class="default">$modifier</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; <br>&#xA0; &#xA0; &#xA0; &#xA0; while(</span><span class="default">$date</span><span class="keyword">-&gt;</span><span class="default">format</span><span class="keyword">(</span><span class="string">&apos;m&apos;</span><span class="keyword">)!=</span><span class="default">$init</span><span class="keyword">-&gt;</span><span class="default">format</span><span class="keyword">(</span><span class="string">&apos;m&apos;</span><span class="keyword">))<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$date</span><span class="keyword">-&gt;</span><span class="default">modify</span><span class="keyword">(</span><span class="string">&apos;-1 day&apos;</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; <br>&#xA0; &#xA0; &#xA0; &#xA0; <br>&#xA0; &#xA0; } <br>&#xA0; &#xA0; <br>&#xA0; &#xA0; <br>&#xA0; &#xA0; <br>&#xA0; &#xA0; </span><span class="default">addMonths</span><span class="keyword">(</span><span class="default">$date</span><span class="keyword">,-</span><span class="default">1</span><span class="keyword">);<br>&#xA0; &#xA0;&#xA0; </span><span class="default">addYears</span><span class="keyword">(</span><span class="default">$date</span><span class="keyword">,</span><span class="default">3</span><span class="keyword">);<br>&#xA0; &#xA0; <br>&#xA0; &#xA0; <br>&#xA0; &#xA0; echo </span><span class="default">$date</span><span class="keyword">-&gt;</span><span class="default">format</span><span class="keyword">(</span><span class="string">&apos;F j,Y&apos;</span><span class="keyword">);<br>&#xA0; &#xA0;&#xA0; <br> <br></span><span class="default">?&gt;</span>
</span>
</div>
  

#

[Official documentation page](https://www.php.net/manual/en/datetime.modify.php)

**[To root](/README.md)**