# mysqli::$errormysqli_error




<div class="phpcode"><span class="html">
The mysqli_sql_exception class is not available to PHP 5.05<br><br>I used this code to catch errors <br><span class="default">&lt;?php<br>$query </span><span class="keyword">= </span><span class="string">&quot;SELECT XXname FROM customer_table &quot;</span><span class="keyword">;<br></span><span class="default">$res </span><span class="keyword">= </span><span class="default">$mysqli</span><span class="keyword">-&gt;</span><span class="default">query</span><span class="keyword">(</span><span class="default">$query</span><span class="keyword">);<br><br>if (!</span><span class="default">$res</span><span class="keyword">) {<br>&#xA0;&#xA0; </span><span class="default">printf</span><span class="keyword">(</span><span class="string">&quot;Errormessage: %s\n&quot;</span><span class="keyword">, </span><span class="default">$mysqli</span><span class="keyword">-&gt;</span><span class="default">error</span><span class="keyword">);<br>}<br><br></span><span class="default">?&gt;<br></span>The problem with this is that valid values for $res are: a mysqli_result object , true or false<br>This doesn&apos;t tell us that there has been an error with the sql used.<br>If you pass an update statement, false is a valid result if the update fails.<br><br>So, a better way is:<br><span class="default">&lt;?php<br>$query </span><span class="keyword">= </span><span class="string">&quot;SELECT XXname FROM customer_table &quot;</span><span class="keyword">;<br></span><span class="default">$res </span><span class="keyword">= </span><span class="default">$mysqli</span><span class="keyword">-&gt;</span><span class="default">query</span><span class="keyword">(</span><span class="default">$query</span><span class="keyword">);<br><br>if (!</span><span class="default">$mysqli</span><span class="keyword">-&gt;</span><span class="default">error</span><span class="keyword">) {<br>&#xA0;&#xA0; </span><span class="default">printf</span><span class="keyword">(</span><span class="string">&quot;Errormessage: %s\n&quot;</span><span class="keyword">, </span><span class="default">$mysqli</span><span class="keyword">-&gt;</span><span class="default">error</span><span class="keyword">);<br>}<br><br></span><span class="default">?&gt;<br></span><br>This would output something like:<br>Unexpected PHP error [mysqli::query() [&lt;a href=&apos;function.query&apos;&gt;function.query&lt;/a&gt;]: (42S22/1054): Unknown column &apos;XXname&apos; in &apos;field list&apos;] severity [E_WARNING] in [G:\database.php] line [249]<br><br>Very frustrating as I wanted to also catch the sql error and print out the stack trace. <br><br>A better way is:<br><br><span class="default">&lt;?php<br>mysqli_report</span><span class="keyword">(</span><span class="default">MYSQLI_REPORT_OFF</span><span class="keyword">); </span><span class="comment">//Turn off irritating default messages<br><br></span><span class="default">$mysqli </span><span class="keyword">= new </span><span class="default">mysqli</span><span class="keyword">(</span><span class="string">&quot;localhost&quot;</span><span class="keyword">, </span><span class="string">&quot;my_user&quot;</span><span class="keyword">, </span><span class="string">&quot;my_password&quot;</span><span class="keyword">, </span><span class="string">&quot;world&quot;</span><span class="keyword">);<br><br></span><span class="default">$query </span><span class="keyword">= </span><span class="string">&quot;SELECT XXname FROM customer_table &quot;</span><span class="keyword">;<br></span><span class="default">$res </span><span class="keyword">= </span><span class="default">$mysqli</span><span class="keyword">-&gt;</span><span class="default">query</span><span class="keyword">(</span><span class="default">$query</span><span class="keyword">);<br><br>if (</span><span class="default">$mysqli</span><span class="keyword">-&gt;</span><span class="default">error</span><span class="keyword">) {<br>&#xA0; &#xA0; try {&#xA0; &#xA0; <br>&#xA0; &#xA0; &#xA0; &#xA0; throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">&quot;MySQL error </span><span class="default">$mysqli</span><span class="keyword">-&gt;</span><span class="default">error</span><span class="string"> &lt;br&gt; Query:&lt;br&gt; </span><span class="default">$query</span><span class="string">&quot;</span><span class="keyword">, </span><span class="default">$msqli</span><span class="keyword">-&gt;</span><span class="default">errno</span><span class="keyword">);&#xA0; &#xA0; <br>&#xA0; &#xA0; } catch(</span><span class="default">Exception $e </span><span class="keyword">) {<br>&#xA0; &#xA0; &#xA0; &#xA0; echo </span><span class="string">&quot;Error No: &quot;</span><span class="keyword">.</span><span class="default">$e</span><span class="keyword">-&gt;</span><span class="default">getCode</span><span class="keyword">(). </span><span class="string">&quot; - &quot;</span><span class="keyword">. </span><span class="default">$e</span><span class="keyword">-&gt;</span><span class="default">getMessage</span><span class="keyword">() . </span><span class="string">&quot;&lt;br &gt;&quot;</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; echo </span><span class="default">nl2br</span><span class="keyword">(</span><span class="default">$e</span><span class="keyword">-&gt;</span><span class="default">getTraceAsString</span><span class="keyword">());<br>&#xA0; &#xA0; }<br>}<br><br></span><span class="comment">//Do stuff with the result<br></span><span class="default">?&gt;<br></span>Prints out something like:<br>Error No: 1054<br>Unknown column &apos;XXname&apos; in &apos;field list&apos;<br>Query: <br>SELECT XXname FROM customer_table<br><br>#0 G:\\database.php(251): database-&gt;dbError(&apos;Unknown column ...&apos;, 1054, &apos;getQuery()&apos;, &apos;SELECT XXname F...&apos;)<br>#1 G:\data\WorkSites\1framework5\tests\dbtest.php(29): database-&gt;getString(&apos;SELECT XXname F...&apos;)<br>#2 c:\PHP\includes\simpletest\runner.php(58): testOfDB-&gt;testGetVal()<br>#3 c:\PHP\includes\simpletest\runner.php(96): SimpleInvoker-&gt;invoke(&apos;testGetVal&apos;)<br>#4 c:\PHP\includes\simpletest\runner.php(125): SimpleInvokerDecorator-&gt;invoke(&apos;testGetVal&apos;)<br>#5 c:\PHP\includes\simpletest\runner.php(183): SimpleErrorTrappingInvoker-&gt;invoke(&apos;testGetVal&apos;)<br>#6 c:\PHP\includes\simpletest\simple_test.php(90): SimpleRunner-&gt;run()<br>#7 c:\PHP\includes\simpletest\simple_test.php(498): SimpleTestCase-&gt;run(Object(HtmlReporter))<br>#8 c:\PHP\includes\simpletest\simple_test.php(500): GroupTest-&gt;run(Object(HtmlReporter))<br>#9 G:\all_tests.php(16): GroupTest-&gt;run(Object(HtmlReporter))<br><br>This will actually print out the error, a stack trace and the offending sql statement. Much more helpful when the sql statement is generated somewhere else in the code.</span>
</div>
  

#

[Official documentation page](https://www.php.net/manual/en/mysqli.error.php)

**[To root](/README.md)**