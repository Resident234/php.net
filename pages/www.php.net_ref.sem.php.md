# Semaphore Functions



Samlpe code for using most of the functions here:<br><br>    $MEMSIZE    =   512;//  size of shared memory to allocate<br>    $SEMKEY     =   1;  //  Semaphore key<br>    $SHMKEY     =   2;  //  Shared memory key<br><br>    echo "Start.\n";<br>    // Get semaphore<br>    $sem_id = sem_get($SEMKEY, 1);<br>    if ($sem_id === false)<br>    {<br>        echo "Fail to get semaphore";<br>        exit;<br>    }<br>    else<br>        echo "Got semaphore $sem_id.\n";<br><br>    // Accuire semaphore<br>    if (! sem_acquire($sem_id))<br>    {<br>        echo "Fail to aquire semaphore $sem_id.\n";<br>        sem_remove($sem_id);<br>        exit;<br>    }<br>    else<br>        echo "Success aquire semaphore $sem_id.\n";<br><br>    $shm_id =   shm_attach($SHMKEY, $MEMSIZE);<br>    if ($shm_id === false)<br>    {<br>        echo "Fail to attach shared memory.\n";<br>        sem_remove($sem_id);<br>        exit;<br>    }<br>    else<br>        echo "Success to attach shared memory : $shm_id.\n";<br><br>    // Write variable 1<br>    if (!shm_put_var($shm_id, 1, "Variable 1"))<br>    {<br>        echo "Fail to put var 1 on shared memory $shm_id.\n";<br>        sem_remove($sem_id);<br>        shm_remove ($shm_id);<br>        exit;<br>    }<br>    else<br>        echo "Write var1 to shared memory.\n";<br><br>    // Write variable 2<br>    if (!shm_put_var($shm_id, 2, "Variable 2"))<br>    {<br>        echo "Fail to put var 2 on shared memory $shm_id.\n";<br>        sem_remove($sem_id);<br>        shm_remove ($shm_id);<br>        exit;<br>    }<br>    else<br>        echo "Write var2 to shared memory.\n";<br><br>    // Read variable 1<br>    $var1   =   shm_get_var ($shm_id, 1);<br>    if ($var1 === false)<br>    {<br>        echo "Fail to retrive Var 1 from Shared memory $shm_id, return value=$var1.\n";<br>    }<br>    else<br>        echo "Read var1=$var1.\n";<br><br>    // Read variable 1<br>    $var2   =   shm_get_var ($shm_id, 2);<br>    if ($var1 === false)<br>    {<br>        echo "Fail to retrive Var 2 from Shared memory $shm_id, return value=$var2.\n";<br>    }<br>    else<br>        echo "Read var2=$var2.\n";<br><br>    // Release semaphore<br>    if (!sem_release($sem_id))<br>        echo "Fail to release $sem_id semaphore.\n";<br>    else<br>        echo "Semaphore $sem_id released.\n";<br><br>    // remove shared memory segmant from SysV<br>    if (shm_remove ($shm_id))<br>        echo "Shared memory successfully removed from SysV.\n";<br>    else<br>        echo "Fail to remove $shm_id shared memory from SysV.\n";<br><br>    // Remove semaphore<br>    if (sem_remove($sem_id))<br>        echo "semaphore removed successfully from SysV.\n";<br>    else<br>        echo "Fail to remove $sem_id semaphore from SysV.\n";<br>    echo "End.\n";  

#

[Official documentation page](https://www.php.net/manual/en/ref.sem.php)

**[To root](/README.md)**