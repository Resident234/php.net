# Memcached




<div class="phpcode"><span class="html">
For those confuse about the memcached extension and the memcache extension, the short story is that both of them are clients of memcached server, and the memcached extension offer more features than the memcache extension.</span>
</div>
  

#


<div class="phpcode"><span class="html">
GOTCHA: Recently I was tasked with moving from PECL memcache to PECL memcached and ran into a major problem -- memcache and memcached serialize data differently, meaning that data written with one library can&apos;t necessarily be read with the other library.<br><br>For example, If you write an object or an array with memcache, it&apos;s interpreted as an integer by memcached.&#xA0; If you write it with memcached, it&apos;s interpreted as a string by memcache.<br><br>tl;dr - You can&apos;t safely switch between memcache and memcached without a either a cache flush or isolated cache environments.<br><br><span class="default">&lt;?php<br>$memcache </span><span class="keyword">= new </span><span class="default">Memcache</span><span class="keyword">;<br></span><span class="default">$memcacheD </span><span class="keyword">= new </span><span class="default">Memcached</span><span class="keyword">;<br></span><span class="default">$memcache</span><span class="keyword">-&gt;</span><span class="default">addServer</span><span class="keyword">(</span><span class="default">$host</span><span class="keyword">);<br></span><span class="default">$memcacheD</span><span class="keyword">-&gt;</span><span class="default">addServers</span><span class="keyword">(</span><span class="default">$servers</span><span class="keyword">);<br><br></span><span class="default">$checks </span><span class="keyword">= array(<br>&#xA0; &#xA0; </span><span class="default">123</span><span class="keyword">,<br>&#xA0; &#xA0; </span><span class="default">4542.32</span><span class="keyword">,<br>&#xA0; &#xA0; </span><span class="string">&apos;a string&apos;</span><span class="keyword">,<br>&#xA0; &#xA0; </span><span class="default">true</span><span class="keyword">,<br>&#xA0; &#xA0; array(</span><span class="default">123</span><span class="keyword">, </span><span class="string">&apos;string&apos;</span><span class="keyword">),<br>&#xA0; &#xA0; (object)array(</span><span class="string">&apos;key1&apos; </span><span class="keyword">=&gt; </span><span class="string">&apos;value1&apos;</span><span class="keyword">),<br>);<br>foreach (</span><span class="default">$checks </span><span class="keyword">as </span><span class="default">$i </span><span class="keyword">=&gt; </span><span class="default">$value</span><span class="keyword">) {<br>&#xA0; &#xA0; print </span><span class="string">&quot;Checking WRITE with Memcache\n&quot;</span><span class="keyword">;<br>&#xA0; &#xA0; </span><span class="default">$key </span><span class="keyword">= </span><span class="string">&apos;cachetest&apos; </span><span class="keyword">. </span><span class="default">$i</span><span class="keyword">;<br>&#xA0; &#xA0; </span><span class="default">$memcache</span><span class="keyword">-&gt;</span><span class="default">set</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">);<br>&#xA0; &#xA0; </span><span class="default">usleep</span><span class="keyword">(</span><span class="default">100</span><span class="keyword">);<br>&#xA0; &#xA0; </span><span class="default">$val </span><span class="keyword">= </span><span class="default">$memcache</span><span class="keyword">-&gt;</span><span class="default">get</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">);<br>&#xA0; &#xA0; </span><span class="default">$valD </span><span class="keyword">= </span><span class="default">$memcacheD</span><span class="keyword">-&gt;</span><span class="default">get</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">);<br>&#xA0; &#xA0; if (</span><span class="default">$val </span><span class="keyword">!== </span><span class="default">$valD</span><span class="keyword">) {<br>&#xA0; &#xA0; &#xA0; &#xA0; print </span><span class="string">&quot;Not compatible!&quot;</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">compact</span><span class="keyword">(</span><span class="string">&apos;val&apos;</span><span class="keyword">, </span><span class="string">&apos;valD&apos;</span><span class="keyword">));<br>&#xA0; &#xA0; }<br><br>&#xA0; &#xA0; print </span><span class="string">&quot;Checking WRITE with MemcacheD\n&quot;</span><span class="keyword">;<br>&#xA0; &#xA0; </span><span class="default">$key </span><span class="keyword">= </span><span class="string">&apos;cachetest&apos; </span><span class="keyword">. </span><span class="default">$i</span><span class="keyword">;<br>&#xA0; &#xA0; </span><span class="default">$memcacheD</span><span class="keyword">-&gt;</span><span class="default">set</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">);<br>&#xA0; &#xA0; </span><span class="default">usleep</span><span class="keyword">(</span><span class="default">100</span><span class="keyword">);<br>&#xA0; &#xA0; </span><span class="default">$val </span><span class="keyword">= </span><span class="default">$memcache</span><span class="keyword">-&gt;</span><span class="default">get</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">);<br>&#xA0; &#xA0; </span><span class="default">$valD </span><span class="keyword">= </span><span class="default">$memcacheD</span><span class="keyword">-&gt;</span><span class="default">get</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">);<br>&#xA0; &#xA0; if (</span><span class="default">$val </span><span class="keyword">!== </span><span class="default">$valD</span><span class="keyword">) {<br>&#xA0; &#xA0; &#xA0; &#xA0; print </span><span class="string">&quot;Not compatible!&quot;</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">compact</span><span class="keyword">(</span><span class="string">&apos;val&apos;</span><span class="keyword">, </span><span class="string">&apos;valD&apos;</span><span class="keyword">));<br>&#xA0; &#xA0; }<br>}</span>
</span>
</div>
  

#

[Official documentation page](https://www.php.net/manual/en/book.memcached.php)

**[To root](/README.md)**