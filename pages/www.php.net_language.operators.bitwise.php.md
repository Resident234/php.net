# Bitwise Operators




<div class="phpcode"><span class="html">
BITWISE FLAGS for Custom PHP Objects<br><br>Sometimes I need a custom PHP Object that holds several boolean TRUE or FALSE values. I could easily include a variable for each of them, but as always, code has a way to get unweildy pretty fast. A more intelligent approach always seems to be the answer, even if it seems to be overkill at first.<br><br>I start with an abstract base class which will hold a single integer variable called $flags. This simple integer can hold 32 TRUE or FALSE boolean values. Another thing to consider is to just set certain BIT values without disturbing any of the other BITS -- so included in the class definition is the setFlag($flag, $value) function, which will set only the chosen bit. Here&apos;s the abstract base class definition: <br><br><span class="default">&lt;?php<br><br></span><span class="comment"># BitwiseFlag.php<br><br></span><span class="keyword">abstract class </span><span class="default">BitwiseFlag<br></span><span class="keyword">{<br>&#xA0; protected </span><span class="default">$flags</span><span class="keyword">;<br><br>&#xA0; </span><span class="comment">/*<br>&#xA0;&#xA0; * Note: these functions are protected to prevent outside code<br>&#xA0;&#xA0; * from falsely setting BITS. See how the extending class &apos;User&apos;<br>&#xA0;&#xA0; * handles this.<br>&#xA0;&#xA0; *<br>&#xA0;&#xA0; */<br>&#xA0; </span><span class="keyword">protected function </span><span class="default">isFlagSet</span><span class="keyword">(</span><span class="default">$flag</span><span class="keyword">)<br>&#xA0; {<br>&#xA0; &#xA0; return ((</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">flags </span><span class="keyword">&amp; </span><span class="default">$flag</span><span class="keyword">) == </span><span class="default">$flag</span><span class="keyword">);<br>&#xA0; }<br><br>&#xA0; protected function </span><span class="default">setFlag</span><span class="keyword">(</span><span class="default">$flag</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">)<br>&#xA0; {<br>&#xA0; &#xA0; if(</span><span class="default">$value</span><span class="keyword">)<br>&#xA0; &#xA0; {<br>&#xA0; &#xA0; &#xA0; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">flags </span><span class="keyword">|= </span><span class="default">$flag</span><span class="keyword">;<br>&#xA0; &#xA0; }<br>&#xA0; &#xA0; else<br>&#xA0; &#xA0; {<br>&#xA0; &#xA0; &#xA0; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">flags </span><span class="keyword">&amp;= ~</span><span class="default">$flag</span><span class="keyword">;<br>&#xA0; &#xA0; }<br>&#xA0; }<br>}<br><br></span><span class="default">?&gt;<br></span><br>The class above is abstract and cannot be instantiated, so an extension is required. Below is a simple extension called User -- which is severely truncated for clarity. Notice I am defining const variables AND methods to use them.<br><br><span class="default">&lt;?php<br><br></span><span class="comment"># User.php<br><br></span><span class="keyword">require(</span><span class="string">&apos;BitwiseFlag.php&apos;</span><span class="keyword">);<br><br>class </span><span class="default">User </span><span class="keyword">extends </span><span class="default">BitwiseFlag<br></span><span class="keyword">{<br>&#xA0; const </span><span class="default">FLAG_REGISTERED </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">; </span><span class="comment">// BIT #1 of $flags has the value 1<br>&#xA0; </span><span class="keyword">const </span><span class="default">FLAG_ACTIVE </span><span class="keyword">= </span><span class="default">2</span><span class="keyword">;&#xA0; &#xA0;&#xA0; </span><span class="comment">// BIT #2 of $flags has the value 2<br>&#xA0; </span><span class="keyword">const </span><span class="default">FLAG_MEMBER </span><span class="keyword">= </span><span class="default">4</span><span class="keyword">;&#xA0; &#xA0;&#xA0; </span><span class="comment">// BIT #3 of $flags has the value 4<br>&#xA0; </span><span class="keyword">const </span><span class="default">FLAG_ADMIN </span><span class="keyword">= </span><span class="default">8</span><span class="keyword">;&#xA0; &#xA0; &#xA0; </span><span class="comment">// BIT #4 of $flags has the value 8<br><br>&#xA0; </span><span class="keyword">public function </span><span class="default">isRegistered</span><span class="keyword">(){<br>&#xA0; &#xA0; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">isFlagSet</span><span class="keyword">(</span><span class="default">self</span><span class="keyword">::</span><span class="default">FLAG_REGISTERED</span><span class="keyword">);<br>&#xA0; }<br><br>&#xA0; public function </span><span class="default">isActive</span><span class="keyword">(){<br>&#xA0; &#xA0; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">isFlagSet</span><span class="keyword">(</span><span class="default">self</span><span class="keyword">::</span><span class="default">FLAG_ACTIVE</span><span class="keyword">);<br>&#xA0; }<br><br>&#xA0; public function </span><span class="default">isMember</span><span class="keyword">(){<br>&#xA0; &#xA0; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">isFlagSet</span><span class="keyword">(</span><span class="default">self</span><span class="keyword">::</span><span class="default">FLAG_MEMBER</span><span class="keyword">);<br>&#xA0; }<br><br>&#xA0; public function </span><span class="default">isAdmin</span><span class="keyword">(){<br>&#xA0; &#xA0; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">isFlagSet</span><span class="keyword">(</span><span class="default">self</span><span class="keyword">::</span><span class="default">FLAG_ADMIN</span><span class="keyword">);<br>&#xA0; }<br><br>&#xA0; public function </span><span class="default">setRegistered</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">){<br>&#xA0; &#xA0; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">setFlag</span><span class="keyword">(</span><span class="default">self</span><span class="keyword">::</span><span class="default">FLAG_REGISTERED</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">);<br>&#xA0; }<br><br>&#xA0; public function </span><span class="default">setActive</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">){<br>&#xA0; &#xA0; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">setFlag</span><span class="keyword">(</span><span class="default">self</span><span class="keyword">::</span><span class="default">FLAG_ACTIVE</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">);<br>&#xA0; }<br><br>&#xA0; public function </span><span class="default">setMember</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">){<br>&#xA0; &#xA0; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">setFlag</span><span class="keyword">(</span><span class="default">self</span><span class="keyword">::</span><span class="default">FLAG_MEMBER</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">);<br>&#xA0; }<br><br>&#xA0; public function </span><span class="default">setAdmin</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">){<br>&#xA0; &#xA0; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">setFlag</span><span class="keyword">(</span><span class="default">self</span><span class="keyword">::</span><span class="default">FLAG_ADMIN</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">);<br>&#xA0; }<br><br>&#xA0; public function </span><span class="default">__toString</span><span class="keyword">(){<br>&#xA0; &#xA0; return </span><span class="string">&apos;User [&apos; </span><span class="keyword">.<br>&#xA0; &#xA0; &#xA0; (</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">isRegistered</span><span class="keyword">() ? </span><span class="string">&apos;REGISTERED&apos; </span><span class="keyword">: </span><span class="string">&apos;&apos;</span><span class="keyword">) .<br>&#xA0; &#xA0; &#xA0; (</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">isActive</span><span class="keyword">() ? </span><span class="string">&apos; ACTIVE&apos; </span><span class="keyword">: </span><span class="string">&apos;&apos;</span><span class="keyword">) .<br>&#xA0; &#xA0; &#xA0; (</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">isMember</span><span class="keyword">() ? </span><span class="string">&apos; MEMBER&apos; </span><span class="keyword">: </span><span class="string">&apos;&apos;</span><span class="keyword">) .<br>&#xA0; &#xA0; &#xA0; (</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">isAdmin</span><span class="keyword">() ? </span><span class="string">&apos; ADMIN&apos; </span><span class="keyword">: </span><span class="string">&apos;&apos;</span><span class="keyword">) .<br>&#xA0; &#xA0; </span><span class="string">&apos;]&apos;</span><span class="keyword">;<br>&#xA0; }<br>}<br><br></span><span class="default">?&gt;<br></span><br>This seems like a lot of work, but we have addressed many issues, for example, using and maintaining the code is easy, and the getting and setting of flag values make sense. With the User class, you can now see how easy and intuitive bitwise flag operations become.<br><br><span class="default">&lt;?php<br><br></span><span class="keyword">require(</span><span class="string">&apos;User.php&apos;</span><span class="keyword">)<br><br></span><span class="default">$user </span><span class="keyword">= new </span><span class="default">User</span><span class="keyword">();<br></span><span class="default">$user</span><span class="keyword">-&gt;</span><span class="default">setRegistered</span><span class="keyword">(</span><span class="default">true</span><span class="keyword">);<br></span><span class="default">$user</span><span class="keyword">-&gt;</span><span class="default">setActive</span><span class="keyword">(</span><span class="default">true</span><span class="keyword">);<br></span><span class="default">$user</span><span class="keyword">-&gt;</span><span class="default">setMember</span><span class="keyword">(</span><span class="default">true</span><span class="keyword">);<br></span><span class="default">$user</span><span class="keyword">-&gt;</span><span class="default">setAdmin</span><span class="keyword">(</span><span class="default">true</span><span class="keyword">);<br><br>echo </span><span class="default">$user</span><span class="keyword">;&#xA0; </span><span class="comment">// outputs: User [REGISTERED ACTIVE MEMBER ADMIN]<br><br></span><span class="default">?&gt;</span>
</span>
</div>
  

#


<div class="phpcode"><span class="html">
Initially, I found bitmasking to be a confusing concept and found no use for it. So I&apos;ve whipped up this code snippet in case anyone else is confused:<br><br><span class="default">&lt;?php<br><br>&#xA0; &#xA0; </span><span class="comment">// The various details a vehicle can have<br>&#xA0; &#xA0; </span><span class="default">$hasFourWheels </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;<br>&#xA0; &#xA0; </span><span class="default">$hasTwoWheels&#xA0; </span><span class="keyword">= </span><span class="default">2</span><span class="keyword">;<br>&#xA0; &#xA0; </span><span class="default">$hasDoors&#xA0; &#xA0; &#xA0; </span><span class="keyword">= </span><span class="default">4</span><span class="keyword">;<br>&#xA0; &#xA0; </span><span class="default">$hasRedColour&#xA0; </span><span class="keyword">= </span><span class="default">8</span><span class="keyword">;<br><br>&#xA0; &#xA0; </span><span class="default">$bike&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="keyword">= </span><span class="default">$hasTwoWheels</span><span class="keyword">;<br>&#xA0; &#xA0; </span><span class="default">$golfBuggy&#xA0; &#xA0;&#xA0; </span><span class="keyword">= </span><span class="default">$hasFourWheels</span><span class="keyword">;<br>&#xA0; &#xA0; </span><span class="default">$ford&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="keyword">= </span><span class="default">$hasFourWheels </span><span class="keyword">| </span><span class="default">$hasDoors</span><span class="keyword">;<br>&#xA0; &#xA0; </span><span class="default">$ferrari&#xA0; &#xA0; &#xA0;&#xA0; </span><span class="keyword">= </span><span class="default">$hasFourWheels </span><span class="keyword">| </span><span class="default">$hasDoors </span><span class="keyword">| </span><span class="default">$hasRedColour</span><span class="keyword">;<br><br>&#xA0; &#xA0; </span><span class="default">$isBike&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="keyword">= </span><span class="default">$hasFourWheels </span><span class="keyword">&amp; </span><span class="default">$bike</span><span class="keyword">; </span><span class="comment"># False, because $bike doens&apos;t have four wheels<br>&#xA0; &#xA0; </span><span class="default">$isGolfBuggy&#xA0;&#xA0; </span><span class="keyword">= </span><span class="default">$hasFourWheels </span><span class="keyword">&amp; </span><span class="default">$golfBuggy</span><span class="keyword">; </span><span class="comment"># True, because $golfBuggy has four wheels<br>&#xA0; &#xA0; </span><span class="default">$isFord&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="keyword">= </span><span class="default">$hasFourWheels </span><span class="keyword">&amp; </span><span class="default">$ford</span><span class="keyword">; </span><span class="comment"># True, because $ford $hasFourWheels<br><br></span><span class="default">?&gt;<br></span><br>And you can apply this to a lot of things, for example, security:<br><br><span class="default">&lt;?php<br><br>&#xA0; &#xA0; </span><span class="comment">// Security permissions:<br>&#xA0; &#xA0; </span><span class="default">$writePost </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;<br>&#xA0; &#xA0; </span><span class="default">$readPost </span><span class="keyword">= </span><span class="default">2</span><span class="keyword">;<br>&#xA0; &#xA0; </span><span class="default">$deletePost </span><span class="keyword">= </span><span class="default">4</span><span class="keyword">;<br>&#xA0; &#xA0; </span><span class="default">$addUser </span><span class="keyword">= </span><span class="default">8</span><span class="keyword">;<br>&#xA0; &#xA0; </span><span class="default">$deleteUser </span><span class="keyword">= </span><span class="default">16</span><span class="keyword">;<br>&#xA0; &#xA0; <br>&#xA0; &#xA0; </span><span class="comment">// User groups:<br>&#xA0; &#xA0; </span><span class="default">$administrator </span><span class="keyword">= </span><span class="default">$writePost </span><span class="keyword">| </span><span class="default">$readPosts </span><span class="keyword">| </span><span class="default">$deletePosts </span><span class="keyword">| </span><span class="default">$addUser </span><span class="keyword">| </span><span class="default">$deleteUser</span><span class="keyword">;<br>&#xA0; &#xA0; </span><span class="default">$moderator </span><span class="keyword">= </span><span class="default">$readPost </span><span class="keyword">| </span><span class="default">$deletePost </span><span class="keyword">| </span><span class="default">$deleteUser</span><span class="keyword">;<br>&#xA0; &#xA0; </span><span class="default">$writer </span><span class="keyword">= </span><span class="default">$writePost </span><span class="keyword">| </span><span class="default">$readPost</span><span class="keyword">;<br>&#xA0; &#xA0; </span><span class="default">$guest </span><span class="keyword">= </span><span class="default">$readPost</span><span class="keyword">;<br><br>&#xA0; &#xA0; </span><span class="comment">// function to check for permission<br>&#xA0; &#xA0; </span><span class="keyword">function </span><span class="default">checkPermission</span><span class="keyword">(</span><span class="default">$user</span><span class="keyword">, </span><span class="default">$permission</span><span class="keyword">) {<br>&#xA0; &#xA0; &#xA0; &#xA0; if(</span><span class="default">$user </span><span class="keyword">&amp; </span><span class="default">$permission</span><span class="keyword">) {<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; return </span><span class="default">true</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; } else {<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; return </span><span class="default">false</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; }<br>&#xA0; &#xA0; }<br><br>&#xA0; &#xA0; </span><span class="comment">// Now we apply all of this!<br>&#xA0; &#xA0; </span><span class="keyword">if(</span><span class="default">checkPermission</span><span class="keyword">(</span><span class="default">$administrator</span><span class="keyword">, </span><span class="default">$deleteUser</span><span class="keyword">)) {<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">deleteUser</span><span class="keyword">(</span><span class="string">&quot;Some User&quot;</span><span class="keyword">); </span><span class="comment"># This is executed because $administrator can $deleteUser<br>&#xA0; &#xA0; </span><span class="keyword">}<br><br></span><span class="default">?&gt;<br></span><br>Once you get your head around it, it&apos;s VERY useful! Just remember to raise each value by the power of two to avoid problems</span>
</div>
  

#


<div class="phpcode"><span class="html">
A bitwise operators practical case :<br><br><span class="default">&lt;?php<br>&#xA0; &#xA0; </span><span class="comment">// We want to know the red, green and blue values of this color :<br>&#xA0; &#xA0; </span><span class="default">$color </span><span class="keyword">= </span><span class="default">0xFEA946 </span><span class="keyword">;<br><br>&#xA0; &#xA0; </span><span class="default">$red </span><span class="keyword">= </span><span class="default">$color </span><span class="keyword">&gt;&gt; </span><span class="default">16 </span><span class="keyword">;<br>&#xA0; &#xA0; </span><span class="default">$green </span><span class="keyword">= (</span><span class="default">$color </span><span class="keyword">&amp; </span><span class="default">0x00FF00</span><span class="keyword">) &gt;&gt; </span><span class="default">8 </span><span class="keyword">;<br>&#xA0; &#xA0; </span><span class="default">$blue </span><span class="keyword">= </span><span class="default">$color </span><span class="keyword">&amp; </span><span class="default">0x0000FF </span><span class="keyword">;<br><br>&#xA0; &#xA0; </span><span class="default">printf</span><span class="keyword">(</span><span class="string">&apos;Red : %X (%d), Green : %X (%d), Blue : %X (%d)&apos;</span><span class="keyword">,<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$red</span><span class="keyword">, </span><span class="default">$red</span><span class="keyword">, </span><span class="default">$green</span><span class="keyword">, </span><span class="default">$green</span><span class="keyword">, </span><span class="default">$blue</span><span class="keyword">, </span><span class="default">$blue</span><span class="keyword">) ;<br><br>&#xA0; &#xA0; </span><span class="comment">// Will display...<br>&#xA0; &#xA0; // Red : FE (254), Green : A9 (169), Blue : 46 (70)<br></span><span class="default">?&gt;</span>
</span>
</div>
  

#

[Official documentation page](https://www.php.net/manual/en/language.operators.bitwise.php)

**[To root](/README.md)**