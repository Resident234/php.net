# apache_request_headers




<div class="phpcode"><span class="html">
I didn&apos;t found a replacement for apache_request_headers() in PHP::Compat (<a href="http://pear.php.net/package/PHP_Compat" rel="nofollow" target="_blank">http://pear.php.net/package/PHP_Compat</a>) so I wrote my own:<br><br><span class="default">&lt;?php<br></span><span class="keyword">if( !</span><span class="default">function_exists</span><span class="keyword">(</span><span class="string">&apos;apache_request_headers&apos;</span><span class="keyword">) ) {<br></span><span class="comment">///<br></span><span class="keyword">function </span><span class="default">apache_request_headers</span><span class="keyword">() {<br>&#xA0; </span><span class="default">$arh </span><span class="keyword">= array();<br>&#xA0; </span><span class="default">$rx_http </span><span class="keyword">= </span><span class="string">&apos;/\AHTTP_/&apos;</span><span class="keyword">;<br>&#xA0; foreach(</span><span class="default">$_SERVER </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$val</span><span class="keyword">) {<br>&#xA0; &#xA0; if( </span><span class="default">preg_match</span><span class="keyword">(</span><span class="default">$rx_http</span><span class="keyword">, </span><span class="default">$key</span><span class="keyword">) ) {<br>&#xA0; &#xA0; &#xA0; </span><span class="default">$arh_key </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="default">$rx_http</span><span class="keyword">, </span><span class="string">&apos;&apos;</span><span class="keyword">, </span><span class="default">$key</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; </span><span class="default">$rx_matches </span><span class="keyword">= array();<br>&#xA0; &#xA0; &#xA0; </span><span class="comment">// do some nasty string manipulations to restore the original letter case<br>&#xA0; &#xA0; &#xA0; // this should work in most cases<br>&#xA0; &#xA0; &#xA0; </span><span class="default">$rx_matches </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">&apos;_&apos;</span><span class="keyword">, </span><span class="default">$arh_key</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; if( </span><span class="default">count</span><span class="keyword">(</span><span class="default">$rx_matches</span><span class="keyword">) &gt; </span><span class="default">0 </span><span class="keyword">and </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$arh_key</span><span class="keyword">) &gt; </span><span class="default">2 </span><span class="keyword">) {<br>&#xA0; &#xA0; &#xA0; &#xA0; foreach(</span><span class="default">$rx_matches </span><span class="keyword">as </span><span class="default">$ak_key </span><span class="keyword">=&gt; </span><span class="default">$ak_val</span><span class="keyword">) </span><span class="default">$rx_matches</span><span class="keyword">[</span><span class="default">$ak_key</span><span class="keyword">] = </span><span class="default">ucfirst</span><span class="keyword">(</span><span class="default">$ak_val</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$arh_key </span><span class="keyword">= </span><span class="default">implode</span><span class="keyword">(</span><span class="string">&apos;-&apos;</span><span class="keyword">, </span><span class="default">$rx_matches</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; }<br>&#xA0; &#xA0; &#xA0; </span><span class="default">$arh</span><span class="keyword">[</span><span class="default">$arh_key</span><span class="keyword">] = </span><span class="default">$val</span><span class="keyword">;<br>&#xA0; &#xA0; }<br>&#xA0; }<br>&#xA0; return( </span><span class="default">$arh </span><span class="keyword">);<br>}<br></span><span class="comment">///<br></span><span class="keyword">}<br></span><span class="comment">///<br></span><span class="default">?&gt;</span>
</span>
</div>
  

#


<div class="phpcode"><span class="html">
There is a simple way to get request headers from Apache even on PHP running as a CGI. As far as I know, it&apos;s the only way to get the headers &quot;If-Modified-Since&quot; and &quot;If-None-Match&quot; when apache_request_headers() isn&apos;t available. You need mod_rewrite, which most web hosts seem to have enabled. Put this in an .htacess file in your web root:<br><br>RewriteEngine on<br>RewriteRule .* - [E=HTTP_IF_MODIFIED_SINCE:%{HTTP:If-Modified-Since}]<br>RewriteRule .* - [E=HTTP_IF_NONE_MATCH:%{HTTP:If-None-Match}]<br><br>The headers are then available in PHP as<br><span class="default">&lt;?php<br>&#xA0; $_SERVER</span><span class="keyword">[</span><span class="string">&apos;HTTP_IF_MODIFIED_SINCE&apos;</span><span class="keyword">];<br>&#xA0; </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">&apos;HTTP_IF_NONE_MATCH&apos;</span><span class="keyword">];<br></span><span class="default">?&gt;<br></span><br>I&apos;ve tested this on PHP/5.1.6, on both Apache/2.2.3/Win32 and Apache/2.0.54/Unix, and it works perfectly.<br><br>Note: if you use RewriteRules already for clean URLs, you need to put the above rules AFTER your existing ones.</span>
</div>
  

#

[Official documentation page](https://www.php.net/manual/en/function.apache-request-headers.php)

**[To root](/README.md)**