# memory_get_usage




<div class="phpcode"><span class="html">
To get the memory usage in KB or MB<br><br><span class="default">&lt;?php<br></span><span class="keyword">function </span><span class="default">convert</span><span class="keyword">(</span><span class="default">$size</span><span class="keyword">)<br> {<br>&#xA0; &#xA0; </span><span class="default">$unit</span><span class="keyword">=array(</span><span class="string">&apos;b&apos;</span><span class="keyword">,</span><span class="string">&apos;kb&apos;</span><span class="keyword">,</span><span class="string">&apos;mb&apos;</span><span class="keyword">,</span><span class="string">&apos;gb&apos;</span><span class="keyword">,</span><span class="string">&apos;tb&apos;</span><span class="keyword">,</span><span class="string">&apos;pb&apos;</span><span class="keyword">);<br>&#xA0; &#xA0; return @</span><span class="default">round</span><span class="keyword">(</span><span class="default">$size</span><span class="keyword">/</span><span class="default">pow</span><span class="keyword">(</span><span class="default">1024</span><span class="keyword">,(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">floor</span><span class="keyword">(</span><span class="default">log</span><span class="keyword">(</span><span class="default">$size</span><span class="keyword">,</span><span class="default">1024</span><span class="keyword">)))),</span><span class="default">2</span><span class="keyword">).</span><span class="string">&apos; &apos;</span><span class="keyword">.</span><span class="default">$unit</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">];<br> }<br><br>echo </span><span class="default">convert</span><span class="keyword">(</span><span class="default">memory_get_usage</span><span class="keyword">(</span><span class="default">true</span><span class="keyword">)); </span><span class="comment">// 123 kb<br></span><span class="default">?&gt;</span>
</span>
</div>
  

#


<div class="phpcode"><span class="html">
Note, that the official IEC-prefix for kilobyte, megabyte and so on are KiB, MiB, TiB and so on.<br><br>See <a href="http://en.wikipedia.org/wiki/Tebibyte" rel="nofollow" target="_blank">http://en.wikipedia.org/wiki/Tebibyte</a><br><br>At first glance this may sound like &quot;What the hell? Everybody knows, that we mean 1024 not 1000 and the difference is not too big, so what?&quot;. But in about 10 years, the size of harddisks (and files on them) reaches the petabyte-limit and then the difference between PB and PiB is magnificent.<br><br>Better to get used to it now. :)</span>
</div>
  

#


<div class="phpcode"><span class="html">
memory_get_usage() is used to retrieve the memory allocated to PHP only (or your running script). But intuitively, many people expect to get the memory usage of the system, based on the name of the function.<br><br>So if you need the overall memory usage, following function might be helpful. If retrieves the memory usage either in percent (without the percent sign) or in bytes by returning an array with free and overall memory of your system. Tested with Windows (7) and Linux (on an Raspberry Pi 2):<br><br><span class="default">&lt;?php<br><br>&#xA0; &#xA0; </span><span class="comment">// Returns used memory (either in percent (without percent sign) or free and overall in bytes)<br>&#xA0; &#xA0; </span><span class="keyword">function </span><span class="default">getServerMemoryUsage</span><span class="keyword">(</span><span class="default">$getPercentage</span><span class="keyword">=</span><span class="default">true</span><span class="keyword">)<br>&#xA0; &#xA0; {<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$memoryTotal </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$memoryFree </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br><br>&#xA0; &#xA0; &#xA0; &#xA0; if (</span><span class="default">stristr</span><span class="keyword">(</span><span class="default">PHP_OS</span><span class="keyword">, </span><span class="string">&quot;win&quot;</span><span class="keyword">)) {<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="comment">// Get total physical memory (this is in bytes)<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$cmd </span><span class="keyword">= </span><span class="string">&quot;wmic ComputerSystem get TotalPhysicalMemory&quot;</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; @</span><span class="default">exec</span><span class="keyword">(</span><span class="default">$cmd</span><span class="keyword">, </span><span class="default">$outputTotalPhysicalMemory</span><span class="keyword">);<br><br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="comment">// Get free physical memory (this is in kibibytes!)<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$cmd </span><span class="keyword">= </span><span class="string">&quot;wmic OS get FreePhysicalMemory&quot;</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; @</span><span class="default">exec</span><span class="keyword">(</span><span class="default">$cmd</span><span class="keyword">, </span><span class="default">$outputFreePhysicalMemory</span><span class="keyword">);<br><br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; if (</span><span class="default">$outputTotalPhysicalMemory </span><span class="keyword">&amp;&amp; </span><span class="default">$outputFreePhysicalMemory</span><span class="keyword">) {<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="comment">// Find total value<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="keyword">foreach (</span><span class="default">$outputTotalPhysicalMemory </span><span class="keyword">as </span><span class="default">$line</span><span class="keyword">) {<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; if (</span><span class="default">$line </span><span class="keyword">&amp;&amp; </span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">&quot;/^[0-9]+\$/&quot;</span><span class="keyword">, </span><span class="default">$line</span><span class="keyword">)) {<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$memoryTotal </span><span class="keyword">= </span><span class="default">$line</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; break;<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; }<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; }<br><br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="comment">// Find free value<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="keyword">foreach (</span><span class="default">$outputFreePhysicalMemory </span><span class="keyword">as </span><span class="default">$line</span><span class="keyword">) {<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; if (</span><span class="default">$line </span><span class="keyword">&amp;&amp; </span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">&quot;/^[0-9]+\$/&quot;</span><span class="keyword">, </span><span class="default">$line</span><span class="keyword">)) {<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$memoryFree </span><span class="keyword">= </span><span class="default">$line</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$memoryFree </span><span class="keyword">*= </span><span class="default">1024</span><span class="keyword">;&#xA0; </span><span class="comment">// convert from kibibytes to bytes<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="keyword">break;<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; }<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; }<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; }<br>&#xA0; &#xA0; &#xA0; &#xA0; }<br>&#xA0; &#xA0; &#xA0; &#xA0; else<br>&#xA0; &#xA0; &#xA0; &#xA0; {<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; if (</span><span class="default">is_readable</span><span class="keyword">(</span><span class="string">&quot;/proc/meminfo&quot;</span><span class="keyword">))<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; {<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$stats </span><span class="keyword">= @</span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="string">&quot;/proc/meminfo&quot;</span><span class="keyword">);<br><br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; if (</span><span class="default">$stats </span><span class="keyword">!== </span><span class="default">false</span><span class="keyword">) {<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="comment">// Separate lines<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$stats </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(array(</span><span class="string">&quot;\r\n&quot;</span><span class="keyword">, </span><span class="string">&quot;\n\r&quot;</span><span class="keyword">, </span><span class="string">&quot;\r&quot;</span><span class="keyword">), </span><span class="string">&quot;\n&quot;</span><span class="keyword">, </span><span class="default">$stats</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$stats </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">&quot;\n&quot;</span><span class="keyword">, </span><span class="default">$stats</span><span class="keyword">);<br><br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="comment">// Separate values and find correct lines for total and free mem<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="keyword">foreach (</span><span class="default">$stats </span><span class="keyword">as </span><span class="default">$statLine</span><span class="keyword">) {<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$statLineData </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">&quot;:&quot;</span><span class="keyword">, </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$statLine</span><span class="keyword">));<br><br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="comment">//<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; // Extract size (TODO: It seems that (at least) the two values for total and free memory have the unit &quot;kB&quot; always. Is this correct?<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; //<br><br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; // Total memory<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="keyword">if (</span><span class="default">count</span><span class="keyword">(</span><span class="default">$statLineData</span><span class="keyword">) == </span><span class="default">2 </span><span class="keyword">&amp;&amp; </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$statLineData</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]) == </span><span class="string">&quot;MemTotal&quot;</span><span class="keyword">) {<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$memoryTotal </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$statLineData</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]);<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$memoryTotal </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">&quot; &quot;</span><span class="keyword">, </span><span class="default">$memoryTotal</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$memoryTotal </span><span class="keyword">= </span><span class="default">$memoryTotal</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">];<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$memoryTotal </span><span class="keyword">*= </span><span class="default">1024</span><span class="keyword">;&#xA0; </span><span class="comment">// convert from kibibytes to bytes<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="keyword">}<br><br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="comment">// Free memory<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="keyword">if (</span><span class="default">count</span><span class="keyword">(</span><span class="default">$statLineData</span><span class="keyword">) == </span><span class="default">2 </span><span class="keyword">&amp;&amp; </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$statLineData</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]) == </span><span class="string">&quot;MemFree&quot;</span><span class="keyword">) {<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$memoryFree </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$statLineData</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]);<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$memoryFree </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">&quot; &quot;</span><span class="keyword">, </span><span class="default">$memoryFree</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$memoryFree </span><span class="keyword">= </span><span class="default">$memoryFree</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">];<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$memoryFree </span><span class="keyword">*= </span><span class="default">1024</span><span class="keyword">;&#xA0; </span><span class="comment">// convert from kibibytes to bytes<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="keyword">}<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; }<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; }<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; }<br>&#xA0; &#xA0; &#xA0; &#xA0; }<br><br>&#xA0; &#xA0; &#xA0; &#xA0; if (</span><span class="default">is_null</span><span class="keyword">(</span><span class="default">$memoryTotal</span><span class="keyword">) || </span><span class="default">is_null</span><span class="keyword">(</span><span class="default">$memoryFree</span><span class="keyword">)) {<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; return </span><span class="default">null</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; } else {<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; if (</span><span class="default">$getPercentage</span><span class="keyword">) {<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; return (</span><span class="default">100 </span><span class="keyword">- (</span><span class="default">$memoryFree </span><span class="keyword">* </span><span class="default">100 </span><span class="keyword">/ </span><span class="default">$memoryTotal</span><span class="keyword">));<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; } else {<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; return array(<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="string">&quot;total&quot; </span><span class="keyword">=&gt; </span><span class="default">$memoryTotal</span><span class="keyword">,<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="string">&quot;free&quot; </span><span class="keyword">=&gt; </span><span class="default">$memoryFree</span><span class="keyword">,<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; );<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; }<br>&#xA0; &#xA0; &#xA0; &#xA0; }<br>&#xA0; &#xA0; }<br><br>&#xA0; &#xA0; function </span><span class="default">getNiceFileSize</span><span class="keyword">(</span><span class="default">$bytes</span><span class="keyword">, </span><span class="default">$binaryPrefix</span><span class="keyword">=</span><span class="default">true</span><span class="keyword">) {<br>&#xA0; &#xA0; &#xA0; &#xA0; if (</span><span class="default">$binaryPrefix</span><span class="keyword">) {<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$unit</span><span class="keyword">=array(</span><span class="string">&apos;B&apos;</span><span class="keyword">,</span><span class="string">&apos;KiB&apos;</span><span class="keyword">,</span><span class="string">&apos;MiB&apos;</span><span class="keyword">,</span><span class="string">&apos;GiB&apos;</span><span class="keyword">,</span><span class="string">&apos;TiB&apos;</span><span class="keyword">,</span><span class="string">&apos;PiB&apos;</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; if (</span><span class="default">$bytes</span><span class="keyword">==</span><span class="default">0</span><span class="keyword">) return </span><span class="string">&apos;0 &apos; </span><span class="keyword">. </span><span class="default">$unit</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">];<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; return @</span><span class="default">round</span><span class="keyword">(</span><span class="default">$bytes</span><span class="keyword">/</span><span class="default">pow</span><span class="keyword">(</span><span class="default">1024</span><span class="keyword">,(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">floor</span><span class="keyword">(</span><span class="default">log</span><span class="keyword">(</span><span class="default">$bytes</span><span class="keyword">,</span><span class="default">1024</span><span class="keyword">)))),</span><span class="default">2</span><span class="keyword">) .</span><span class="string">&apos; &apos;</span><span class="keyword">. (isset(</span><span class="default">$unit</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]) ? </span><span class="default">$unit</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] : </span><span class="string">&apos;B&apos;</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; } else {<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$unit</span><span class="keyword">=array(</span><span class="string">&apos;B&apos;</span><span class="keyword">,</span><span class="string">&apos;KB&apos;</span><span class="keyword">,</span><span class="string">&apos;MB&apos;</span><span class="keyword">,</span><span class="string">&apos;GB&apos;</span><span class="keyword">,</span><span class="string">&apos;TB&apos;</span><span class="keyword">,</span><span class="string">&apos;PB&apos;</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; if (</span><span class="default">$bytes</span><span class="keyword">==</span><span class="default">0</span><span class="keyword">) return </span><span class="string">&apos;0 &apos; </span><span class="keyword">. </span><span class="default">$unit</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">];<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; return @</span><span class="default">round</span><span class="keyword">(</span><span class="default">$bytes</span><span class="keyword">/</span><span class="default">pow</span><span class="keyword">(</span><span class="default">1000</span><span class="keyword">,(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">floor</span><span class="keyword">(</span><span class="default">log</span><span class="keyword">(</span><span class="default">$bytes</span><span class="keyword">,</span><span class="default">1000</span><span class="keyword">)))),</span><span class="default">2</span><span class="keyword">) .</span><span class="string">&apos; &apos;</span><span class="keyword">. (isset(</span><span class="default">$unit</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]) ? </span><span class="default">$unit</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] : </span><span class="string">&apos;B&apos;</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; }<br>&#xA0; &#xA0; }<br><br>&#xA0; &#xA0; </span><span class="comment">// Memory usage: 4.55 GiB / 23.91 GiB (19.013557664178%)<br>&#xA0; &#xA0; </span><span class="default">$memUsage </span><span class="keyword">= </span><span class="default">getServerMemoryUsage</span><span class="keyword">(</span><span class="default">false</span><span class="keyword">);<br>&#xA0; &#xA0; echo </span><span class="default">sprintf</span><span class="keyword">(</span><span class="string">&quot;Memory usage: %s / %s (%s%%)&quot;</span><span class="keyword">,<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">getNiceFileSize</span><span class="keyword">(</span><span class="default">$memUsage</span><span class="keyword">[</span><span class="string">&quot;total&quot;</span><span class="keyword">] - </span><span class="default">$memUsage</span><span class="keyword">[</span><span class="string">&quot;free&quot;</span><span class="keyword">]),<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">getNiceFileSize</span><span class="keyword">(</span><span class="default">$memUsage</span><span class="keyword">[</span><span class="string">&quot;total&quot;</span><span class="keyword">]),<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">getServerMemoryUsage</span><span class="keyword">(</span><span class="default">true</span><span class="keyword">)<br>&#xA0; &#xA0; );<br><br></span><span class="default">?&gt;<br></span><br>The function getNiceFileSize() is not required. Just used to shorten size in bytes.<br><br>Note: If you need the server load (CPU usage), I wrote a nice function to get that too: <a href="http://php.net/manual/en/function.sys-getloadavg.php#118673" rel="nofollow" target="_blank">http://php.net/manual/en/function.sys-getloadavg.php#118673</a></span>
</div>
  

#


<div class="phpcode"><span class="html">
To get the memory usage in KB or MB
<br>
<br><span class="default">&lt;?php
<br>&#xA0; &#xA0; </span><span class="keyword">function </span><span class="default">echo_memory_usage</span><span class="keyword">() {
<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$mem_usage </span><span class="keyword">= </span><span class="default">memory_get_usage</span><span class="keyword">(</span><span class="default">true</span><span class="keyword">);
<br>&#xA0; &#xA0; &#xA0; &#xA0; 
<br>&#xA0; &#xA0; &#xA0; &#xA0; if (</span><span class="default">$mem_usage </span><span class="keyword">&lt; </span><span class="default">1024</span><span class="keyword">)
<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; echo </span><span class="default">$mem_usage</span><span class="keyword">.</span><span class="string">&quot; bytes&quot;</span><span class="keyword">;
<br>&#xA0; &#xA0; &#xA0; &#xA0; elseif (</span><span class="default">$mem_usage </span><span class="keyword">&lt; </span><span class="default">1048576</span><span class="keyword">)
<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; echo </span><span class="default">round</span><span class="keyword">(</span><span class="default">$mem_usage</span><span class="keyword">/</span><span class="default">1024</span><span class="keyword">,</span><span class="default">2</span><span class="keyword">).</span><span class="string">&quot; kilobytes&quot;</span><span class="keyword">;
<br>&#xA0; &#xA0; &#xA0; &#xA0; else
<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; echo </span><span class="default">round</span><span class="keyword">(</span><span class="default">$mem_usage</span><span class="keyword">/</span><span class="default">1048576</span><span class="keyword">,</span><span class="default">2</span><span class="keyword">).</span><span class="string">&quot; megabytes&quot;</span><span class="keyword">;
<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; 
<br>&#xA0; &#xA0; &#xA0; &#xA0; echo </span><span class="string">&quot;&lt;br/&gt;&quot;</span><span class="keyword">;
<br>&#xA0; &#xA0; }
<br></span><span class="default">?&gt;</span>
</span>
</div>
  

#

[Official documentation page](https://www.php.net/manual/en/function.memory-get-usage.php)

**[To root](/README.md)**