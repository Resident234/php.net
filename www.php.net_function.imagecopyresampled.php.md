# imagecopyresampled




<div class="phpcode"><span class="html">
FOUR RECTANGLES<br><br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; $src_image&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;&#xA0; $dst_image<br>+------------+---------------------------------+&#xA0;&#xA0; +------------+--------------------+<br>|&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; |&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;&#xA0; |&#xA0;&#xA0; |&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; |&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; |<br>|&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; |&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;&#xA0; |&#xA0;&#xA0; |&#xA0; &#xA0; &#xA0; &#xA0;&#xA0; $dst_y&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; |<br>|&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; |&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;&#xA0; |&#xA0;&#xA0; |&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; |&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; |<br>|&#xA0; &#xA0; &#xA0; &#xA0;&#xA0; $src_y&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;&#xA0; |&#xA0;&#xA0; +-- $dst_x --+----$dst_width----+ |<br>|&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; |&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;&#xA0; |&#xA0;&#xA0; |&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; |&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; | |<br>|&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; |&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;&#xA0; |&#xA0;&#xA0; |&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; |&#xA0; &#xA0; Resampled&#xA0; &#xA0;&#xA0; | |<br>|&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; |&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;&#xA0; |&#xA0;&#xA0; |&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; |&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; | |<br>+-- $src_x --+------ $src_width ------+&#xA0; &#xA0; &#xA0; &#xA0; |&#xA0;&#xA0; |&#xA0; &#xA0; &#xA0;&#xA0; $dst_height&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;&#xA0; | |<br>|&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; |&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; |&#xA0; &#xA0; &#xA0; &#xA0; |&#xA0;&#xA0; |&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; |&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; | |<br>|&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; |&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; |&#xA0; &#xA0; &#xA0; &#xA0; |&#xA0;&#xA0; |&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; |&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; | |<br>|&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; |&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; |&#xA0; &#xA0; &#xA0; &#xA0; |&#xA0;&#xA0; |&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; |&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; | |<br>|&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; |&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; |&#xA0; &#xA0; &#xA0; &#xA0; |&#xA0;&#xA0; |&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; +------------------+ |<br>|&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; |&#xA0; &#xA0; &#xA0; &#xA0; Sample&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; |&#xA0; &#xA0; &#xA0; &#xA0; |&#xA0;&#xA0; |&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;&#xA0; |<br>|&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; |&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; |&#xA0; &#xA0; &#xA0; &#xA0; |&#xA0;&#xA0; |&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;&#xA0; |<br>|&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; |&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; |&#xA0; &#xA0; &#xA0; &#xA0; |&#xA0;&#xA0; |&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;&#xA0; |<br>|&#xA0; &#xA0; &#xA0;&#xA0; $src_height&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;&#xA0; |&#xA0; &#xA0; &#xA0; &#xA0; |&#xA0;&#xA0; |&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0;&#xA0; |<br>|&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; |&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; |&#xA0; &#xA0; &#xA0; &#xA0; |&#xA0;&#xA0; +---------------------------------+<br>|&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; |&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; |&#xA0; &#xA0; &#xA0; &#xA0; |<br>|&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; |&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; |&#xA0; &#xA0; &#xA0; &#xA0; |<br>|&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; +------------------------+&#xA0; &#xA0; &#xA0; &#xA0; |<br>|&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; |<br>|&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; |<br>+----------------------------------------------+</span>
</div>
  

#


<div class="phpcode"><span class="html">
Here is my ultimate image resizer that preserves transparency for gif&apos;s and png&apos;s and has an option to crop images to fixed dimensions (preserves image proportions by default)<br><br><span class="default">&lt;?php<br></span><span class="keyword">function </span><span class="default">image_resize</span><span class="keyword">(</span><span class="default">$src</span><span class="keyword">, </span><span class="default">$dst</span><span class="keyword">, </span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">, </span><span class="default">$crop</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">){<br><br>&#xA0; if(!list(</span><span class="default">$w</span><span class="keyword">, </span><span class="default">$h</span><span class="keyword">) = </span><span class="default">getimagesize</span><span class="keyword">(</span><span class="default">$src</span><span class="keyword">)) return </span><span class="string">&quot;Unsupported picture type!&quot;</span><span class="keyword">;<br><br>&#xA0; </span><span class="default">$type </span><span class="keyword">= </span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">strrchr</span><span class="keyword">(</span><span class="default">$src</span><span class="keyword">,</span><span class="string">&quot;.&quot;</span><span class="keyword">),</span><span class="default">1</span><span class="keyword">));<br>&#xA0; if(</span><span class="default">$type </span><span class="keyword">== </span><span class="string">&apos;jpeg&apos;</span><span class="keyword">) </span><span class="default">$type </span><span class="keyword">= </span><span class="string">&apos;jpg&apos;</span><span class="keyword">;<br>&#xA0; switch(</span><span class="default">$type</span><span class="keyword">){<br>&#xA0; &#xA0; case </span><span class="string">&apos;bmp&apos;</span><span class="keyword">: </span><span class="default">$img </span><span class="keyword">= </span><span class="default">imagecreatefromwbmp</span><span class="keyword">(</span><span class="default">$src</span><span class="keyword">); break;<br>&#xA0; &#xA0; case </span><span class="string">&apos;gif&apos;</span><span class="keyword">: </span><span class="default">$img </span><span class="keyword">= </span><span class="default">imagecreatefromgif</span><span class="keyword">(</span><span class="default">$src</span><span class="keyword">); break;<br>&#xA0; &#xA0; case </span><span class="string">&apos;jpg&apos;</span><span class="keyword">: </span><span class="default">$img </span><span class="keyword">= </span><span class="default">imagecreatefromjpeg</span><span class="keyword">(</span><span class="default">$src</span><span class="keyword">); break;<br>&#xA0; &#xA0; case </span><span class="string">&apos;png&apos;</span><span class="keyword">: </span><span class="default">$img </span><span class="keyword">= </span><span class="default">imagecreatefrompng</span><span class="keyword">(</span><span class="default">$src</span><span class="keyword">); break;<br>&#xA0; &#xA0; default : return </span><span class="string">&quot;Unsupported picture type!&quot;</span><span class="keyword">;<br>&#xA0; }<br><br>&#xA0; </span><span class="comment">// resize<br>&#xA0; </span><span class="keyword">if(</span><span class="default">$crop</span><span class="keyword">){<br>&#xA0; &#xA0; if(</span><span class="default">$w </span><span class="keyword">&lt; </span><span class="default">$width </span><span class="keyword">or </span><span class="default">$h </span><span class="keyword">&lt; </span><span class="default">$height</span><span class="keyword">) return </span><span class="string">&quot;Picture is too small!&quot;</span><span class="keyword">;<br>&#xA0; &#xA0; </span><span class="default">$ratio </span><span class="keyword">= </span><span class="default">max</span><span class="keyword">(</span><span class="default">$width</span><span class="keyword">/</span><span class="default">$w</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">/</span><span class="default">$h</span><span class="keyword">);<br>&#xA0; &#xA0; </span><span class="default">$h </span><span class="keyword">= </span><span class="default">$height </span><span class="keyword">/ </span><span class="default">$ratio</span><span class="keyword">;<br>&#xA0; &#xA0; </span><span class="default">$x </span><span class="keyword">= (</span><span class="default">$w </span><span class="keyword">- </span><span class="default">$width </span><span class="keyword">/ </span><span class="default">$ratio</span><span class="keyword">) / </span><span class="default">2</span><span class="keyword">;<br>&#xA0; &#xA0; </span><span class="default">$w </span><span class="keyword">= </span><span class="default">$width </span><span class="keyword">/ </span><span class="default">$ratio</span><span class="keyword">;<br>&#xA0; }<br>&#xA0; else{<br>&#xA0; &#xA0; if(</span><span class="default">$w </span><span class="keyword">&lt; </span><span class="default">$width </span><span class="keyword">and </span><span class="default">$h </span><span class="keyword">&lt; </span><span class="default">$height</span><span class="keyword">) return </span><span class="string">&quot;Picture is too small!&quot;</span><span class="keyword">;<br>&#xA0; &#xA0; </span><span class="default">$ratio </span><span class="keyword">= </span><span class="default">min</span><span class="keyword">(</span><span class="default">$width</span><span class="keyword">/</span><span class="default">$w</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">/</span><span class="default">$h</span><span class="keyword">);<br>&#xA0; &#xA0; </span><span class="default">$width </span><span class="keyword">= </span><span class="default">$w </span><span class="keyword">* </span><span class="default">$ratio</span><span class="keyword">;<br>&#xA0; &#xA0; </span><span class="default">$height </span><span class="keyword">= </span><span class="default">$h </span><span class="keyword">* </span><span class="default">$ratio</span><span class="keyword">;<br>&#xA0; &#xA0; </span><span class="default">$x </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br>&#xA0; }<br><br>&#xA0; </span><span class="default">$new </span><span class="keyword">= </span><span class="default">imagecreatetruecolor</span><span class="keyword">(</span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">);<br><br>&#xA0; </span><span class="comment">// preserve transparency<br>&#xA0; </span><span class="keyword">if(</span><span class="default">$type </span><span class="keyword">== </span><span class="string">&quot;gif&quot; </span><span class="keyword">or </span><span class="default">$type </span><span class="keyword">== </span><span class="string">&quot;png&quot;</span><span class="keyword">){<br>&#xA0; &#xA0; </span><span class="default">imagecolortransparent</span><span class="keyword">(</span><span class="default">$new</span><span class="keyword">, </span><span class="default">imagecolorallocatealpha</span><span class="keyword">(</span><span class="default">$new</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">127</span><span class="keyword">));<br>&#xA0; &#xA0; </span><span class="default">imagealphablending</span><span class="keyword">(</span><span class="default">$new</span><span class="keyword">, </span><span class="default">false</span><span class="keyword">);<br>&#xA0; &#xA0; </span><span class="default">imagesavealpha</span><span class="keyword">(</span><span class="default">$new</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br>&#xA0; }<br><br>&#xA0; </span><span class="default">imagecopyresampled</span><span class="keyword">(</span><span class="default">$new</span><span class="keyword">, </span><span class="default">$img</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">, </span><span class="default">$w</span><span class="keyword">, </span><span class="default">$h</span><span class="keyword">);<br><br>&#xA0; switch(</span><span class="default">$type</span><span class="keyword">){<br>&#xA0; &#xA0; case </span><span class="string">&apos;bmp&apos;</span><span class="keyword">: </span><span class="default">imagewbmp</span><span class="keyword">(</span><span class="default">$new</span><span class="keyword">, </span><span class="default">$dst</span><span class="keyword">); break;<br>&#xA0; &#xA0; case </span><span class="string">&apos;gif&apos;</span><span class="keyword">: </span><span class="default">imagegif</span><span class="keyword">(</span><span class="default">$new</span><span class="keyword">, </span><span class="default">$dst</span><span class="keyword">); break;<br>&#xA0; &#xA0; case </span><span class="string">&apos;jpg&apos;</span><span class="keyword">: </span><span class="default">imagejpeg</span><span class="keyword">(</span><span class="default">$new</span><span class="keyword">, </span><span class="default">$dst</span><span class="keyword">); break;<br>&#xA0; &#xA0; case </span><span class="string">&apos;png&apos;</span><span class="keyword">: </span><span class="default">imagepng</span><span class="keyword">(</span><span class="default">$new</span><span class="keyword">, </span><span class="default">$dst</span><span class="keyword">); break;<br>&#xA0; }<br>&#xA0; return </span><span class="default">true</span><span class="keyword">;<br>}<br></span><span class="default">?&gt;<br></span><br>Example that I use when uploading new images to the server.<br><br>This saves the original picture in the form:<br>original.type<br><br>and creates a new thumbnail:<br>100x100.type<br><br><span class="default">&lt;?php<br>&#xA0; $pic_type </span><span class="keyword">= </span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">strrchr</span><span class="keyword">(</span><span class="default">$picture</span><span class="keyword">[</span><span class="string">&apos;name&apos;</span><span class="keyword">],</span><span class="string">&quot;.&quot;</span><span class="keyword">));<br>&#xA0; </span><span class="default">$pic_name </span><span class="keyword">= </span><span class="string">&quot;original</span><span class="default">$pic_type</span><span class="string">&quot;</span><span class="keyword">;<br>&#xA0; </span><span class="default">move_uploaded_file</span><span class="keyword">(</span><span class="default">$picture</span><span class="keyword">[</span><span class="string">&apos;tmp_name&apos;</span><span class="keyword">], </span><span class="default">$pic_name</span><span class="keyword">);<br>&#xA0; if (</span><span class="default">true </span><span class="keyword">!== (</span><span class="default">$pic_error </span><span class="keyword">= @</span><span class="default">image_resize</span><span class="keyword">(</span><span class="default">$pic_name</span><span class="keyword">, </span><span class="string">&quot;100x100</span><span class="default">$pic_type</span><span class="string">&quot;</span><span class="keyword">, </span><span class="default">100</span><span class="keyword">, </span><span class="default">100</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">))) {<br>&#xA0; &#xA0; echo </span><span class="default">$pic_error</span><span class="keyword">;<br>&#xA0; &#xA0; </span><span class="default">unlink</span><span class="keyword">(</span><span class="default">$pic_name</span><span class="keyword">);<br>&#xA0; }<br>&#xA0; else echo </span><span class="string">&quot;OK!&quot;</span><span class="keyword">;<br></span><span class="default">?&gt;<br></span><br>Cheers!</span>
</div>
  

#


<div class="phpcode"><span class="html">
I&apos;ve created a PHP5 image resize class, using ImageCopyResampled, that someone might find useful, with support for JPEG, PNG, and GIF formats. It retains the original image&apos;s aspect ratio when resizing, and doesn&apos;t resize or resample if the original width and height is smaller then the desired resize.<br><br><span class="default">&lt;?php<br><br></span><span class="comment">// Imaging<br></span><span class="keyword">class </span><span class="default">imaging<br></span><span class="keyword">{<br><br>&#xA0; &#xA0; </span><span class="comment">// Variables<br>&#xA0; &#xA0; </span><span class="keyword">private </span><span class="default">$img_input</span><span class="keyword">;<br>&#xA0; &#xA0; private </span><span class="default">$img_output</span><span class="keyword">;<br>&#xA0; &#xA0; private </span><span class="default">$img_src</span><span class="keyword">;<br>&#xA0; &#xA0; private </span><span class="default">$format</span><span class="keyword">;<br>&#xA0; &#xA0; private </span><span class="default">$quality </span><span class="keyword">= </span><span class="default">80</span><span class="keyword">;<br>&#xA0; &#xA0; private </span><span class="default">$x_input</span><span class="keyword">;<br>&#xA0; &#xA0; private </span><span class="default">$y_input</span><span class="keyword">;<br>&#xA0; &#xA0; private </span><span class="default">$x_output</span><span class="keyword">;<br>&#xA0; &#xA0; private </span><span class="default">$y_output</span><span class="keyword">;<br>&#xA0; &#xA0; private </span><span class="default">$resize</span><span class="keyword">;<br><br>&#xA0; &#xA0; </span><span class="comment">// Set image<br>&#xA0; &#xA0; </span><span class="keyword">public function </span><span class="default">set_img</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">)<br>&#xA0; &#xA0; {<br><br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="comment">// Find format<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$ext </span><span class="keyword">= </span><span class="default">strtoupper</span><span class="keyword">(</span><span class="default">pathinfo</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">PATHINFO_EXTENSION</span><span class="keyword">));<br><br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="comment">// JPEG image<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="keyword">if(</span><span class="default">is_file</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">) &amp;&amp; (</span><span class="default">$ext </span><span class="keyword">== </span><span class="string">&quot;JPG&quot; </span><span class="keyword">OR </span><span class="default">$ext </span><span class="keyword">== </span><span class="string">&quot;JPEG&quot;</span><span class="keyword">))<br>&#xA0; &#xA0; &#xA0; &#xA0; {<br><br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">format </span><span class="keyword">= </span><span class="default">$ext</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">img_input </span><span class="keyword">= </span><span class="default">ImageCreateFromJPEG</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">img_src </span><span class="keyword">= </span><span class="default">$img</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; <br><br>&#xA0; &#xA0; &#xA0; &#xA0; }<br><br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="comment">// PNG image<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="keyword">elseif(</span><span class="default">is_file</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">) &amp;&amp; </span><span class="default">$ext </span><span class="keyword">== </span><span class="string">&quot;PNG&quot;</span><span class="keyword">)<br>&#xA0; &#xA0; &#xA0; &#xA0; {<br><br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">format </span><span class="keyword">= </span><span class="default">$ext</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">img_input </span><span class="keyword">= </span><span class="default">ImageCreateFromPNG</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">img_src </span><span class="keyword">= </span><span class="default">$img</span><span class="keyword">;<br><br>&#xA0; &#xA0; &#xA0; &#xA0; }<br><br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="comment">// GIF image<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="keyword">elseif(</span><span class="default">is_file</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">) &amp;&amp; </span><span class="default">$ext </span><span class="keyword">== </span><span class="string">&quot;GIF&quot;</span><span class="keyword">)<br>&#xA0; &#xA0; &#xA0; &#xA0; {<br><br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">format </span><span class="keyword">= </span><span class="default">$ext</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">img_input </span><span class="keyword">= </span><span class="default">ImageCreateFromGIF</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">img_src </span><span class="keyword">= </span><span class="default">$img</span><span class="keyword">;<br><br>&#xA0; &#xA0; &#xA0; &#xA0; }<br><br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="comment">// Get dimensions<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">x_input </span><span class="keyword">= </span><span class="default">imagesx</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">img_input</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">y_input </span><span class="keyword">= </span><span class="default">imagesy</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">img_input</span><span class="keyword">);<br><br>&#xA0; &#xA0; }<br><br>&#xA0; &#xA0; </span><span class="comment">// Set maximum image size (pixels)<br>&#xA0; &#xA0; </span><span class="keyword">public function </span><span class="default">set_size</span><span class="keyword">(</span><span class="default">$size </span><span class="keyword">= </span><span class="default">100</span><span class="keyword">)<br>&#xA0; &#xA0; {<br><br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="comment">// Resize<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="keyword">if(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">x_input </span><span class="keyword">&gt; </span><span class="default">$size </span><span class="keyword">&amp;&amp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">y_input </span><span class="keyword">&gt; </span><span class="default">$size</span><span class="keyword">)<br>&#xA0; &#xA0; &#xA0; &#xA0; {<br><br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="comment">// Wide<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="keyword">if(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">x_input </span><span class="keyword">&gt;= </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">y_input</span><span class="keyword">)<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; {<br><br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">x_output </span><span class="keyword">= </span><span class="default">$size</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">y_output </span><span class="keyword">= (</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">x_output </span><span class="keyword">/ </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">x_input</span><span class="keyword">) * </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">y_input</span><span class="keyword">;<br><br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; }<br><br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="comment">// Tall<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="keyword">else<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; {<br><br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">y_output </span><span class="keyword">= </span><span class="default">$size</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">x_output </span><span class="keyword">= (</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">y_output </span><span class="keyword">/ </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">y_input</span><span class="keyword">) * </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">x_input</span><span class="keyword">;<br><br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; }<br><br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="comment">// Ready<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">resize </span><span class="keyword">= </span><span class="default">TRUE</span><span class="keyword">;<br><br>&#xA0; &#xA0; &#xA0; &#xA0; }<br><br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="comment">// Don&apos;t resize<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="keyword">else { </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">resize </span><span class="keyword">= </span><span class="default">FALSE</span><span class="keyword">; }<br><br>&#xA0; &#xA0; }<br><br>&#xA0; &#xA0; </span><span class="comment">// Set image quality (JPEG only)<br>&#xA0; &#xA0; </span><span class="keyword">public function </span><span class="default">set_quality</span><span class="keyword">(</span><span class="default">$quality</span><span class="keyword">)<br>&#xA0; &#xA0; {<br><br>&#xA0; &#xA0; &#xA0; &#xA0; if(</span><span class="default">is_int</span><span class="keyword">(</span><span class="default">$quality</span><span class="keyword">))<br>&#xA0; &#xA0; &#xA0; &#xA0; {<br><br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">quality </span><span class="keyword">= </span><span class="default">$quality</span><span class="keyword">;<br><br>&#xA0; &#xA0; &#xA0; &#xA0; }<br><br>&#xA0; &#xA0; }<br><br>&#xA0; &#xA0; </span><span class="comment">// Save image<br>&#xA0; &#xA0; </span><span class="keyword">public function </span><span class="default">save_img</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">)<br>&#xA0; &#xA0; {<br><br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="comment">// Resize<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="keyword">if(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">resize</span><span class="keyword">)<br>&#xA0; &#xA0; &#xA0; &#xA0; {<br><br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">img_output </span><span class="keyword">= </span><span class="default">ImageCreateTrueColor</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">x_output</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">y_output</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">ImageCopyResampled</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">img_output</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">img_input</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">x_output</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">y_output</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">x_input</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">y_input</span><span class="keyword">);<br><br>&#xA0; &#xA0; &#xA0; &#xA0; }<br><br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="comment">// Save JPEG<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="keyword">if(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">format </span><span class="keyword">== </span><span class="string">&quot;JPG&quot; </span><span class="keyword">OR </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">format </span><span class="keyword">== </span><span class="string">&quot;JPEG&quot;</span><span class="keyword">)<br>&#xA0; &#xA0; &#xA0; &#xA0; {<br><br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; if(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">resize</span><span class="keyword">) { </span><span class="default">imageJPEG</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">img_output</span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">quality</span><span class="keyword">); }<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; else { </span><span class="default">copy</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">img_src</span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">); }<br><br>&#xA0; &#xA0; &#xA0; &#xA0; }<br><br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="comment">// Save PNG<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="keyword">elseif(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">format </span><span class="keyword">== </span><span class="string">&quot;PNG&quot;</span><span class="keyword">)<br>&#xA0; &#xA0; &#xA0; &#xA0; {<br><br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; if(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">resize</span><span class="keyword">) { </span><span class="default">imagePNG</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">img_output</span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">); }<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; else { </span><span class="default">copy</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">img_src</span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">); }<br><br>&#xA0; &#xA0; &#xA0; &#xA0; }<br><br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="comment">// Save GIF<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="keyword">elseif(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">format </span><span class="keyword">== </span><span class="string">&quot;GIF&quot;</span><span class="keyword">)<br>&#xA0; &#xA0; &#xA0; &#xA0; {<br><br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; if(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">resize</span><span class="keyword">) { </span><span class="default">imageGIF</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">img_output</span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">); }<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; else { </span><span class="default">copy</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">img_src</span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">); }<br><br>&#xA0; &#xA0; &#xA0; &#xA0; }<br><br>&#xA0; &#xA0; }<br><br>&#xA0; &#xA0; </span><span class="comment">// Get width<br>&#xA0; &#xA0; </span><span class="keyword">public function </span><span class="default">get_width</span><span class="keyword">()<br>&#xA0; &#xA0; {<br><br>&#xA0; &#xA0; &#xA0; &#xA0; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">x_input</span><span class="keyword">;<br><br>&#xA0; &#xA0; }<br><br>&#xA0; &#xA0; </span><span class="comment">// Get height<br>&#xA0; &#xA0; </span><span class="keyword">public function </span><span class="default">get_height</span><span class="keyword">()<br>&#xA0; &#xA0; {<br><br>&#xA0; &#xA0; &#xA0; &#xA0; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">y_input</span><span class="keyword">;<br><br>&#xA0; &#xA0; }<br><br>&#xA0; &#xA0; </span><span class="comment">// Clear image cache<br>&#xA0; &#xA0; </span><span class="keyword">public function </span><span class="default">clear_cache</span><span class="keyword">()<br>&#xA0; &#xA0; {<br><br>&#xA0; &#xA0; &#xA0; &#xA0; @</span><span class="default">ImageDestroy</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">img_input</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; @</span><span class="default">ImageDestroy</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">img_output</span><span class="keyword">);<br><br>&#xA0; &#xA0; }<br><br>}<br><br></span><span class="comment">##### DEMO #####<br><br>// Image<br></span><span class="default">$src </span><span class="keyword">= </span><span class="string">&quot;myimage.jpg&quot;</span><span class="keyword">;<br><br></span><span class="comment">// Begin<br></span><span class="default">$img </span><span class="keyword">= new </span><span class="default">imaging</span><span class="keyword">;<br></span><span class="default">$img</span><span class="keyword">-&gt;</span><span class="default">set_img</span><span class="keyword">(</span><span class="default">$src</span><span class="keyword">);<br></span><span class="default">$img</span><span class="keyword">-&gt;</span><span class="default">set_quality</span><span class="keyword">(</span><span class="default">80</span><span class="keyword">);<br><br></span><span class="comment">// Small thumbnail<br></span><span class="default">$img</span><span class="keyword">-&gt;</span><span class="default">set_size</span><span class="keyword">(</span><span class="default">200</span><span class="keyword">);<br></span><span class="default">$img</span><span class="keyword">-&gt;</span><span class="default">save_img</span><span class="keyword">(</span><span class="string">&quot;small_&quot; </span><span class="keyword">. </span><span class="default">$src</span><span class="keyword">);<br><br></span><span class="comment">// Baby thumbnail<br></span><span class="default">$img</span><span class="keyword">-&gt;</span><span class="default">set_size</span><span class="keyword">(</span><span class="default">50</span><span class="keyword">);<br></span><span class="default">$img</span><span class="keyword">-&gt;</span><span class="default">save_img</span><span class="keyword">(</span><span class="string">&quot;baby_&quot; </span><span class="keyword">. </span><span class="default">$src</span><span class="keyword">);<br><br></span><span class="comment">// Finalize<br></span><span class="default">$img</span><span class="keyword">-&gt;</span><span class="default">clear_cache</span><span class="keyword">();<br><br></span><span class="default">?&gt;</span>
</span>
</div>
  

#

[Official documentation page](https://www.php.net/manual/en/function.imagecopyresampled.php)

**[⬆ to root](/)**