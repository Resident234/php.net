# The IteratorAggregate interface




<div class="phpcode"><span class="html">
Note that, at least as of 5.3, you still aren&apos;t allowed to return a normal Array from getIterator().<br><br>In some places, the docs wrap the array into an ArrayObject and return that.&#xA0; DON&apos;T DO IT.&#xA0; ArrayObject drops any empty-string keys on the floor when you iterate over it (again, at least as of 5.3).<br><br>Use ArrayIterator instead.&#xA0; I wouldn&apos;t be surprised if it didn&apos;t have its own set of wonderful bugs, but at the very least it works correctly when you use it with this method.</span>
</div>
  

#


<div class="phpcode"><span class="html">
It might seem obvious, but you can return a compiled generator from your IteratorAggregate::getIterator() implementation.<br><br><span class="default">&lt;?php<br></span><span class="keyword">class </span><span class="default">Collection </span><span class="keyword">implements </span><span class="default">IteratorAggregate<br></span><span class="keyword">{<br>&#xA0; &#xA0; private </span><span class="default">$items </span><span class="keyword">= [];<br><br>&#xA0; &#xA0; public function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$items </span><span class="keyword">= [])<br>&#xA0; &#xA0; {<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">items </span><span class="keyword">= </span><span class="default">$items</span><span class="keyword">;<br>&#xA0; &#xA0; }<br><br>&#xA0; &#xA0; public function </span><span class="default">getIterator</span><span class="keyword">()<br>&#xA0; &#xA0; {<br>&#xA0; &#xA0; &#xA0; &#xA0; return (function () {<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; while(list(</span><span class="default">$key</span><span class="keyword">, </span><span class="default">$val</span><span class="keyword">) = </span><span class="default">each</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">items</span><span class="keyword">)) {<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; yield </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$val</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; }<br>&#xA0; &#xA0; &#xA0; &#xA0; })();<br>&#xA0; &#xA0; }<br>}<br><br></span><span class="default">$data </span><span class="keyword">= [ </span><span class="string">&apos;A&apos;</span><span class="keyword">, </span><span class="string">&apos;B&apos;</span><span class="keyword">, </span><span class="string">&apos;C&apos;</span><span class="keyword">, </span><span class="string">&apos;D&apos; </span><span class="keyword">];<br></span><span class="default">$collection </span><span class="keyword">= new </span><span class="default">Collection</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">);<br><br>foreach (</span><span class="default">$collection </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$val</span><span class="keyword">) {<br>&#xA0; &#xA0; echo </span><span class="default">sprintf</span><span class="keyword">(</span><span class="string">&quot;[%s] =&gt; %s\n&quot;</span><span class="keyword">, </span><span class="default">$key</span><span class="keyword">, </span><span class="default">$val</span><span class="keyword">);<br>}<br></span><span class="default">?&gt;</span>
</span>
</div>
  

#


<div class="phpcode"><span class="html">
<span class="default">&lt;?php<br></span><span class="comment">// IteratorAggregate<br>// Create indexed and associative arrays.<br><br></span><span class="keyword">class </span><span class="default">myData </span><span class="keyword">implements </span><span class="default">IteratorAggregate </span><span class="keyword">{<br><br>&#xA0; &#xA0; private </span><span class="default">$array </span><span class="keyword">= [];<br>&#xA0; &#xA0; const </span><span class="default">TYPE_INDEXED </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;<br>&#xA0; &#xA0; const </span><span class="default">TYPE_ASSOCIATIVE </span><span class="keyword">= </span><span class="default">2</span><span class="keyword">;<br><br>&#xA0; &#xA0; public function </span><span class="default">__construct</span><span class="keyword">( array </span><span class="default">$data</span><span class="keyword">, </span><span class="default">$type </span><span class="keyword">= </span><span class="default">self</span><span class="keyword">::</span><span class="default">TYPE_INDEXED </span><span class="keyword">) {<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">reset</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; while( list(</span><span class="default">$k</span><span class="keyword">, </span><span class="default">$v</span><span class="keyword">) = </span><span class="default">each</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">) ) {<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$type </span><span class="keyword">== </span><span class="default">self</span><span class="keyword">::</span><span class="default">TYPE_INDEXED </span><span class="keyword">?<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">array</span><span class="keyword">[] = </span><span class="default">$v </span><span class="keyword">:<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">array</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">] = </span><span class="default">$v</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; }<br>&#xA0; &#xA0; }<br><br>&#xA0; &#xA0; public function </span><span class="default">getIterator</span><span class="keyword">() {<br>&#xA0; &#xA0; &#xA0; &#xA0; return new </span><span class="default">ArrayIterator</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">array</span><span class="keyword">);<br>&#xA0; &#xA0; }<br><br>}<br><br></span><span class="default">$obj </span><span class="keyword">= new </span><span class="default">myData</span><span class="keyword">([</span><span class="string">&apos;one&apos;</span><span class="keyword">=&gt;</span><span class="string">&apos;php&apos;</span><span class="keyword">,</span><span class="string">&apos;javascript&apos;</span><span class="keyword">,</span><span class="string">&apos;three&apos;</span><span class="keyword">=&gt;</span><span class="string">&apos;c#&apos;</span><span class="keyword">,</span><span class="string">&apos;java&apos;</span><span class="keyword">,], </span><span class="comment">/*TYPE 1 or 2*/ </span><span class="keyword">);<br><br>foreach(</span><span class="default">$obj </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$value</span><span class="keyword">) {<br>&#xA0; &#xA0; </span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">);<br>&#xA0; &#xA0; echo </span><span class="default">PHP_EOL</span><span class="keyword">;<br>}<br><br></span><span class="comment">// if TYPE == 1<br>#int(0)<br>#string(3) &quot;php&quot;<br>#int(1)<br>#string(10) &quot;javascript&quot;<br>#int(2)<br>#string(2) &quot;c#&quot;<br>#int(3)<br>#string(4) &quot;java&quot;<br><br>// if TYPE == 2<br>#string(3) &quot;one&quot;<br>#string(3) &quot;php&quot;<br>#int(0)<br>#string(10) &quot;javascript&quot;<br>#string(5) &quot;three&quot;<br>#string(2) &quot;c#&quot;<br>#int(1)<br>#string(4) &quot;java&quot;<br></span><span class="default">?&gt;<br></span><br>Good luck!</span>
</div>
  

#

[Official documentation page](https://www.php.net/manual/en/class.iteratoraggregate.php)

**[To root](/README.md)**