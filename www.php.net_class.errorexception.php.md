# ErrorException




<div class="phpcode"><span class="html">
As noted below, it&apos;s important to realize that unless caught, any Exception thrown will halt the script.&#xA0; So converting EVERY notice, warning, or error to an ErrorException will halt your script when something harmlesss like E_USER_NOTICE is triggered.<br><br>It seems to me the best use of the ErrorException class is something like this:<br><br><span class="default">&lt;?php<br></span><span class="keyword">function </span><span class="default">custom_error_handler</span><span class="keyword">(</span><span class="default">$number</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">, </span><span class="default">$file</span><span class="keyword">, </span><span class="default">$line</span><span class="keyword">, </span><span class="default">$context</span><span class="keyword">) <br>{<br>&#xA0; &#xA0; </span><span class="comment">// Determine if this error is one of the enabled ones in php config (php.ini, .htaccess, etc)<br>&#xA0; &#xA0; </span><span class="default">$error_is_enabled </span><span class="keyword">= (bool)(</span><span class="default">$number </span><span class="keyword">&amp; </span><span class="default">ini_get</span><span class="keyword">(</span><span class="string">&apos;error_reporting&apos;</span><span class="keyword">) );<br>&#xA0; &#xA0; <br>&#xA0; &#xA0; </span><span class="comment">// -- FATAL ERROR<br>&#xA0; &#xA0; // throw an Error Exception, to be handled by whatever Exception handling logic is available in this context<br>&#xA0; &#xA0; </span><span class="keyword">if( </span><span class="default">in_array</span><span class="keyword">(</span><span class="default">$number</span><span class="keyword">, array(</span><span class="default">E_USER_ERROR</span><span class="keyword">, </span><span class="default">E_RECOVERABLE_ERROR</span><span class="keyword">)) &amp;&amp; </span><span class="default">$error_is_enabled </span><span class="keyword">) {<br>&#xA0; &#xA0; &#xA0; &#xA0; throw new </span><span class="default">ErrorException</span><span class="keyword">(</span><span class="default">$errstr</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$errno</span><span class="keyword">, </span><span class="default">$errfile</span><span class="keyword">, </span><span class="default">$errline</span><span class="keyword">);<br>&#xA0; &#xA0; }<br>&#xA0; &#xA0; <br>&#xA0; &#xA0; </span><span class="comment">// -- NON-FATAL ERROR/WARNING/NOTICE<br>&#xA0; &#xA0; // Log the error if it&apos;s enabled, otherwise just ignore it<br>&#xA0; &#xA0; </span><span class="keyword">else if( </span><span class="default">$error_is_enabled </span><span class="keyword">) {<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">error_log</span><span class="keyword">( </span><span class="default">$string</span><span class="keyword">, </span><span class="default">0 </span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; return </span><span class="default">false</span><span class="keyword">; </span><span class="comment">// Make sure this ends up in $php_errormsg, if appropriate<br>&#xA0; &#xA0; </span><span class="keyword">}<br>}<br></span><span class="default">?&gt;<br></span><br>Setting this function as the error handler will result in ErrorExceptions only being thrown for E_USER_ERROR and E_RECOVERABLE_ERROR, while other enabled error types will simply get error_log()&apos;ed.<br><br>It&apos;s worth noting again that no matter what you do, &quot;E_ERROR, E_PARSE, E_CORE_ERROR, E_CORE_WARNING, E_COMPILE_ERROR, E_COMPILE_WARNING, and most of E_STRICT&quot; will never reach your custom error handler, and therefore will not be converted into ErrorExceptions.&#xA0; Plan accordingly.</span>
</div>
  

#


<div class="phpcode"><span class="html">
E_USER_WARNING, E_USER_NOTICE, and any other non-terminating error codes, are useless and act like E_USER_ERROR (which terminate) when you combine a custom ERROR_HANDLER with ErrorException and do not CATCH the error. There is NO way to return execution to the parent scope in the EXCEPTION_HANDLER.<br><br><span class="default">&lt;?php<br>&#xA0; &#xA0; <br>&#xA0; &#xA0; error_reporting</span><span class="keyword">(</span><span class="default">E_ALL</span><span class="keyword">);<br>&#xA0; &#xA0; </span><span class="default">define</span><span class="keyword">(</span><span class="string">&apos;DEBUG&apos;</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br>&#xA0; &#xA0; </span><span class="default">define</span><span class="keyword">(</span><span class="string">&apos;LINEBREAK&apos;</span><span class="keyword">, </span><span class="string">&quot;\r\n&quot;</span><span class="keyword">);<br>&#xA0; &#xA0; <br>&#xA0; &#xA0; </span><span class="default">error</span><span class="keyword">::</span><span class="default">initiate</span><span class="keyword">(</span><span class="string">&apos;./error_backtrace.log&apos;</span><span class="keyword">);<br>&#xA0; &#xA0; <br>&#xA0; &#xA0; try<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">trigger_error</span><span class="keyword">(</span><span class="string">&quot;First error&quot;</span><span class="keyword">, </span><span class="default">E_USER_NOTICE</span><span class="keyword">);<br>&#xA0; &#xA0; catch ( </span><span class="default">ErrorException $e </span><span class="keyword">)<br>&#xA0; &#xA0; &#xA0; &#xA0; print(</span><span class="string">&quot;Caught the error: &quot;</span><span class="keyword">.</span><span class="default">$e</span><span class="keyword">-&gt;</span><span class="default">getMessage</span><span class="keyword">.</span><span class="string">&quot;&lt;br /&gt;\r\n&quot; </span><span class="keyword">);<br>&#xA0; &#xA0; <br>&#xA0; &#xA0; </span><span class="default">trigger_error</span><span class="keyword">(</span><span class="string">&quot;This event WILL fire&quot;</span><span class="keyword">, </span><span class="default">E_USER_NOTICE</span><span class="keyword">);<br>&#xA0; &#xA0; <br>&#xA0; &#xA0; </span><span class="default">trigger_error</span><span class="keyword">(</span><span class="string">&quot;This event will NOT fire&quot;</span><span class="keyword">, </span><span class="default">E_USER_NOTICE</span><span class="keyword">);<br>&#xA0; &#xA0; <br>&#xA0; &#xA0; abstract class </span><span class="default">error </span><span class="keyword">{<br>&#xA0; &#xA0; &#xA0; &#xA0; <br>&#xA0; &#xA0; &#xA0; &#xA0; public static </span><span class="default">$LIST </span><span class="keyword">= array();<br>&#xA0; &#xA0; &#xA0; &#xA0; <br>&#xA0; &#xA0; &#xA0; &#xA0; private function </span><span class="default">__construct</span><span class="keyword">() {}<br>&#xA0; &#xA0; &#xA0; &#xA0; <br>&#xA0; &#xA0; &#xA0; &#xA0; public static function </span><span class="default">initiate</span><span class="keyword">( </span><span class="default">$log </span><span class="keyword">= </span><span class="default">false </span><span class="keyword">) {<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">set_error_handler</span><span class="keyword">( </span><span class="string">&apos;error::err_handler&apos; </span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">set_exception_handler</span><span class="keyword">( </span><span class="string">&apos;error::exc_handler&apos; </span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; if ( </span><span class="default">$log </span><span class="keyword">!== </span><span class="default">false </span><span class="keyword">) {<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; if ( ! </span><span class="default">ini_get</span><span class="keyword">(</span><span class="string">&apos;log_errors&apos;</span><span class="keyword">) )<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">ini_set</span><span class="keyword">(</span><span class="string">&apos;log_errors&apos;</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; if ( ! </span><span class="default">ini_get</span><span class="keyword">(</span><span class="string">&apos;error_log&apos;</span><span class="keyword">) )<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">ini_set</span><span class="keyword">(</span><span class="string">&apos;error_log&apos;</span><span class="keyword">, </span><span class="default">$log</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; }<br>&#xA0; &#xA0; &#xA0; &#xA0; }<br>&#xA0; &#xA0; &#xA0; &#xA0; <br>&#xA0; &#xA0; &#xA0; &#xA0; public static function </span><span class="default">err_handler</span><span class="keyword">(</span><span class="default">$errno</span><span class="keyword">, </span><span class="default">$errstr</span><span class="keyword">, </span><span class="default">$errfile</span><span class="keyword">, </span><span class="default">$errline</span><span class="keyword">, </span><span class="default">$errcontext</span><span class="keyword">) {<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$l </span><span class="keyword">= </span><span class="default">error_reporting</span><span class="keyword">();<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; if ( </span><span class="default">$l </span><span class="keyword">&amp; </span><span class="default">$errno </span><span class="keyword">) {<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; <br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$exit </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; switch ( </span><span class="default">$errno </span><span class="keyword">) {<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; case </span><span class="default">E_USER_ERROR</span><span class="keyword">:<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$type </span><span class="keyword">= </span><span class="string">&apos;Fatal Error&apos;</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$exit </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; break;<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; case </span><span class="default">E_USER_WARNING</span><span class="keyword">:<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; case </span><span class="default">E_WARNING</span><span class="keyword">:<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$type </span><span class="keyword">= </span><span class="string">&apos;Warning&apos;</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; break;<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; case </span><span class="default">E_USER_NOTICE</span><span class="keyword">:<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; case </span><span class="default">E_NOTICE</span><span class="keyword">:<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; case @</span><span class="default">E_STRICT</span><span class="keyword">:<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$type </span><span class="keyword">= </span><span class="string">&apos;Notice&apos;</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; break;<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; case @</span><span class="default">E_RECOVERABLE_ERROR</span><span class="keyword">:<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$type </span><span class="keyword">= </span><span class="string">&apos;Catchable&apos;</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; break;<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; default:<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$type </span><span class="keyword">= </span><span class="string">&apos;Unknown Error&apos;</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$exit </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; break;<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; }<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; <br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$exception </span><span class="keyword">= new \</span><span class="default">ErrorException</span><span class="keyword">(</span><span class="default">$type</span><span class="keyword">.</span><span class="string">&apos;: &apos;</span><span class="keyword">.</span><span class="default">$errstr</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$errno</span><span class="keyword">, </span><span class="default">$errfile</span><span class="keyword">, </span><span class="default">$errline</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; <br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; if ( </span><span class="default">$exit </span><span class="keyword">) {<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">exc_handler</span><span class="keyword">(</span><span class="default">$exception</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; exit();<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; }<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; else<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; throw </span><span class="default">$exception</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; }<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; return </span><span class="default">false</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; }<br>&#xA0; &#xA0; &#xA0; &#xA0; <br>&#xA0; &#xA0; &#xA0; &#xA0; function </span><span class="default">exc_handler</span><span class="keyword">(</span><span class="default">$exception</span><span class="keyword">) {<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$log </span><span class="keyword">= </span><span class="default">$exception</span><span class="keyword">-&gt;</span><span class="default">getMessage</span><span class="keyword">() . </span><span class="string">&quot;\n&quot; </span><span class="keyword">. </span><span class="default">$exception</span><span class="keyword">-&gt;</span><span class="default">getTraceAsString</span><span class="keyword">() . </span><span class="default">LINEBREAK</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; if ( </span><span class="default">ini_get</span><span class="keyword">(</span><span class="string">&apos;log_errors&apos;</span><span class="keyword">) )<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">error_log</span><span class="keyword">(</span><span class="default">$log</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; print(</span><span class="string">&quot;Unhandled Exception&quot; </span><span class="keyword">. (</span><span class="default">DEBUG </span><span class="keyword">? </span><span class="string">&quot; - </span><span class="default">$log</span><span class="string">&quot; </span><span class="keyword">: </span><span class="string">&apos;&apos;</span><span class="keyword">));<br>&#xA0; &#xA0; &#xA0; &#xA0; }<br>&#xA0; &#xA0; &#xA0; &#xA0; <br>&#xA0; &#xA0; }<br></span><span class="default">?&gt;</span>
</span>
</div>
  

#

[Official documentation page](https://www.php.net/manual/en/class.errorexception.php)

**[⬆ to root](/)**