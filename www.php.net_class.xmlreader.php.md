# The XMLReader class




<div class="phpcode"><span class="html">
Wrapper XMLReader class, for simple SAX-reading huge xml:<br><a href="https://github.com/dkrnl/SimpleXMLReader" rel="nofollow" target="_blank">https://github.com/dkrnl/SimpleXMLReader</a><br><br>Usage example: <a href="http://github.com/dkrnl/SimpleXMLReader/blob/master/examples/example1.php" rel="nofollow" target="_blank">http://github.com/dkrnl/SimpleXMLReader/blob/master/examples/example1.php</a><br><br><span class="default">&lt;?php<br><br></span><span class="comment">/**<br> * Simple XML Reader<br> *<br> * @license Public Domain<br> * @author Dmitry Pyatkov(aka dkrnl) &lt;dkrnl@yandex.ru&gt;<br> * @url <a href="http://github.com/dkrnl/SimpleXMLReader" rel="nofollow" target="_blank">http://github.com/dkrnl/SimpleXMLReader</a><br> */<br></span><span class="keyword">class </span><span class="default">SimpleXMLReader </span><span class="keyword">extends </span><span class="default">XMLReader<br></span><span class="keyword">{<br><br>&#xA0; &#xA0; </span><span class="comment">/**<br>&#xA0; &#xA0;&#xA0; * Callbacks<br>&#xA0; &#xA0;&#xA0; *<br>&#xA0; &#xA0;&#xA0; * @var array<br>&#xA0; &#xA0;&#xA0; */<br>&#xA0; &#xA0; </span><span class="keyword">protected </span><span class="default">$callback </span><span class="keyword">= array();<br><br>&#xA0; &#xA0; </span><span class="comment">/**<br>&#xA0; &#xA0;&#xA0; * Add node callback<br>&#xA0; &#xA0;&#xA0; *<br>&#xA0; &#xA0;&#xA0; * @param&#xA0; string&#xA0;&#xA0; $name<br>&#xA0; &#xA0;&#xA0; * @param&#xA0; callback $callback<br>&#xA0; &#xA0;&#xA0; * @param&#xA0; integer&#xA0; $nodeType<br>&#xA0; &#xA0;&#xA0; * @return SimpleXMLReader<br>&#xA0; &#xA0;&#xA0; */<br>&#xA0; &#xA0; </span><span class="keyword">public function </span><span class="default">registerCallback</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">, </span><span class="default">$callback</span><span class="keyword">, </span><span class="default">$nodeType </span><span class="keyword">= </span><span class="default">XMLREADER</span><span class="keyword">::</span><span class="default">ELEMENT</span><span class="keyword">)<br>&#xA0; &#xA0; {<br>&#xA0; &#xA0; &#xA0; &#xA0; if (isset(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">callback</span><span class="keyword">[</span><span class="default">$nodeType</span><span class="keyword">][</span><span class="default">$name</span><span class="keyword">])) {<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">&quot;Already exists callback </span><span class="default">$name</span><span class="string">(</span><span class="default">$nodeType</span><span class="string">).&quot;</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; }<br>&#xA0; &#xA0; &#xA0; &#xA0; if (!</span><span class="default">is_callable</span><span class="keyword">(</span><span class="default">$callback</span><span class="keyword">)) {<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">&quot;Already exists parser callback </span><span class="default">$name</span><span class="string">(</span><span class="default">$nodeType</span><span class="string">).&quot;</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; }<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">callback</span><span class="keyword">[</span><span class="default">$nodeType</span><span class="keyword">][</span><span class="default">$name</span><span class="keyword">] = </span><span class="default">$callback</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; return </span><span class="default">$this</span><span class="keyword">;<br>&#xA0; &#xA0; }<br><br>&#xA0; &#xA0; </span><span class="comment">/**<br>&#xA0; &#xA0;&#xA0; * Remove node callback<br>&#xA0; &#xA0;&#xA0; *<br>&#xA0; &#xA0;&#xA0; * @param&#xA0; string&#xA0; $name<br>&#xA0; &#xA0;&#xA0; * @param&#xA0; integer $nodeType<br>&#xA0; &#xA0;&#xA0; * @return SimpleXMLReader<br>&#xA0; &#xA0;&#xA0; */<br>&#xA0; &#xA0; </span><span class="keyword">public function </span><span class="default">unRegisterCallback</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">, </span><span class="default">$nodeType </span><span class="keyword">= </span><span class="default">XMLREADER</span><span class="keyword">::</span><span class="default">ELEMENT</span><span class="keyword">)<br>&#xA0; &#xA0; {<br>&#xA0; &#xA0; &#xA0; &#xA0; if (!isset(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">callback</span><span class="keyword">[</span><span class="default">$nodeType</span><span class="keyword">][</span><span class="default">$name</span><span class="keyword">])) {<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">&quot;Unknow parser callback </span><span class="default">$name</span><span class="string">(</span><span class="default">$nodeType</span><span class="string">).&quot;</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; }<br>&#xA0; &#xA0; &#xA0; &#xA0; unset(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">callback</span><span class="keyword">[</span><span class="default">$nodeType</span><span class="keyword">][</span><span class="default">$name</span><span class="keyword">]);<br>&#xA0; &#xA0; &#xA0; &#xA0; return </span><span class="default">$this</span><span class="keyword">;<br>&#xA0; &#xA0; }<br><br>&#xA0; &#xA0; </span><span class="comment">/**<br>&#xA0; &#xA0;&#xA0; * Run parser<br>&#xA0; &#xA0;&#xA0; *<br>&#xA0; &#xA0;&#xA0; * @return void<br>&#xA0; &#xA0;&#xA0; */<br>&#xA0; &#xA0; </span><span class="keyword">public function </span><span class="default">parse</span><span class="keyword">()<br>&#xA0; &#xA0; {<br>&#xA0; &#xA0; &#xA0; &#xA0; if (empty(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">callback</span><span class="keyword">)) {<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">&quot;Empty parser callback.&quot;</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; }<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$continue </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; while (</span><span class="default">$continue </span><span class="keyword">&amp;&amp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">read</span><span class="keyword">()) {<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; if (isset(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">callback</span><span class="keyword">[</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">nodeType</span><span class="keyword">][</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">name</span><span class="keyword">])) {<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$continue </span><span class="keyword">= </span><span class="default">call_user_func</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">callback</span><span class="keyword">[</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">nodeType</span><span class="keyword">][</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">name</span><span class="keyword">], </span><span class="default">$this</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; }<br>&#xA0; &#xA0; &#xA0; &#xA0; }<br>&#xA0; &#xA0; }<br><br>&#xA0; &#xA0; </span><span class="comment">/**<br>&#xA0; &#xA0;&#xA0; * Run XPath query on current node<br>&#xA0; &#xA0;&#xA0; *<br>&#xA0; &#xA0;&#xA0; * @param&#xA0; string $path<br>&#xA0; &#xA0;&#xA0; * @param&#xA0; string $version<br>&#xA0; &#xA0;&#xA0; * @param&#xA0; string $encoding<br>&#xA0; &#xA0;&#xA0; * @return array(SimpleXMLElement)<br>&#xA0; &#xA0;&#xA0; */<br>&#xA0; &#xA0; </span><span class="keyword">public function </span><span class="default">expandXpath</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">, </span><span class="default">$version </span><span class="keyword">= </span><span class="string">&quot;1.0&quot;</span><span class="keyword">, </span><span class="default">$encoding </span><span class="keyword">= </span><span class="string">&quot;UTF-8&quot;</span><span class="keyword">)<br>&#xA0; &#xA0; {<br>&#xA0; &#xA0; &#xA0; &#xA0; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">expandSimpleXml</span><span class="keyword">(</span><span class="default">$version</span><span class="keyword">, </span><span class="default">$encoding</span><span class="keyword">)-&gt;</span><span class="default">xpath</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">);<br>&#xA0; &#xA0; }<br><br>&#xA0; &#xA0; </span><span class="comment">/**<br>&#xA0; &#xA0;&#xA0; * Expand current node to string<br>&#xA0; &#xA0;&#xA0; *<br>&#xA0; &#xA0;&#xA0; * @param&#xA0; string $version<br>&#xA0; &#xA0;&#xA0; * @param&#xA0; string $encoding<br>&#xA0; &#xA0;&#xA0; * @return SimpleXMLElement<br>&#xA0; &#xA0;&#xA0; */<br>&#xA0; &#xA0; </span><span class="keyword">public function </span><span class="default">expandString</span><span class="keyword">(</span><span class="default">$version </span><span class="keyword">= </span><span class="string">&quot;1.0&quot;</span><span class="keyword">, </span><span class="default">$encoding </span><span class="keyword">= </span><span class="string">&quot;UTF-8&quot;</span><span class="keyword">)<br>&#xA0; &#xA0; {<br>&#xA0; &#xA0; &#xA0; &#xA0; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">expandSimpleXml</span><span class="keyword">(</span><span class="default">$version</span><span class="keyword">, </span><span class="default">$encoding</span><span class="keyword">)-&gt;</span><span class="default">asXML</span><span class="keyword">();<br>&#xA0; &#xA0; }<br><br>&#xA0; &#xA0; </span><span class="comment">/**<br>&#xA0; &#xA0;&#xA0; * Expand current node to SimpleXMLElement<br>&#xA0; &#xA0;&#xA0; *<br>&#xA0; &#xA0;&#xA0; * @param&#xA0; string $version<br>&#xA0; &#xA0;&#xA0; * @param&#xA0; string $encoding<br>&#xA0; &#xA0;&#xA0; * @param&#xA0; string $className<br>&#xA0; &#xA0;&#xA0; * @return SimpleXMLElement<br>&#xA0; &#xA0;&#xA0; */<br>&#xA0; &#xA0; </span><span class="keyword">public function </span><span class="default">expandSimpleXml</span><span class="keyword">(</span><span class="default">$version </span><span class="keyword">= </span><span class="string">&quot;1.0&quot;</span><span class="keyword">, </span><span class="default">$encoding </span><span class="keyword">= </span><span class="string">&quot;UTF-8&quot;</span><span class="keyword">, </span><span class="default">$className </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">)<br>&#xA0; &#xA0; {<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$element </span><span class="keyword">= </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">expand</span><span class="keyword">();<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$document </span><span class="keyword">= new </span><span class="default">DomDocument</span><span class="keyword">(</span><span class="default">$version</span><span class="keyword">, </span><span class="default">$encoding</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$node </span><span class="keyword">= </span><span class="default">$document</span><span class="keyword">-&gt;</span><span class="default">importNode</span><span class="keyword">(</span><span class="default">$element</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$document</span><span class="keyword">-&gt;</span><span class="default">appendChild</span><span class="keyword">(</span><span class="default">$node</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; return </span><span class="default">simplexml_import_dom</span><span class="keyword">(</span><span class="default">$node</span><span class="keyword">, </span><span class="default">$className</span><span class="keyword">);<br>&#xA0; &#xA0; }<br><br>&#xA0; &#xA0; </span><span class="comment">/**<br>&#xA0; &#xA0;&#xA0; * Expand current node to DomDocument<br>&#xA0; &#xA0;&#xA0; *<br>&#xA0; &#xA0;&#xA0; * @param&#xA0; string $version<br>&#xA0; &#xA0;&#xA0; * @param&#xA0; string $encoding<br>&#xA0; &#xA0;&#xA0; * @return DomDocument<br>&#xA0; &#xA0;&#xA0; */<br>&#xA0; &#xA0; </span><span class="keyword">public function </span><span class="default">expandDomDocument</span><span class="keyword">(</span><span class="default">$version </span><span class="keyword">= </span><span class="string">&quot;1.0&quot;</span><span class="keyword">, </span><span class="default">$encoding </span><span class="keyword">= </span><span class="string">&quot;UTF-8&quot;</span><span class="keyword">)<br>&#xA0; &#xA0; {<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$element </span><span class="keyword">= </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">expand</span><span class="keyword">();<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$document </span><span class="keyword">= new </span><span class="default">DomDocument</span><span class="keyword">(</span><span class="default">$version</span><span class="keyword">, </span><span class="default">$encoding</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$node </span><span class="keyword">= </span><span class="default">$document</span><span class="keyword">-&gt;</span><span class="default">importNode</span><span class="keyword">(</span><span class="default">$element</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$document</span><span class="keyword">-&gt;</span><span class="default">appendChild</span><span class="keyword">(</span><span class="default">$node</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; return </span><span class="default">$document</span><span class="keyword">;<br>&#xA0; &#xA0; }<br><br>}<br></span><span class="default">?&gt;</span>
</span>
</div>
  

#


<div class="phpcode"><span class="html">
The &quot;XML2Assoc&quot; functions noted here should be used with caution... basically they are duplicating the functionality already present in SimpleXML. They may work but they won&apos;t scale.<br><br>Their are two main uses cases for parsing XML, each suited to either XMLReader or SimpleXML.<br><br>1. SimpleXML is an excellent tool for easy access to an XML document tree using native PHP data types. It starts to flounder with massive (&gt; 50M or so) XML documents, as it reads the entire document into memory before it can be processed. SimpleXML will just laugh at you then die when your server runs out of memory (or it will cause a load spike).<br><br>2. Aside from the reasoning behind massive XML documents, if you have to deal with massive XML documents, use XMLReader to process them. Don&apos;t try and gather an entire XML document into a PHP data structure using XMLReader and a PHP xml2assoc() function, you are reinventing the SimpleXML wheel.<br>When parsing massive XML documents using XMLReader, gather the data you need to perform an operation then perform it before skipping to the next node. Do not build massive data structures from a massive XML document, your server (and it&apos;s admins) will not like you.</span>
</div>
  

#


<div class="phpcode"><span class="html">
Guys, I hope this example will help<br>you can erase prints showing the process-<br>and it will be a piece of nice code.<br><br><span class="default">&lt;?php <br></span><span class="keyword">function </span><span class="default">xml2assoc</span><span class="keyword">(</span><span class="default">$xml</span><span class="keyword">, </span><span class="default">$name</span><span class="keyword">)<br>{ <br>&#xA0; &#xA0; print </span><span class="string">&quot;&lt;ul&gt;&quot;</span><span class="keyword">;<br><br>&#xA0; &#xA0; </span><span class="default">$tree </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br>&#xA0; &#xA0; print(</span><span class="string">&quot;I&apos;m inside &quot; </span><span class="keyword">. </span><span class="default">$name </span><span class="keyword">. </span><span class="string">&quot;&lt;br&gt;&quot;</span><span class="keyword">);<br>&#xA0; &#xA0; <br>&#xA0; &#xA0; while(</span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">read</span><span class="keyword">()) <br>&#xA0; &#xA0; {<br>&#xA0; &#xA0; &#xA0; &#xA0; if(</span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">nodeType </span><span class="keyword">== </span><span class="default">XMLReader</span><span class="keyword">::</span><span class="default">END_ELEMENT</span><span class="keyword">)<br>&#xA0; &#xA0; &#xA0; &#xA0; {<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; print </span><span class="string">&quot;&lt;/ul&gt;&quot;</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; return </span><span class="default">$tree</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; }<br>&#xA0; &#xA0; &#xA0; &#xA0; <br>&#xA0; &#xA0; &#xA0; &#xA0; else if(</span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">nodeType </span><span class="keyword">== </span><span class="default">XMLReader</span><span class="keyword">::</span><span class="default">ELEMENT</span><span class="keyword">)<br>&#xA0; &#xA0; &#xA0; &#xA0; {<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$node </span><span class="keyword">= array();<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; <br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; print(</span><span class="string">&quot;Adding &quot; </span><span class="keyword">. </span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">name </span><span class="keyword">.</span><span class="string">&quot;&lt;br&gt;&quot;</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$node</span><span class="keyword">[</span><span class="string">&apos;tag&apos;</span><span class="keyword">] = </span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">name</span><span class="keyword">;<br><br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; if(</span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">hasAttributes</span><span class="keyword">)<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; {<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$attributes </span><span class="keyword">= array();<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; while(</span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">moveToNextAttribute</span><span class="keyword">()) <br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; {<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; print(</span><span class="string">&quot;Adding attr &quot; </span><span class="keyword">. </span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">name </span><span class="keyword">.</span><span class="string">&quot; = &quot; </span><span class="keyword">. </span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">value </span><span class="keyword">. </span><span class="string">&quot;&lt;br&gt;&quot;</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$attributes</span><span class="keyword">[</span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">name</span><span class="keyword">] = </span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">value</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; }<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$node</span><span class="keyword">[</span><span class="string">&apos;attr&apos;</span><span class="keyword">] = </span><span class="default">$attributes</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; }<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; <br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; if(!</span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">isEmptyElement</span><span class="keyword">)<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; {<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$childs </span><span class="keyword">= </span><span class="default">xml2assoc</span><span class="keyword">(</span><span class="default">$xml</span><span class="keyword">, </span><span class="default">$node</span><span class="keyword">[</span><span class="string">&apos;tag&apos;</span><span class="keyword">]);<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$node</span><span class="keyword">[</span><span class="string">&apos;childs&apos;</span><span class="keyword">] = </span><span class="default">$childs</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; }<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; <br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; print(</span><span class="default">$node</span><span class="keyword">[</span><span class="string">&apos;tag&apos;</span><span class="keyword">] . </span><span class="string">&quot; added &lt;br&gt;&quot;</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$tree</span><span class="keyword">[] = </span><span class="default">$node</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; }<br>&#xA0; &#xA0; &#xA0; &#xA0; <br>&#xA0; &#xA0; &#xA0; &#xA0; else if(</span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">nodeType </span><span class="keyword">== </span><span class="default">XMLReader</span><span class="keyword">::</span><span class="default">TEXT</span><span class="keyword">)<br>&#xA0; &#xA0; &#xA0; &#xA0; {<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$node </span><span class="keyword">= array();<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$node</span><span class="keyword">[</span><span class="string">&apos;text&apos;</span><span class="keyword">] = </span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">value</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$tree</span><span class="keyword">[] = </span><span class="default">$node</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; print </span><span class="string">&quot;text added = &quot; </span><span class="keyword">. </span><span class="default">$node</span><span class="keyword">[</span><span class="string">&apos;text&apos;</span><span class="keyword">] . </span><span class="string">&quot;&lt;br&gt;&quot;</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; }<br>&#xA0; &#xA0; }<br>&#xA0; &#xA0; <br>&#xA0; &#xA0; print </span><span class="string">&quot;returning &quot; </span><span class="keyword">. </span><span class="default">count</span><span class="keyword">(</span><span class="default">$tree</span><span class="keyword">) . </span><span class="string">&quot; childs&lt;br&gt;&quot;</span><span class="keyword">;<br>&#xA0; &#xA0; print </span><span class="string">&quot;&lt;/ul&gt;&quot;</span><span class="keyword">;<br>&#xA0; &#xA0; <br>&#xA0; &#xA0; return </span><span class="default">$tree</span><span class="keyword">; <br>}<br><br>echo </span><span class="string">&quot;&lt;PRE&gt;&quot;</span><span class="keyword">;<br><br></span><span class="default">$xml </span><span class="keyword">= new </span><span class="default">XMLReader</span><span class="keyword">(); <br></span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">open</span><span class="keyword">(</span><span class="string">&apos;test.xml&apos;</span><span class="keyword">); <br></span><span class="default">$assoc </span><span class="keyword">= </span><span class="default">xml2assoc</span><span class="keyword">(</span><span class="default">$xml</span><span class="keyword">, </span><span class="string">&quot;root&quot;</span><span class="keyword">); <br></span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">close</span><span class="keyword">();<br><br></span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$assoc</span><span class="keyword">);<br>echo </span><span class="string">&quot;&lt;/PRE&gt;&quot;</span><span class="keyword">;<br><br></span><span class="default">?&gt;<br></span><br>It reads this xml:<br><br>&lt;test&gt;<br>&#xA0; &#xA0; &lt;hallo volume=&quot;loud&quot;&gt; me &lt;br/&gt; lala &lt;/hallo&gt;<br>&#xA0; &#xA0; &lt;hallo&gt; me &lt;/hallo&gt;<br>&lt;/test&gt;</span>
</div>
  

#

[Official documentation page](https://www.php.net/manual/en/class.xmlreader.php)

**[To root](/README.md)**