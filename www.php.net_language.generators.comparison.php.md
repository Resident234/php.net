# Comparing generators with 




<div class="phpcode"><span class="html">
This hardly seems a fair comparison between the two examples, size-for-size. As noted, generators are forward-only, meaning that it should be compared to an iterator with a dummy rewind function defined. Also, to be fair, since the iterator throws an exception, shouldn&apos;t the generator example also throw the same exception? The code comparison would become more like this:<br><br><span class="default">&lt;?php<br></span><span class="keyword">function </span><span class="default">getLinesFromFile</span><span class="keyword">(</span><span class="default">$fileName</span><span class="keyword">) {<br>&#xA0; &#xA0; if (!</span><span class="default">$fileHandle </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="default">$fileName</span><span class="keyword">, </span><span class="string">&apos;r&apos;</span><span class="keyword">)) {<br>&#xA0; &#xA0; &#xA0; &#xA0; throw new </span><span class="default">RuntimeException</span><span class="keyword">(</span><span class="string">&apos;Couldn\&apos;t open file &quot;&apos; </span><span class="keyword">. </span><span class="default">$fileName </span><span class="keyword">. </span><span class="string">&apos;&quot;&apos;</span><span class="keyword">);<br>&#xA0; &#xA0; }<br> <br>&#xA0; &#xA0; while (</span><span class="default">false </span><span class="keyword">!== </span><span class="default">$line </span><span class="keyword">= </span><span class="default">fgets</span><span class="keyword">(</span><span class="default">$fileHandle</span><span class="keyword">)) {<br>&#xA0; &#xA0; &#xA0; &#xA0; yield </span><span class="default">$line</span><span class="keyword">;<br>&#xA0; &#xA0; }<br> <br>&#xA0; &#xA0; </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$fileHandle</span><span class="keyword">);<br>}<br><br></span><span class="comment">// versus...<br><br></span><span class="keyword">class </span><span class="default">LineIterator </span><span class="keyword">implements </span><span class="default">Iterator </span><span class="keyword">{<br>&#xA0; &#xA0; protected </span><span class="default">$fileHandle</span><span class="keyword">;<br> <br>&#xA0; &#xA0; protected </span><span class="default">$line</span><span class="keyword">;<br>&#xA0; &#xA0; protected </span><span class="default">$i</span><span class="keyword">;<br> <br>&#xA0; &#xA0; public function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$fileName</span><span class="keyword">) {<br>&#xA0; &#xA0; &#xA0; &#xA0; if (!</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">fileHandle </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="default">$fileName</span><span class="keyword">, </span><span class="string">&apos;r&apos;</span><span class="keyword">)) {<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; throw new </span><span class="default">RuntimeException</span><span class="keyword">(</span><span class="string">&apos;Couldn\&apos;t open file &quot;&apos; </span><span class="keyword">. </span><span class="default">$fileName </span><span class="keyword">. </span><span class="string">&apos;&quot;&apos;</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; }<br>&#xA0; &#xA0; }<br> <br>&#xA0; &#xA0; public function </span><span class="default">rewind</span><span class="keyword">() { }<br> <br>&#xA0; &#xA0; public function </span><span class="default">valid</span><span class="keyword">() {<br>&#xA0; &#xA0; &#xA0; &#xA0; return </span><span class="default">false </span><span class="keyword">!== </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">line</span><span class="keyword">;<br>&#xA0; &#xA0; }<br> <br>&#xA0; &#xA0; public function </span><span class="default">current</span><span class="keyword">() {<br>&#xA0; &#xA0; &#xA0; &#xA0; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">line</span><span class="keyword">;<br>&#xA0; &#xA0; }<br> <br>&#xA0; &#xA0; public function </span><span class="default">key</span><span class="keyword">() {<br>&#xA0; &#xA0; &#xA0; &#xA0; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">i</span><span class="keyword">;<br>&#xA0; &#xA0; }<br> <br>&#xA0; &#xA0; public function </span><span class="default">next</span><span class="keyword">() {<br>&#xA0; &#xA0; &#xA0; &#xA0; if (</span><span class="default">false </span><span class="keyword">!== </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">line</span><span class="keyword">) {<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">line </span><span class="keyword">= </span><span class="default">fgets</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">fileHandle</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">i</span><span class="keyword">++;<br>&#xA0; &#xA0; &#xA0; &#xA0; }<br>&#xA0; &#xA0; }<br> <br>&#xA0; &#xA0; public function </span><span class="default">__destruct</span><span class="keyword">() {<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">fileHandle</span><span class="keyword">);<br>&#xA0; &#xA0; }<br>}<br></span><span class="default">?&gt;<br></span><br>The generator is still obviously much shorter, but this seems a more reasonable comparison.</span>
</div>
  

#


<div class="phpcode"><span class="html">
I think that this is bad generator example.<br>If user will not consume all lines then file will not be closed.<br><br><span class="default">&lt;?php<br></span><span class="keyword">function </span><span class="default">getLinesFromFile</span><span class="keyword">(</span><span class="default">$fileHandle</span><span class="keyword">) {<br>&#xA0; &#xA0; while (</span><span class="default">false </span><span class="keyword">!== </span><span class="default">$line </span><span class="keyword">= </span><span class="default">fgets</span><span class="keyword">(</span><span class="default">$fileHandle</span><span class="keyword">)) {<br>&#xA0; &#xA0; &#xA0; &#xA0; yield </span><span class="default">$line</span><span class="keyword">;<br>&#xA0; &#xA0; }<br>}<br><br>if (</span><span class="default">$fileHandle </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="default">$fileName</span><span class="keyword">, </span><span class="string">&apos;r&apos;</span><span class="keyword">)) {<br>&#xA0; &#xA0; </span><span class="comment">/*<br>&#xA0; &#xA0; something with getLinesFromFile<br>&#xA0; &#xA0; */<br>&#xA0; &#xA0; </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$fileHandle</span><span class="keyword">);<br>}<br></span><span class="default">?&gt;</span>
</span>
</div>
  

#

[Official documentation page](https://www.php.net/manual/en/language.generators.comparison.php)

**[To root](/README.md)**