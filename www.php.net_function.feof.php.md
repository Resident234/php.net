# feof




<div class="phpcode"><span class="html">
I really thought that the feof() was TRUE when the logical file pointer is a EOF.<br>but no ! <br>we need to read and get an empty record before the eof() reports TRUE.<br><br>So<br><br>$fp = fopen(&apos;test.bin&apos;,&apos;rb&apos;);<br>while(!feof($fp)) {<br>&#xA0; $c = fgetc($fp);<br>&#xA0; // ... do something with $c <br>&#xA0; echo ftell($fp), &quot;,&quot;;<br>}<br>echo &apos;EOF!&apos;;<br><br>prints for two time the last byte position.<br>If our file length is 5 byte this code prints <br><br>0,1,2,3,4,5,5,EOF!<br><br>Because of this, you have to do another check to verify if fgetc really reads another byte (to prevent error on &quot;do something with $c&quot; ^_^).<br><br>To prevent errors you have to use this code<br><br>$fp = fopen(&apos;test.bin&apos;,&apos;rb&apos;);<br>while(!feof($fp)) {<br>&#xA0; $c = fgetc($fp);<br>&#xA0; if($c === false) break;<br>&#xA0; // ... do something with $c <br>}<br><br>but this is the same of<br><br>$fp = fopen(&apos;test.bin&apos;,&apos;rb&apos;);<br>while(($c = fgetc($fp))!==false) {<br>&#xA0; // ... do something with $c <br>}<br><br>Consequently feof() is simply useless.<br>Before write this note I want to submit this as a php bug but one php developer said that this does not imply a bug in PHP itself (<a href="http://bugs.php.net/bug.php?id=35136&amp;edit=2" rel="nofollow" target="_blank">http://bugs.php.net/bug.php?id=35136&amp;edit=2</a>).<br><br>If this is not a bug I think that this need at least to be noticed.<br><br>Sorry for my bad english.<br>Bye ;)</span>
</div>
  

#


<div class="phpcode"><span class="html">
When using feof() on a TCP stream, i found the following to work (after many hours of frustration and anger):<br><br>NOTE: I used &quot;;&quot; to denote the end of data transmission.&#xA0; This can be modified to whatever the server&apos;s end of file or in this case, end of output character is.<br><br><span class="default">&lt;?php<br>&#xA0; &#xA0; &#xA0; &#xA0; $cursor </span><span class="keyword">= </span><span class="string">&quot;&quot;</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$inData </span><span class="keyword">= </span><span class="string">&quot;&quot;</span><span class="keyword">;<br><br>&#xA0; &#xA0; &#xA0; &#xA0; while(</span><span class="default">strcmp</span><span class="keyword">(</span><span class="default">$cursor</span><span class="keyword">, </span><span class="string">&quot;;&quot;</span><span class="keyword">) != </span><span class="default">0</span><span class="keyword">) {<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$cursor </span><span class="keyword">= </span><span class="default">fgetc</span><span class="keyword">(</span><span class="default">$sock</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$inData</span><span class="keyword">.= </span><span class="default">$cursor</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; }<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$sock</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; echo(</span><span class="default">$inData</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>Since strcmp() returns 0 when the two strings are equal, it will return non zero as long as the cursor is not &quot;;&quot;.&#xA0; Using the above method will add &quot;;&quot; to the string, but the fix for this is simple.<br><br><span class="default">&lt;?php<br>&#xA0; &#xA0; &#xA0; &#xA0; $cursor </span><span class="keyword">= </span><span class="string">&quot;&quot;</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$inData </span><span class="keyword">= </span><span class="string">&quot;&quot;</span><span class="keyword">;<br><br>&#xA0; &#xA0; &#xA0; &#xA0;&#xA0; </span><span class="default">$cursor </span><span class="keyword">= </span><span class="default">fgetc</span><span class="keyword">(</span><span class="default">$sock</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; while(</span><span class="default">strcmp</span><span class="keyword">(</span><span class="default">$cursor</span><span class="keyword">, </span><span class="string">&quot;;&quot;</span><span class="keyword">) != </span><span class="default">0</span><span class="keyword">) {<br>&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">$inData</span><span class="keyword">.= </span><span class="default">$cursor</span><span class="keyword">;<br>&#xA0; &#xA0; &#xA0; &#xA0; }<br>&#xA0; &#xA0; &#xA0; &#xA0; </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$sock</span><span class="keyword">);<br>&#xA0; &#xA0; &#xA0; &#xA0; echo(</span><span class="default">$inData</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>I hope this helps someone.</span>
</div>
  

#

[Official documentation page](https://www.php.net/manual/en/function.feof.php)

**[To root](/README.md)**